# 모션과 내비게이션(Motions and Navigation)

**이전**: [필수 편집](./03_Essential_Editing.md) | **다음**: [연산자와 조합성](./05_Operators_and_Composability.md)

---

## 학습 목표

이 레슨을 완료하면 다음을 할 수 있습니다:

1. `w`, `b`, `e` 및 WORD 변형 `W`, `B`, `E`를 사용하여 단어 단위로 이동
2. `0`, `^`, `$`, `f`, `t`, `F`, `T`를 사용하여 줄 내에서 이동
3. `Ctrl-d`, `Ctrl-u`, `gg`, `G`, 줄 번호를 사용하여 파일을 스크롤하고 이동
4. 마크(mark)를 사용하여 위치를 북마크하고 다시 돌아오기
5. `Ctrl-o`, `Ctrl-i`, `g;`로 점프 목록(jump list)과 변경 목록(change list) 탐색

---

레슨 2에서 기본 커서 이동인 `h`, `j`, `k`, `l`을 배웠습니다. 하지만 한 번에 한 글자씩 이동하는 것은 자동차를 타고 갈 수 있는데 걸어가는 것과 같습니다. 이 레슨에서는 단어, 줄, 화면, 랜드마크 단위로 이동하는 방법을 배워 내비게이션 속도를 획기적으로 높입니다.

## 목차

1. [단어 모션](#1-단어-모션)
2. [줄 모션](#2-줄-모션)
3. [줄 내 문자 검색](#3-줄-내-문자-검색)
4. [화면 모션](#4-화면-모션)
5. [파일 모션](#5-파일-모션)
6. [마크](#6-마크)
7. [점프 목록과 변경 목록](#7-점프-목록과-변경-목록)
8. [대괄호 매칭](#8-대괄호-매칭)
9. [요약](#9-요약)

---

## 1. 단어 모션

Vim은 **word**(소문자)와 **WORD**(대문자)를 구분합니다:

- **word**: 문자, 숫자, 밑줄의 연속, 또는 다른 비공백 문자의 연속. 공백이나 구두점 경계로 구분됩니다.
- **WORD**: 비공백 문자의 연속. 공백으로만 구분됩니다.

```
예시:   my_var.method(arg1, arg2)

words:  my_var . method ( arg1 ,   arg2 )     ← 8개의 word
WORDs:  my_var.method(arg1,  arg2)             ← 2개의 WORD
```

### 단어 이동 명령어

| 명령어 | 동작 |
|--------|------|
| `w` | 다음 **word** 시작으로 이동 |
| `W` | 다음 **WORD** 시작으로 이동 |
| `b` | 이전 **word** 시작으로 이동 (back) |
| `B` | 이전 **WORD** 시작으로 이동 |
| `e` | 현재/다음 **word** 끝으로 이동 |
| `E` | 현재/다음 **WORD** 끝으로 이동 |
| `ge` | 이전 **word** 끝으로 이동 |
| `gE` | 이전 **WORD** 끝으로 이동 |

### 시각적 예시

```
텍스트: Hello, World! How are you?
        ^

w:    Hello, World! How are you?     ("you"에 도달하려면 5번 입력)
             ^  ^    ^   ^   ^
W:    Hello, World! How are you?     ("you"에 도달하려면 3번 입력)
             ^      ^   ^   ^

b:    ("you"에서) 순서: are → How → World! → Hello,
B:    ("you"에서) 순서: are → How → World! → Hello,
```

**WORD 모션을 사용할 때**: 구두점을 빠르게 건너뛰고 싶을 때 (예: URL, 파일 경로, 기호가 많은 코드 탐색).

---

## 2. 줄 모션

| 명령어 | 동작 |
|--------|------|
| `0` | 첫 번째 열(0번 열)로 이동 |
| `^` | 첫 번째 비공백 문자로 이동 |
| `$` | 줄 끝으로 이동 |
| `g_` | 마지막 비공백 문자로 이동 |
| `+` | 다음 줄의 첫 번째 비공백으로 이동 |
| `-` | 이전 줄의 첫 번째 비공백으로 이동 |

### `0`과 `^`의 차이

```
    def my_function():
^   ^
0   ^  (캐럿)

0은 0번 열로 이동 ("def" 앞의 공백)
^는 'd'로 이동 (첫 번째 비공백 문자)
```

대부분의 경우 `^`를 사용하세요 — 보통 선행 공백이 아닌 첫 번째 의미 있는 문자가 필요하기 때문입니다.

---

## 3. 줄 내 문자 검색

이 명령어들은 현재 줄에서 특정 문자를 검색합니다:

| 명령어 | 동작 |
|--------|------|
| `f{char}` | `{char}`의 다음 발생 위치로 **앞으로(forward)** 이동 |
| `F{char}` | `{char}`의 이전 발생 위치로 뒤로 이동 |
| `t{char}` | `{char}` 바로 앞까지(**till**) 앞으로 이동 |
| `T{char}` | `{char}` 바로 뒤까지 뒤로 이동 |
| `;` | 마지막 `f`/`F`/`t`/`T`를 같은 방향으로 반복 |
| `,` | 마지막 `f`/`F`/`t`/`T`를 반대 방향으로 반복 |

### 예시

```
텍스트: def calculate_total_price(items, tax_rate):
        ^  커서 위치

fp → def calculate_total_price(items, tax_rate):
                              ^  ("price"의 첫 번째 'p'로 점프)

;  → def calculate_total_price(items, tax_rate):
                                              ^  (다음 발생 — 더 이상 보이는 p 없음)

ft → def calculate_total_price(items, tax_rate):
                         ^  ("total"의 첫 번째 't'로 점프)
;  → 다음 't'
```

### `t`가 존재하는 이유

`t`ill 모션은 연산자와 함께 사용할 때 특히 유용합니다. 예를 들어 괄호 바로 앞까지(괄호 미포함) 모든 것을 삭제하려면:

```
텍스트: calculate_total_price(items)
        ^

dt(  → (items)    ← '(' 미포함하고 그 앞까지 삭제
df(  → items)     ← '(' 포함하고 그 위치까지 삭제
```

---

## 4. 화면 모션

이 명령어들은 특정 줄로 이동하지 않고 뷰포트(viewport)를 스크롤합니다:

### 스크롤

| 명령어 | 동작 |
|--------|------|
| `Ctrl-d` | 반 화면 **아래로(down)** 스크롤 |
| `Ctrl-u` | 반 화면 **위로(up)** 스크롤 |
| `Ctrl-f` | 한 화면 앞으로(아래로, forward) 스크롤 |
| `Ctrl-b` | 한 화면 뒤로(위로, back) 스크롤 |
| `Ctrl-e` | 한 줄 아래로 스크롤 (커서 유지) |
| `Ctrl-y` | 한 줄 위로 스크롤 (커서 유지) |

### 화면에서의 커서 위치

| 명령어 | 동작 |
|--------|------|
| `H` | 커서를 화면 **상단(High)** 으로 이동 |
| `M` | 커서를 화면 **중간(Middle)** 으로 이동 |
| `L` | 커서를 화면 **하단(Low)** 으로 이동 |
| `zz` | 현재 줄을 화면 중앙으로 이동 |
| `zt` | 현재 줄을 화면 **상단(top)** 으로 이동 |
| `zb` | 현재 줄을 화면 **하단(bottom)** 으로 이동 |

`zz`는 특히 유용합니다: 줄로 점프한 후 위아래 컨텍스트를 볼 수 있도록 해당 줄을 중앙에 배치합니다.

---

## 5. 파일 모션

| 명령어 | 동작 |
|--------|------|
| `gg` | 파일의 첫 번째 줄로 이동 |
| `G` | 파일의 마지막 줄로 이동 |
| `{N}G` | N번 줄로 이동 (예: `42G`) |
| `:{N}` | N번 줄로 이동 (예: `:42`) |
| `{N}%` | 파일의 N% 위치로 이동 (예: `50%` = 중간) |

### 단락과 문장 모션

| 명령어 | 동작 |
|--------|------|
| `{` | 이전 빈 줄(단락 경계)로 이동 |
| `}` | 다음 빈 줄로 이동 |
| `(` | 이전 문장으로 이동 |
| `)` | 다음 문장으로 이동 |

빈 줄로 구분된 산문이나 코드를 탐색할 때 유용합니다.

---

## 6. 마크

마크(mark)는 북마크입니다 — 나중에 되돌아올 수 있도록 커서 위치를 저장합니다.

### 마크 설정

| 명령어 | 동작 |
|--------|------|
| `m{a-z}` | 로컬 마크 설정 (파일별) |
| `m{A-Z}` | 전역 마크 설정 (파일 간 이동 가능) |

### 마크로 점프

| 명령어 | 동작 |
|--------|------|
| `` `{mark} `` | 정확한 위치(줄과 열)로 점프 |
| `'{mark}` | 마크된 줄의 시작으로 점프 |

### 특수 마크

| 마크 | 의미 |
|------|------|
| `` ` `` 또는 `''` | 마지막 점프 이전 위치 |
| `` `. `` | 마지막 변경 위치 |
| `` `^ `` | 마지막 입력 위치 |
| `` `[ `` | 마지막 yank/change의 시작 |
| `` `] `` | 마지막 yank/change의 끝 |
| `` `< `` | 마지막 비주얼 선택의 시작 |
| `` `> `` | 마지막 비주얼 선택의 끝 |

### 예시 워크플로우

```
1. 150번 줄의 함수를 읽고 있음
2. ma                    ← 여기에 마크 'a' 설정
3. 다른 곳으로 이동하여 무언가 확인
4. 'a                    ← 150번 줄로 돌아가기
5. `a                    ← 정확한 열 위치까지 돌아가기
```

---

## 7. 점프 목록과 변경 목록

### 점프 목록(Jump List)

Vim은 여러분이 "점프"한 위치 목록을 관리합니다. 점프는 커서를 멀리 이동시키는 모션(`G`, `gg`, `/search`, 마크 등)입니다.

| 명령어 | 동작 |
|--------|------|
| `Ctrl-o` | 점프 목록의 이전 위치로 이동 (**o**lder) |
| `Ctrl-i` | 점프 목록의 다음 위치로 이동 (newer) |
| `:jumps` | 점프 목록 표시 |

`Ctrl-o`는 웹 브라우저의 "뒤로" 버튼처럼 생각하세요.

### 변경 목록(Change List)

Vim은 변경을 가한 위치도 추적합니다:

| 명령어 | 동작 |
|--------|------|
| `g;` | 이전 변경 위치로 이동 |
| `g,` | 다음 변경 위치로 이동 |
| `:changes` | 변경 목록 표시 |

매우 유용합니다: "방금 어디를 편집하고 있었지?" → `g;`로 바로 이동할 수 있습니다.

---

## 8. 대괄호 매칭

| 명령어 | 동작 |
|--------|------|
| `%` | 대응하는 괄호로 점프: `()`, `[]`, `{}` |

```
if (condition) {       ← '{'에 커서
    do_something();
}                      ← %로 여기로 점프

if (condition) {       ← %로 다시 여기로 점프
    do_something();
}                      ← '}'에 커서
```

`%`는 `(`, `)`, `[`, `]`, `{`, `}`와 함께 동작하며 플러그인으로 HTML 태그, if/endif 등에도 확장할 수 있습니다.

---

## 9. 요약

| 카테고리 | 명령어 | 설명 |
|----------|--------|------|
| 단어(Word) | `w`/`b`/`e`, `W`/`B`/`E` | word / WORD 단위로 이동 |
| 줄(Line) | `0`, `^`, `$`, `g_` | 줄 시작, 첫 비공백, 줄 끝 |
| 문자(Character) | `f`/`F`/`t`/`T`, `;`/`,` | 줄 내 문자 찾기, 반복 |
| 화면(Screen) | `Ctrl-d`/`u`/`f`/`b` | 반/전체 화면 스크롤 |
| 화면 위치 | `H`/`M`/`L`, `zz`/`zt`/`zb` | 커서 / 뷰포트 위치 설정 |
| 파일(File) | `gg`/`G`/`{N}G` | 파일 시작/끝/N번 줄 |
| 단락(Paragraph) | `{`/`}` | 이전/다음 빈 줄 |
| 마크(Marks) | `m{a-z}`, `` `{mark} `` | 북마크 설정 및 이동 |
| 점프 목록 | `Ctrl-o`/`Ctrl-i` | 점프 이력 탐색 |
| 변경 목록 | `g;`/`g,` | 변경 이력 탐색 |
| 괄호(Brackets) | `%` | 대응 괄호로 점프 |

### 내비게이션 전략

1. **큰 점프**: `gg`, `G`, `/{pattern}`, 마크
2. **중간 점프**: `{`, `}`, `Ctrl-d`, `Ctrl-u`, `H`/`M`/`L`
3. **작은 점프**: `w`, `b`, `e`, `f{char}`
4. **미세 조정**: `h`, `j`, `k`, `l`

큰 것에서 작은 것으로 작업하세요: 먼저 가까이 점프한 다음 세밀하게 조정합니다.

---

## 연습 문제

### 연습 문제 1: word vs. WORD

다음 줄이 있습니다: `http://api.example.com/v2/users?limit=10`

커서가 맨 앞(`h`)에 있을 때:

1. `limit`에 도달하려면 `w`를 몇 번 눌러야 합니까?
2. `limit`에 도달하려면 `W`를 몇 번 눌러야 합니까?
3. 횟수가 다른 이유를 설명하세요.

<details>
<summary>정답 보기</summary>

1. **`w` 횟수**: URL에는 단어 경계(`:`, `/`, `.`, `?`, `=` 각각이 경계)가 많아, `limit`에 도달하기까지 약 12–14번의 `w`가 필요합니다.
2. **`W` 횟수**: WORD는 공백으로만 구분됩니다. 전체 URL은 공백이 없는 하나의 WORD입니다. URL 내부의 `limit`은 URL과 같은 WORD 안에 있으므로 `W`로는 도달할 수 없습니다 — `W`는 공백 다음 토큰으로 건너뜁니다.

3. **설명**: `word` 경계에는 구두점 변화(문자→기호→문자)가 포함되어 `.`, `/`, `?`, `=` 각각에서 `w`가 멈춥니다. `WORD`는 공백에서만 멈추므로 URL이나 복잡한 표현식 같은 긴 토큰을 훨씬 빠르게 건너뜁니다.

**실용적 결론**: 전체 URL이나 기호가 많은 토큰을 건너뛸 때는 `W`를 사용하고, 그 안에서 세밀하게 이동할 때는 `w`를 사용합니다.

</details>

### 연습 문제 2: 줄 내비게이션

다음 Python 줄이 있습니다 (커서는 0번 열, 즉 공백):
```
    return user.profile.settings["theme"]
```

각 목표 위치로 이동하는 단일 명령어를 작성하세요:

1. `return`의 `r`.
2. `"theme"` 앞의 `[`.
3. 줄 끝의 `]`.

<details>
<summary>정답 보기</summary>

1. `^` — 첫 번째 비공백 문자(`return`의 `r`)로 이동합니다. 참고: `0`은 맨 앞 열(공백)로 이동하고 `r`로는 이동하지 않습니다.
2. `f[` — 현재 줄에서 다음 `[`를 앞쪽으로 찾습니다.
3. `$` — 줄 끝(`]`)으로 이동합니다. 또는 `f]`도 작동합니다.

</details>

### 연습 문제 3: 다중 위치 편집을 위한 마크

500줄짜리 설정 파일을 편집하고 있습니다. 다음 작업이 필요합니다:
1. 50번 줄 근처 섹션 편집.
2. 그 다음 300번 줄 근처 섹션 편집.
3. 첫 번째 편집을 확인하기 위해 50번 줄로 돌아가기.

마크를 사용한 전체 워크플로우를 설명하세요.

<details>
<summary>정답 보기</summary>

```
1. 50번 줄로 이동 (예: :50 또는 50G)
2. ma                 ← 50번 줄에 마크 'a' 설정
3. 50번 줄에서 편집 수행
4. 300번 줄로 이동 (예: :300 또는 300G)
5. mb                 ← 300번 줄에 마크 'b' 설정 (선택 사항이지만 좋은 습관)
6. 300번 줄에서 편집 수행
7. 'a                 ← 50번 줄의 첫 번째 비공백으로 점프
   또는
   `a                 ← 50번 줄의 정확한 커서 위치로 점프
8. 첫 번째 편집 확인
```

**팁**: 파일 내 북마크에는 소문자 마크 `a`-`z`를 사용합니다. 백틱(`` ` ``) 버전(`` `a ``)은 정확한 열로 돌아가고, 어포스트로피 버전(`'a`)은 마크된 줄의 첫 번째 비공백 문자로 돌아갑니다.

</details>

### 연습 문제 4: `%` 점프

다음 코드에 괄호 문제가 있어 보입니다:

```python
def process(data):
    result = [x for x in data if (x > 0 and x < 100]
    return result
```

`%`를 사용해 괄호 불일치를 진단하는 방법을 설명하세요.

<details>
<summary>정답 보기</summary>

1. `result = ` 뒤의 `[`에 커서를 놓습니다.
2. `%`를 누릅니다 — Vim이 대응하는 `]`로 점프해야 합니다.
3. `%`가 줄 끝의 `]`에 착지하는 것을 확인합니다 — 하지만 리스트 컴프리헨션 내부의 `(`에 대응하는 `)`가 없습니다.
4. `if ` 뒤의 `(`로 이동합니다.
5. `%`를 누릅니다 — Vim이 대응하는 `)`를 찾으려 하지만 없으므로 점프하지 않습니다(또는 오류 표시).

이것이 버그를 드러냅니다: 여는 `(`에 대응하는 `)`가 없습니다. 수정 방법은 `]` 앞에 `)`를 추가하는 것입니다:
```python
    result = [x for x in data if (x > 0 and x < 100)]
```

</details>

### 연습 문제 5: 점프 목록 내비게이션

큰 파일에서 다음 작업을 순서대로 수행합니다:

1. 1번 줄에서 시작합니다.
2. `G`를 눌러 마지막 줄(200번 줄)로 이동합니다.
3. `50%`를 눌러 100번 줄로 이동합니다.
4. `gg`를 눌러 1번 줄로 돌아갑니다.

이 모든 점프 후 200번 줄로 돌아가려면 `Ctrl-o`를 몇 번 눌러야 합니까? 그 시점의 점프 목록은 어떻게 됩니까?

<details>
<summary>정답 보기</summary>

모든 작업 후 점프 목록 (가장 최근 순서):
```
위치 1 (현재): 1번 줄   ← gg
위치 2:        100번 줄 ← 50%
위치 3:        200번 줄 ← G
위치 4:        1번 줄   ← 시작 위치
```

200번 줄로 돌아가려면:
- `Ctrl-o` 한 번 → 100번 줄로 이동 (점프 목록에서 한 단계 뒤)
- `Ctrl-o` 다시 → 200번 줄로 이동 (두 단계 뒤)

따라서 **`Ctrl-o` 두 번**으로 200번 줄에 도달합니다.

앞으로 다시 이동하려면: `Ctrl-i`를 눌러 점프 목록에서 앞으로 탐색합니다.

</details>

---

**이전**: [필수 편집](./03_Essential_Editing.md) | **다음**: [연산자와 조합성](./05_Operators_and_Composability.md)
