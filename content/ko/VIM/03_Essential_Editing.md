# 필수 편집

**이전**: [모드와 기본 내비게이션](./02_Modes_and_Basic_Navigation.md) | **다음**: [모션과 내비게이션](./04_Motions_and_Navigation.md)

---

## 학습 목표

이 레슨을 완료하면 다음을 할 수 있습니다:

1. 삽입 모드(Insert Mode)에 진입하는 여러 방법 사용하기 (`i`, `a`, `o`, `I`, `A`, `O`)
2. `x`, `dw`, `dd`를 사용해 문자, 단어, 줄 삭제하기
3. `yy`와 `p`로 텍스트를 얀크(yank, 복사)하고 풋(put, 붙여넣기)하기
4. `u`와 `Ctrl-r`로 변경 사항을 실행 취소하고 다시 실행하기
5. 저장, 종료, 이 두 작업을 효율적으로 결합하기

---

모드와 기본 내비게이션을 익혔으니 이제 기본 편집 작업을 배울 차례입니다. 이 명령어들은 일상적인 편집 작업의 80%를 커버합니다. 모든 것을 한 번에 외우려 하지 말고 — `i`, `Esc`, `x`, `dd`, `u`, `:wq`에 집중한 다음 점차 더 많은 명령을 레퍼토리에 추가하세요.

## 목차

1. [삽입 모드 진입 — 전체 그림](#1-삽입-모드-진입--전체-그림)
2. [텍스트 삭제](#2-텍스트-삭제)
3. [얀크(복사)와 풋(붙여넣기)](#3-얀크복사와-풋붙여넣기)
4. [텍스트 변경](#4-텍스트-변경)
5. [실행 취소와 다시 실행](#5-실행-취소와-다시-실행)
6. [저장과 종료](#6-저장과-종료)
7. [명령 반복](#7-명령-반복)
8. [줄 합치기](#8-줄-합치기)
9. [실전 편집 워크플로우](#9-실전-편집-워크플로우)
10. [요약](#10-요약)

---

## 1. 삽입 모드 진입 — 전체 그림

각 삽입 명령은 삽입 모드(Insert Mode)로 전환하기 전에 커서를 다른 위치에 놓습니다:

```
Line: The quick brown fox

Cursor on 'q' of "quick":

  i  → Insert BEFORE 'q':    The |quick brown fox
  a  → Insert AFTER 'q':     The q|uick brown fox
  I  → Insert at line START:  |The quick brown fox
  A  → Insert at line END:    The quick brown fox|
  o  → Open line BELOW:       The quick brown fox
                               |
  O  → Open line ABOVE:       |
                               The quick brown fox
```

### 언제 어떤 것을 사용할까

| 명령 | 사용 상황 |
|------|-----------|
| `i` | 현재 위치에 삽입 (가장 일반적) |
| `a` | 커서 뒤에 추가 (예: 문자 뒤에 텍스트 추가) |
| `I` | 줄 맨 앞에 무언가 추가 |
| `A` | 줄 맨 끝에 무언가 추가 (매우 일반적) |
| `o` | 아래에 새 줄 시작 (매우 일반적) |
| `O` | 위에 새 줄 시작 |

---

## 2. 텍스트 삭제

모든 삭제 명령은 일반 모드(Normal Mode)에서 동작합니다. 삭제된 텍스트는 레지스터(register, Vim의 클립보드)에 저장되므로 나중에 붙여넣을 수 있습니다.

### 문자 단위 삭제

| 명령 | 동작 |
|------|------|
| `x` | 커서 아래 문자 삭제 |
| `X` | 커서 앞 문자 삭제 (Backspace처럼) |

### 단어 단위 삭제

| 명령 | 동작 |
|------|------|
| `dw` | 커서에서 다음 단어 시작까지 삭제 |
| `de` | 커서에서 현재 단어 끝까지 삭제 |
| `db` | 커서에서 단어 시작까지 뒤로 삭제 |

### 줄 단위 삭제

| 명령 | 동작 |
|------|------|
| `dd` | 현재 줄 전체 삭제 |
| `D` | 커서에서 줄 끝까지 삭제 |
| `d0` | 커서에서 줄 시작까지 삭제 |

### 횟수를 사용한 삭제

| 명령 | 동작 |
|------|------|
| `3x` | 3개 문자 삭제 |
| `5dd` | 5개 줄 삭제 |
| `2dw` | 2개 단어 삭제 |

### 예시

```
Before: The quick brown fox jumps over the lazy dog
        ^ cursor here

x    →  he quick brown fox jumps over the lazy dog
dw   →  quick brown fox jumps over the lazy dog
dd   →  (entire line deleted)
D    →  The                (from cursor to end deleted)
```

---

## 3. 얀크(복사)와 풋(붙여넣기)

Vim은 고유한 용어를 사용합니다: **얀크(yank)**는 복사를 의미하고, **풋(put)**은 붙여넣기를 의미합니다.

### 얀크(복사)

| 명령 | 동작 |
|------|------|
| `yy` | 현재 줄 전체 얀크(복사) |
| `Y` | 현재 줄 전체 얀크 (`yy`와 동일) |
| `yw` | 커서에서 다음 단어 시작까지 얀크 |
| `y$` | 커서에서 줄 끝까지 얀크 |

### 풋(붙여넣기)

| 명령 | 동작 |
|------|------|
| `p` | 커서 뒤에 / 현재 줄 아래에 풋(붙여넣기) |
| `P` | 커서 앞에 / 현재 줄 위에 풋(붙여넣기) |

### 삭제와 풋의 관계

중요한 사실: **모든 삭제 명령은 텍스트도 함께 복사합니다**. 즉 `dd` 후 `p`는 사실상 "잘라내기 후 붙여넣기"입니다.

```
Line 1: First line
Line 2: Second line    ← cursor here
Line 3: Third line

dd   → "Second line"을 잘라냄 (레지스터에 저장됨)
       Line 1: First line
       Line 2: Third line    ← cursor here

p    → 현재 줄 아래에 붙여넣기:
       Line 1: First line
       Line 2: Third line
       Line 3: Second line   ← pasted here
```

### 줄 복제하기

가장 일반적인 작업 중 하나: `yy` 후 `p`를 누르면 현재 줄이 아래에 복제됩니다.

```
yy   → 현재 줄 얀크
p    → 아래에 붙여넣기

결과: 해당 줄이 두 번 나타남.
```

---

## 4. 텍스트 변경

**변경(change)** 명령(`c`)은 텍스트를 삭제하고 즉시 삽입 모드(Insert Mode)로 진입합니다 — 삭제 + 삽입의 조합입니다.

| 명령 | 동작 |
|------|------|
| `cw` | 단어 변경 (다음 단어까지 삭제 후 삽입 모드 진입) |
| `ce` | 단어 끝까지 변경 |
| `cc` | 줄 전체 변경 (줄 삭제 후 삽입 모드 진입) |
| `C` | 커서에서 줄 끝까지 변경 |
| `c$` | `C`와 동일 |
| `s` | 문자 대체 (문자 삭제 후 삽입 모드 진입) |
| `S` | 줄 대체 (`cc`와 동일) |

### 예시

```
Before: The quick brown fox
            ^ cursor on 'q'

cw   → The |brown fox           (커서가 | 위치에서 삽입 모드)
       "slow" 입력 → The slow brown fox

ce   → The | brown fox          ("quick" 삭제 후 삽입 모드)
       "fast" 입력 → The fast brown fox

cc   → |                        (줄 전체 비워짐, 삽입 모드)
       무엇이든 입력...
```

---

## 5. 실행 취소와 다시 실행

Vim의 실행 취소 시스템은 대부분의 편집기보다 강력합니다 — **무제한 다단계 실행 취소(unlimited multi-level undo)**와 심지어 **실행 취소 트리(undo tree)**(실행 취소 기록의 분기)도 지원합니다.

| 명령 | 동작 |
|------|------|
| `u` | 마지막 변경 실행 취소 |
| `U` | 현재 줄의 모든 변경 실행 취소 (덜 사용됨) |
| `Ctrl-r` | 다시 실행 (실행 취소를 되돌림) |

### 실행 취소 단위

삽입 모드(Insert Mode)에 진입해서 타이핑하고 일반 모드(Normal Mode)로 돌아올 때까지의 전체 삽입 세션이 **하나의 실행 취소 단위**로 계산됩니다. 따라서 삽입 모드에서 문단 전체를 입력하면, `u`를 누르면 문단 전체가 취소됩니다.

**팁**: 더 세밀한 실행 취소 지점을 만들려면 일반 모드를 더 자주, 짧게 사용하세요 (글을 쓰는 중간중간에 주기적으로 `Esc`를 누르세요).

### 횟수를 사용한 실행 취소

| 명령 | 동작 |
|------|------|
| `5u` | 마지막 5번의 변경 실행 취소 |
| `5Ctrl-r` | 5번의 변경 다시 실행 |

---

## 6. 저장과 종료

### 기본 명령어

| 명령 | 동작 |
|------|------|
| `:w` | 파일 저장(쓰기) |
| `:q` | 종료 (저장되지 않은 변경이 있으면 실패) |
| `:wq` | 저장 후 종료 |
| `:x` | 저장(변경된 경우에만) 후 종료 |
| `ZZ` | `:x`와 동일 (일반 모드 단축키) |
| `:q!` | 저장하지 않고 종료 (변경 사항 버림) |
| `ZQ` | `:q!`와 동일 (일반 모드 단축키) |
| `:wa` | 열린 모든 버퍼 저장 |
| `:qa` | 열린 모든 버퍼 종료 |
| `:wqa` | 모든 버퍼 저장 후 종료 |

### 다른 이름으로 저장

```vim
:w newfile.txt        " 현재 버퍼를 newfile.txt로 저장
:w! existing.txt      " existing.txt에 강제 덮어쓰기
```

### 읽기 전용 파일 작업

```vim
:w !sudo tee %        " sudo로 저장 (sudo 없이 열었을 때)
```

버퍼를 `sudo tee`를 통해 파이프하여 파일에 씁니다. `%`는 현재 파일명을 나타냅니다.

---

## 7. 명령 반복

### 점 명령(`.`)

`.` 키는 마지막 변경 명령을 반복합니다. Vim의 가장 강력한 기능 중 하나입니다.

```
dd    → 줄 삭제
.     → 또 다른 줄 삭제 (dd 반복)
.     → 또 다른 줄 삭제
```

```
cw    → 단어를 "hello"로 변경 (hello 입력 후 Esc)
w     → 다음 단어로 이동
.     → 이 단어도 "hello"로 변경
```

점 명령은 매우 중요해서 숙련된 Vim 사용자들은 이것을 중심으로 편집을 계획합니다. [레슨 5](./05_Operators_and_Composability.md)에서 이 개념을 깊이 탐구할 것입니다.

### 명령줄 명령 반복

| 명령 | 동작 |
|------|------|
| `@:` | 마지막 명령줄 명령 반복 |
| `@@` | `@:`를 다시 반복 |

---

## 8. 줄 합치기

| 명령 | 동작 |
|------|------|
| `J` | 현재 줄과 아래 줄을 합치기 (공백 추가) |
| `gJ` | 공백 없이 줄 합치기 |
| `3J` | 3개 줄 합치기 |

```
Before:
  Hello
  World

J →
  Hello World
```

---

## 9. 실전 편집 워크플로우

배운 모든 것을 결합한 현실적인 편집 세션 예시:

```
Task: Edit a Python function

1. vim app.py                     ← 파일 열기
2. /def calculate                 ← 함수 검색 (레슨 8)
3. j                              ← 다음 줄로 이동
4. A                              ← 줄 끝에 추가 (삽입 모드)
5. , timeout=30                   ← 새 매개변수 입력
6. Esc                            ← 일반 모드로 복귀
7. jj                             ← 2줄 아래로 이동
8. dd                             ← 줄 삭제
9. O                              ← 위에 줄 열기 (삽입 모드)
10. # Fixed: added timeout param  ← 주석 입력
11. Esc                           ← 일반 모드로 복귀
12. :wq                           ← 저장 후 종료
```

---

## 10. 요약

| 카테고리 | 명령어 | 설명 |
|----------|--------|------|
| 삽입(Insert) | `i`, `a`, `o`, `I`, `A`, `O` | 삽입 모드(Insert Mode)에 진입하는 다양한 방법 |
| 삭제(Delete) | `x`, `dw`, `dd`, `D` | 문자, 단어, 줄, 끝까지 삭제 |
| 얀크/풋(Yank/Put) | `yy`, `p`, `P` | 줄 복사, 앞/뒤에 붙여넣기 |
| 변경(Change) | `cw`, `cc`, `C`, `s` | 삭제 후 삽입 모드(Insert Mode) 진입 |
| 실행 취소(Undo) | `u`, `Ctrl-r` | 실행 취소, 다시 실행 |
| 저장/종료(Save/Quit) | `:w`, `:q`, `:wq`, `ZZ` | 저장, 종료, 둘 다 |
| 반복(Repeat) | `.` | 마지막 변경 반복 |
| 합치기(Join) | `J` | 줄 합치기 |

### 가장 중요한 세 가지 습관

1. **일반 모드(Normal Mode)에 머물기** — 타이핑할 때만 삽입 모드에 진입하고 즉시 복귀
2. **`u`를 자유롭게 사용하기** — 실행 취소는 무제한이므로 두려움 없이 실험
3. **`.`으로 반복하기** — `.`이 재현할 수 있도록 편집을 계획

---

## 연습 문제

### 연습 문제 1: 삽입 모드 진입 지점

다음 줄이 있습니다: `function greet(name) {`

커서는 `greet`의 `g` 위에 있습니다. 각 작업에 사용할 단일 키를 작성하세요:

1. 줄 위에 `// helper` 주석을 추가합니다 (위에 새 줄 열고 삽입 모드 진입).
2. 줄의 맨 앞에 `return `을 추가합니다.
3. 아래 새 빈 줄에 `  // end`를 추가합니다.
4. `function` 단어 뒤에 ` async`를 추가합니다.

<details>
<summary>정답 보기</summary>

1. `O` — 위에 새 줄을 열고 삽입 모드(Insert mode)로 진입합니다.
2. `I` — 커서를 줄의 맨 앞으로 이동하고 삽입 모드(Insert mode)로 진입합니다.
3. `o` — 아래에 새 줄을 열고 삽입 모드(Insert mode)로 진입합니다.
4. `function` 단어의 끝으로 이동한 후 (`b`로 뒤로, `e`로 단어 끝으로) `a`를 누릅니다 — 현재 문자 뒤에 추가하여 커서를 `function` 바로 뒤에 놓습니다.

</details>

### 연습 문제 2: 삭제 연산

다음 텍스트가 있습니다 (커서는 두 번째 줄 첫 번째 문자에 있음):

```
Line 1: import os
Line 2: import sys
Line 3: import json
Line 4: import re
```

각 연산을 처음부터 수행하세요:

1. 하나의 명령으로 2번 줄 전체를 삭제합니다.
2. `sys` 단어만 삭제합니다 (커서가 `sys`의 `s` 위에 있음).
3. 하나의 명령으로 2, 3, 4번 줄을 삭제합니다.

<details>
<summary>정답 보기</summary>

1. `dd` — 현재 줄 전체를 삭제합니다.
2. `de` — 커서에서 현재 단어(`sys`)의 끝까지 삭제합니다. 또는 `dw`는 `sys`와 뒤따르는 공백을 삭제합니다.
3. `3dd` — 현재 줄부터 시작해 3줄을 삭제합니다.

</details>

### 연습 문제 3: 얀크, 풋, 점 명령

`console.log("debug");` 줄을 아래에 5번 복제하고 싶습니다. 가장 효율적인 명령 시퀀스를 설명하세요.

<details>
<summary>정답 보기</summary>

1. `console.log("debug");` 줄에 커서를 위치시킵니다.
2. `yy` — 줄을 얀크(복사)합니다.
3. `p` — 아래에 붙여넣습니다; 이제 줄이 두 번 있습니다.
4. `.` — 마지막 변경(붙여넣기)을 반복합니다; 이제 3번.
5. `.` — 4번.
6. `.` — 5번.

합계: `yy p . . .` — 6번의 키 입력으로 5개의 복사본 생성.

또는: `yy 4p`는 한 번에 4개의 복사본을 붙여넣어 총 5줄(원본 + 4개 붙여넣기)이 됩니다.

</details>

### 연습 문제 4: 변경 vs. 삭제

`The old house` 줄에서 커서가 `old` 단어 위에 있을 때 다음 두 명령 시퀀스의 차이점을 설명하세요:

- 시퀀스 A: `dw` 후 `i` 후 `new` 입력
- 시퀀스 B: `cw` 후 `new` 입력

어떤 것이 더 낫고 이유는 무엇인가요?

<details>
<summary>정답 보기</summary>

두 시퀀스 모두 `The new house`를 생성하지만:

- **시퀀스 A** (`dw` + `i` + 입력): 세 가지 별도 동작 — 단어 삭제, 삽입 모드 진입, 입력. 점 명령(`.`)은 `i` + 입력 부분만 반복하고 삭제는 반복하지 않습니다.
- **시퀀스 B** (`cw` + 입력): 단일 원자적 변경(atomic change). 전체 작업(단어 삭제 + 새 텍스트 삽입)이 하나의 실행 취소 단위이자 점 반복 가능한 동작으로 기록됩니다.

**시퀀스 B가 선호됩니다** — `cw`는 단일 반복 가능한 동작을 생성하기 때문입니다. `old`를 `new`로 변경해야 하는 다른 위치가 있다면 시퀀스 B 후 `.`을 누르기만 하면 됩니다.

</details>

### 연습 문제 5: 실행 취소 트리 탐색

새 파일(`vim practice.txt`)로 Vim을 열고 다음 단계를 수행하세요:

1. 삽입 모드에서 `first`를 입력한 후 `Esc`를 누릅니다.
2. `A`를 입력하여 추가 모드로 진입, ` second`를 추가하고 `Esc`를 누릅니다.
3. `u`를 두 번 누릅니다. 텍스트의 상태는?
4. 이제 `Ctrl-r`을 한 번 누릅니다. 텍스트의 상태는?

<details>
<summary>정답 보기</summary>

1. 1단계 후: `first`
2. 2단계 후: `first second`
3. `u`를 두 번 누른 후:
   - 첫 번째 `u`: ` second` 추가를 취소 → 텍스트는 `first`
   - 두 번째 `u`: `first` 삽입을 취소 → 텍스트는 비어 있음 (빈 버퍼)
4. `Ctrl-r` 후: 마지막으로 취소된 변경을 다시 실행 → 텍스트는 다시 `first`.

이것은 각 삽입 모드 세션(진입 → 입력 → Esc)이 하나의 실행 취소 단위로 계산된다는 것을 보여줍니다. 두 번의 `u`는 두 개의 별도 삽입 모드 세션을 취소했습니다.

</details>

---

**이전**: [모드와 기본 내비게이션](./02_Modes_and_Basic_Navigation.md) | **다음**: [모션과 내비게이션](./04_Motions_and_Navigation.md)
