# 비주얼 모드(Visual Mode)

**이전**: [텍스트 객체](./06_Text_Objects.md) | **다음**: [검색과 치환](./08_Search_and_Replace.md)

---

## 학습 목표

이 레슨을 완료하면 다음을 할 수 있습니다:

1. 문자 단위(`v`), 행 단위(`V`), 블록 단위(`Ctrl-v`) 비주얼 모드를 구분한다
2. 비주얼 모드에서 모션과 텍스트 객체를 사용하여 텍스트를 선택한다
3. 비주얼 선택에 연산자를 적용한다 (삭제, 복사, 변경, 들여쓰기)
4. 비주얼 블록 모드를 사용하여 열 편집을 수행한다 (다중 행 삽입, 삭제, 교체)
5. `gv`로 이전 선택을 다시 선택하고, `o`로 선택 끝점을 전환한다

---

비주얼 모드(Visual Mode)는 동작을 수행하기 전에 선택 영역을 **시각적으로 확인**할 수 있게 해줍니다. 숙련된 사용자에게는 연산자 + 모션/텍스트 객체 조합이 일반적으로 더 빠르지만, 비주얼 모드는 안전망을 제공합니다. 동작을 확정하기 전에 선택을 검증할 수 있습니다. 또한 열(column) 편집과 같은 특정 작업은 비주얼 모드에서만 가능합니다.

## 목차

1. [세 가지 비주얼 모드 유형](#1-세-가지-비주얼-모드-유형)
2. [문자 단위 비주얼 모드](#2-문자-단위-비주얼-모드)
3. [행 단위 비주얼 모드](#3-행-단위-비주얼-모드)
4. [블록 비주얼 모드](#4-블록-비주얼-모드)
5. [비주얼 선택에 대한 작업](#5-비주얼-선택에-대한-작업)
6. [유용한 비주얼 모드 기법](#6-유용한-비주얼-모드-기법)
7. [비주얼 모드 vs 연산자](#7-비주얼-모드-vs-연산자)
8. [요약](#8-요약)

---

## 1. 세 가지 비주얼 모드 유형

| 키 | 모드 | 선택 단위 | 표시 |
|-----|------|---------|-----------|
| `v` | 문자 단위(Character-wise) | 임의의 문자 범위 | `-- VISUAL --` |
| `V` | 행 단위(Line-wise) | 전체 줄 | `-- VISUAL LINE --` |
| `Ctrl-v` | 블록 단위(Block-wise) | 직사각형 블록 (열) | `-- VISUAL BLOCK --` |

### 비주얼 모드 간 전환

비주얼 모드에 있는 동안, 다른 비주얼 키를 눌러 전환할 수 있습니다:
- `v` 모드에서 `V`를 누르면 행 단위로 전환
- `V` 모드에서 `Ctrl-v`를 누르면 블록 단위로 전환
- `Esc` 또는 같은 키를 다시 눌러 비주얼 모드 종료

---

## 2. 문자 단위 비주얼 모드(`v`)

`v`를 눌러 문자 하나씩 선택을 시작합니다. 이후 임의의 모션으로 선택 범위를 확장합니다.

```
Text: The quick brown fox jumps over the lazy dog

1. 'q'(quick의 첫 글자)에 커서 위치
2. v 누르기        → 선택 시작
3. e 누르기        → "quick" 선택
4. e 다시 누르기   → "quick brown"으로 확장
5. d 누르기        → 선택 영역 삭제
```

### 모션으로 선택 확장

비주얼 모드에서 모든 모션이 동작합니다:

| `v` 후 누르기... | 선택 범위 |
|---------------------|---------|
| `w` | 다음 단어 시작까지 |
| `e` | 단어 끝까지 |
| `$` | 행 끝까지 |
| `}` | 다음 문단까지 |
| `f.` | 다음 마침표까지 |
| `G` | 파일 끝까지 |
| `/pattern` | 다음 매치까지 |

### 비주얼 모드에서 텍스트 객체 사용

| `v` 후 누르기... | 선택 범위 |
|---------------------|---------|
| `iw` | 내부 단어 |
| `i"` | 내부 따옴표 |
| `i(` | 내부 소괄호 |
| `it` | 내부 태그 |
| `ip` | 내부 문단 |

```
Text: result = calculate(x, y, z)
                         ^ 커서

v + i( → "x, y, z" 선택
v + a( → "(x, y, z)" 선택
```

---

## 3. 행 단위 비주얼 모드(`V`)

`V`를 눌러 전체 줄을 선택합니다. 모션으로 줄 단위씩 선택 범위를 확장합니다.

```
def function_one():
    return 1            ← 커서 위치, V 누르기

def function_two():     ← j 누르기 (선택 확장)
    return 2            ← j 누르기 (더 확장)

이제 d 누르기 → 4줄 모두 삭제
또는 > 누르기 → 4줄 모두 들여쓰기
```

### 일반적인 행 단위 선택

| 동작 | 키 |
|--------|------|
| 현재 줄 선택 | `V` |
| 현재 줄 + 다음 4줄 선택 | `V4j` |
| 파일 끝까지 선택 | `VG` |
| 전체 함수 선택 (빈 줄 사이) | `Vip` |
| 매칭 괄호까지 선택 | `V%` |

---

## 4. 블록 비주얼 모드(`Ctrl-v`)

블록 모드는 **직사각형 영역** — 텍스트의 열(column)을 선택합니다. 이는 Vim만의 고유한 기능으로, 구조화된 데이터 처리에 매우 강력합니다.

### 기본 열 선택

```
Line 1: apple
Line 2: banana
Line 3: cherry
Line 4: date

1. "apple"의 'a'에 커서
2. Ctrl-v       → 블록 모드 진입
3. 3j           → 3줄 아래로 확장
4. e            → 단어 끝까지 확장

선택 영역 (강조 표시):
Line 1: [apple]
Line 2: [banan]a
Line 3: [cherr]y
Line 4: [date]
```

### 열 삽입(Column Insert)

여러 줄의 동일한 위치에 텍스트 삽입:

```
변경 전:
line one
line two
line three

1. Ctrl-v         → 블록 모드
2. 2j             → 3줄 선택
3. I              → 블록 앞에 삽입 (대문자 I)
4. "# " 입력      → 텍스트 입력
5. Esc            → 모든 줄에 적용

변경 후:
# line one
# line two
# line three
```

### 열 추가(Column Append)

```
변경 전:
item1
item2
item3

1. Ctrl-v         → 블록 모드
2. 2j             → 3줄 선택
3. $              → 줄 끝까지 확장
4. A              → 블록 뒤에 추가 (대문자 A)
5. "," 입력       → 텍스트 입력
6. Esc            → 모든 줄에 적용

변경 후:
item1,
item2,
item3,
```

### 열 교체(Column Replace)

```
변경 전:
aaa bbb ccc
aaa bbb ccc
aaa bbb ccc

1. Ctrl-v         → 첫 번째 열에서 블록 모드
2. 2j, 2l         → 3×3 블록 선택
3. r#             → 선택된 모든 문자를 #으로 교체

변경 후:
### bbb ccc
### bbb ccc
### bbb ccc
```

### 열 삭제(Column Delete)

```
변경 전:
    line one       (공백 4칸 들여쓰기)
    line two
    line three

1. Ctrl-v         → 블록 모드
2. 2j             → 3줄 선택
3. 3l             → 4열 선택
4. d              → 삭제

변경 후:
line one
line two
line three
```

---

## 5. 비주얼 선택에 대한 작업

선택을 완료한 후, 임의의 연산자를 적용합니다:

| 키 | 동작 |
|-----|--------|
| `d` 또는 `x` | 선택 영역 삭제 |
| `c` | 선택 영역 변경 (삭제 + 삽입 모드) |
| `y` | 선택 영역 복사(yank) |
| `>` | 선택 영역 들여쓰기 |
| `<` | 선택 영역 내어쓰기 |
| `=` | 선택 영역 자동 들여쓰기 |
| `~` | 대소문자 토글 |
| `U` | 대문자로 변환 |
| `u` | 소문자로 변환 |
| `J` | 선택한 줄 합치기 |
| `gq` | 텍스트 포맷/줄 바꿈 |
| `:` | 범위 작업을 위한 명령줄 모드 진입 |
| `r{char}` | 모든 문자를 `{char}`로 교체 |

### 여러 줄 들여쓰기

```
V       → 현재 줄 선택
4j      → 선택 4줄 아래로 확장
>       → 한 번 들여쓰기 (>> 사용 시 추가 들여쓰기)

더 많이 들여쓰기:
V4j     → 5줄 선택
3>      → 3단계 들여쓰기
```

### 줄 정렬

```
V       → 행 단위 선택
{확장 모션}
:sort   → 선택한 줄을 알파벳 순으로 정렬
```

---

## 6. 유용한 비주얼 모드 기법

### `gv`로 재선택

`gv`는 이전 비주얼 선택을 다시 선택합니다. 여러 작업을 적용해야 할 때 유용합니다:

```
V5j>    → 5줄 선택 후 들여쓰기
gv>     → 같은 줄을 다시 선택하고 한 번 더 들여쓰기
```

### `o`로 끝점 전환

비주얼 모드에서 `o`를 누르면 선택의 시작점과 끝점 사이를 이동하여, 어느 쪽 경계든 조정할 수 있습니다:

```
Text: The quick brown fox

v → 'T'에서 시작
w → 'quick'까지 확장 (선택: "The q")
o → 커서가 'T'(선택 시작점)로 이동
b → 이제 시작점에서 선택을 줄이거나 늘릴 수 있음
```

### 전체 선택

```
ggVG    → 첫 번째 줄로 이동, 비주얼 행 모드, 마지막 줄로 이동
```

### 비주얼 모드 검색

비주얼 모드에서 검색하여 선택 범위를 확장할 수 있습니다:

```
v         → 비주얼 시작
/function → "function"까지 선택 확장
```

### 숫자 증가/감소

```
숫자 위에서 선택:
10
20
30

g Ctrl-a  → 각 숫자 증가 (11, 22, 33이 됨 — 순차 증가)
Ctrl-a    → 모두 1씩 증가 (11, 21, 31이 됨)
```

---

## 7. 비주얼 모드 vs 연산자

### 비주얼 모드를 사용해야 할 때

- **불확실한 선택**: 동작을 수행하기 전에 선택 영역을 확인하고 싶을 때
- **불규칙한 범위**: 선택 영역이 단일 모션/텍스트 객체로 명확하게 매핑되지 않을 때
- **블록 작업**: 열 편집은 비주얼 블록 모드에서만 가능
- **학습/교육**: 비주얼 모드는 학습 중에 시각적 피드백을 제공

### 연산자를 직접 사용해야 할 때

- **알려진 대상**: 무엇을 조작할지 정확히 알 때 (예: `diw`, `ci"`)
- **속도**: 연산자 + 모션이 더 적은 키 입력
- **점(dot) 반복 가능**: `dw`는 `.`으로 반복 가능하지만, `vwd`는 불가능 (비주얼 선택은 반복 불가)

### 비교

| 작업 | 비주얼 모드 | 연산자 |
|------|------------|----------|
| 단어 삭제 | `viwx` (4키) | `diw` (3키) |
| 따옴표 내용 변경 | `vi"c` (4키) | `ci"` (3키) |
| 줄 끝까지 복사 | `v$y` (3키) | `y$` (2키) |
| 3줄 삭제 | `V2jd` (4키) | `3dd` (3키) |

연산자는 보통 더 간결하고 점(dot) 반복이 가능합니다. 선택 영역을 시각적으로 확인해야 할 때 비주얼 모드를 사용하세요.

---

## 8. 요약

| 모드 | 키 | 선택 유형 | 최적 사용 상황 |
|------|-----|---------------|----------|
| 문자(Character) | `v` | 임의의 범위 | 정밀한 텍스트 선택 |
| 행(Line) | `V` | 전체 줄 | 들여쓰기, 이동, 줄 삭제 |
| 블록(Block) | `Ctrl-v` | 직사각형/열 | 열 편집, 다중 행 삽입 |

| 기법 | 키 | 설명 |
|-----------|------|-------------|
| 재선택 | `gv` | 이전 선택 재선택 |
| 끝점 전환 | `o` | 선택 경계 간 이동 |
| 블록 삽입 | `Ctrl-v` → `I` → 입력 → `Esc` | 열에 삽입 |
| 블록 추가 | `Ctrl-v` → `$A` → 입력 → `Esc` | 끝에 추가 |
| 전체 선택 | `ggVG` | 파일 전체 선택 |

### 연습 팁

1. `V` (행 단위)부터 시작하세요 — 가장 직관적입니다
2. `v` + 텍스트 객체 (`viw`, `vi"`)로 연습하세요
3. 열 편집 작업 (주석 처리, 정렬)에는 `Ctrl-v`를 시도해보세요
4. 자신감이 붙으면 점차 직접 연산자로 전환하세요

---

## 연습 문제

### 연습 문제 1: 올바른 비주얼 모드 선택

각 시나리오에서 어떤 비주얼 모드(`v`, `V`, `Ctrl-v`)가 가장 적합한지와 이유를 설명하세요:

1. 5줄의 시작에 `//`를 추가하여 주석 처리하고 싶습니다.
2. 더 긴 문자열 안의 `"error"` 단어만 선택하여 교체하고 싶습니다.
3. 함수의 완전한 3줄을 삭제하고 싶습니다.
4. 6줄 앞의 공백 4칸 들여쓰기를 동시에 제거하고 싶습니다.

<details>
<summary>정답 보기</summary>

1. **`Ctrl-v`** (블록 비주얼) — 열 삽입(Column Insert)으로 5줄 모두의 1번 열에 `//`를 한 번에 추가합니다: 줄들을 가로질러 1번 열을 선택하고 `I//Esc` 사용.
2. **`v`** (문자 단위) — 줄 전체가 아닌 줄 내의 임의의 문자 범위를 선택해야 합니다.
3. **`V`** (행 단위) — 완전한 줄 삭제와 같은 전체 줄 작업은 행 단위 모드가 가장 깔끔합니다.
4. **`Ctrl-v`** (블록 비주얼) — 6줄 전체의 처음 4열을 선택한 후 `d`를 눌러 들여쓰기 블록을 삭제합니다.

</details>

### 연습 문제 2: 블록 비주얼 열 삽입

다음 항목 목록이 있습니다:

```
apple
banana
cherry
date
```

비주얼 블록 모드(Visual Block mode)를 사용하여 다음으로 변환하는 정확한 키 시퀀스를 설명하세요:

```
- apple
- banana
- cherry
- date
```

<details>
<summary>정답 보기</summary>

1. `apple`의 `a`(1번 열)에 커서를 놓습니다.
2. `Ctrl-v`를 누릅니다 — 비주얼 블록 모드(Visual Block mode) 진입.
3. `3j`를 누릅니다 — 선택을 3줄 아래로 확장 (이제 4줄 모두의 1번 열 포함).
4. `I`를 누릅니다 — (대문자 I) 블록 앞에 삽입 모드로 진입.
5. `- `를 입력합니다 — (대시 공백).
6. `Esc`를 누릅니다 — Vim이 4줄 모두에 삽입을 적용합니다.

결과: `- `가 선택된 모든 줄의 앞에 추가됩니다.

</details>

### 연습 문제 3: gv와 o 키

`V3j>`를 사용하여 4줄을 들여쓰기 했습니다. 이제 한 단계 더 들여써야 한다는 것을 알았습니다. 가장 효율적인 명령은 무엇입니까?

보너스: 문자 비주얼 모드 사용 중 실수로 너무 멀리 선택하여, 선택을 다시 시작하지 않고 끝에서 선택을 줄이고 싶습니다. 어떻게 합니까?

<details>
<summary>정답 보기</summary>

**주 질문**: `gv>`를 누릅니다 — `gv`는 정확히 동일한 4줄 비주얼 선택을 다시 선택하고, `>`는 한 번 더 들여씁니다. `V3j>`를 다시 하는 것보다 훨씬 빠릅니다.

**보너스**: 비주얼 모드에서 커서가 선택의 끝 쪽에 있을 때, `o`를 누릅니다 — 커서가 반대쪽 끝(선택 시작)으로 이동합니다. 이제 `b`나 `h` 같은 모션을 눌러 이전에 끝이었던 위치에서 선택의 **끝**을 뒤로 이동시켜 선택을 줄일 수 있습니다.

</details>

### 연습 문제 4: 비주얼 vs. 연산자 효율성

각 비주얼 모드 작업을 직접 연산자 + 텍스트 객체 조합으로 다시 작성하세요 (비주얼 모드 없이):

1. `viwd` — 내부 단어 선택, 삭제
2. `vi"c` — 따옴표 내부 선택, 변경
3. `Vd` — 현재 줄 선택, 삭제
4. `vi(y` — 괄호 내부 선택, 복사

<details>
<summary>정답 보기</summary>

1. `viwd` → `diw` — 내부 단어 삭제 (4키 대신 3키)
2. `vi"c` → `ci"` — 따옴표 내부 변경 (4키 대신 3키)
3. `Vd` → `dd` — 현재 줄 삭제 (2키 vs 2키 — 동일!)
4. `vi(y` → `yi(` — 괄호 내부 복사 (4키 대신 3키)

참고: 연산자+텍스트 객체 형식은 항상 최소한 같거나 더 효율적(보통 더 적은 키 입력)이며, 비주얼 모드 버전과 달리 **도트 반복이 가능**합니다.

</details>

### 연습 문제 5: 실제 블록 편집

CSV 파일에서 각 행의 두 번째 열을 제거해야 합니다:

```
John,Smith,30,Engineer
Jane,Doe,25,Designer
Bob,Jones,35,Manager
```

비주얼 블록 모드(Visual Block mode)를 사용하여 `,Smith`, `,Doe`, `,Jones` 부분(두 번째 필드와 앞의 쉼표 포함)을 삭제하는 방법을 설명하세요.

<details>
<summary>정답 보기</summary>

1. `John` 다음의 `,`(Smith 앞의 첫 번째 쉼표)에 커서를 놓습니다.
2. `Ctrl-v`를 눌러 비주얼 블록 모드(Visual Block mode)로 진입합니다.
3. `2j`를 눌러 블록을 3행 모두로 확장합니다.
4. `f,`를 누릅니다 — 다음 `,`로 앞으로 이동 (이제 블록이 `,Smith`, `,Doe`, `,Jones`를 포함).
5. `d`를 눌러 선택된 블록을 삭제합니다.

결과:
```
John,30,Engineer
Jane,25,Designer
Bob,35,Manager
```

참고: 비주얼 블록 모드는 각 행의 내용이 달라도 동일한 열 범위를 모든 선택된 행에 적용하기 때문에 이것이 가능합니다.

</details>

---

**이전**: [텍스트 객체](./06_Text_Objects.md) | **다음**: [검색과 치환](./08_Search_and_Replace.md)
