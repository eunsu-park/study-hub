# 예보 모델

## 학습 목표

- 우주 기상 모델을 경험적, 물리 기반, 반경험적 범주로 분류하고 각각의 장단점을 설명한다
- 광구 자기도에서 지구 근방 태양권 조건까지 이어지는 WSA-ENLIL 태양풍 모델링 체인을 설명한다
- 물리 기반 및 경험적 자기권 모델과 폭풍 예보에서의 역할을 기술한다
- 전리권 모델(IRI, SAMI3, TIEGCM)의 입력, 출력, 한계를 이해한다
- 위상 공간 밀도 진화에 대한 포커-플랑크 방정식을 풀어 복사대를 모델링하는 방법을 설명한다
- 예보 검증 지표(POD, FAR, TSS, 브라이어 점수, ROC)를 적용하여 모델 성능을 평가한다
- 운영 예보 워크플로에서 주의보(watch), 경보(warning), 긴급 경보(alert) 상품의 차이를 구분한다

---

## 1. 모델 분류

우주 기상 예보에는 매우 다양한 복잡도를 가진 모델들이 활용된다. 분류 체계를 이해하면 각 문제에 적합한 도구를 선택하는 데 도움이 된다.

**경험적/통계적 모델(Empirical/statistical models)**은 역사적 데이터만으로 구축된다. 물리 방정식을 풀지 않고 입력값(예: 태양풍 파라미터)과 출력값(예: Dst) 사이의 상관관계를 찾아낸다. 정교한 패턴 매칭으로 생각할 수 있다. 즉, 과거에 비슷한 조건에서 무슨 일이 일어났는가를 보는 것이다.

장점: 빠른 계산, 구현 용이, 물리학이 완전히 기술하지 못하는 복잡한 비선형 관계도 포착 가능. 단점: 학습 데이터 범위를 벗어난 외삽 불가(극단적 사건에서 위험), 물리적 통찰 제공 불가, 시스템 특성이 변할 경우 실패할 수 있음.

**물리 기반(제1원리) 모델(Physics-based/first-principles models)**은 기본 방정식 — MHD, 볼츠만/블라소프, 맥스웰 — 을 계산 격자 위에서 수치적으로 풀어낸다. 이 모델들은 시스템에 대한 물리적 이해를 구현한다.

장점: 원칙적으로 전례 없는 사건도 예측 가능, 공간·시간적 세부 정보 제공, 물리적 자기 일관성. 단점: 계산 비용이 큼(수 시간~수 일의 실시간 계산 시간), 초기 및 경계 조건에 민감, 방정식에 포함되지 않은 물리(예: MHD 모델에서의 운동론적 효과)를 놓칠 수 있음.

**반경험적 모델(Semi-empirical models)**은 물리 기반 프레임워크를 사용하되 특정 구성 요소를 경험적 매개변수화로 대체한다. 예를 들어, 차가넨코(Tsyganenko) 자기장 모델은 자기권 전류계에 대해 수학적으로 올바른 형식을 갖추되, 경험적으로 맞춘 계수를 사용한다. 이 접근법은 실용적인 중간 지점이다.

**운영 모델 대 연구 모델.** 운영 모델은 다음을 만족해야 한다:
- 실시간보다 빠르게 실행(1시간 예보는 몇 분 안에 계산)
- 누락되거나 품질이 낮은 입력값도 정상적으로 처리
- 표준화되고 해석 가능한 형식으로 출력
- 문서화된 기술 점수 및 알려진 실패 모드

연구 모델은 실행에 수 일이 걸릴 수 있고 전문가의 조정이 필요하다. 연구에서 운영으로의 전환은 길고 까다로운 과정이다.

---

## 2. 태양풍 모델

### 2.1 WSA(Wang-Sheeley-Arge) 모델

WSA 모델은 태양 광구 자기장 관측으로부터 지구에서의 배경 태양풍 속도를 예측한다. 운영 우주 기상 예보에서 표준 코로나 모델이다.

**3단계 절차:**

**1단계: 포텐셜 필드 소스 표면(PFSS) 외삽.** 광구 반경 방향 자기장 $B_r$의 전면 지도인 동기 자기도에서 시작하여, 광구($r = R_\odot$)와 소스 표면($r = R_{SS} \approx 2.5 R_\odot$) 사이의 포텐셜(전류 없는) 자기장을 푼다:

$$\nabla^2 \Phi = 0 \quad \text{with} \quad B_r|_{R_\odot} = \text{observed}, \quad B_r|_{R_{SS}} = \text{radial}$$

소스 표면 조건은 $R_{SS}$에서 자기력선이 방사상이 되도록 강제하여 태양풍 흐름의 효과를 모사한다. 이 해는 코로나 자기장 위상: 열린 자기장 영역(코로나 구멍) 대 닫힌 루프를 제공한다.

**2단계: 팽창 인자.** 각 열린 자기력선에 대해 팽창 인자를 계산한다:

$$f_s = \frac{(R_\odot / R_{SS})^2}{|B_r(R_\odot)| / |B_r(R_{SS})|}$$

$f_s$가 작으면 자속관이 천천히 팽창함을 의미한다 — 큰 코로나 구멍을 통과하며 빠른 바람을 실어 나른다. $f_s$가 크면 작은 코로나 구멍의 경계 근처에서 빠른 팽창을 의미하며 — 느린 바람과 관련된다.

또한 자속관 발자국에서 가장 가까운 코로나 구멍 경계까지의 각도 거리 $\theta_b$도 계산한다.

**3단계: 경험적 속도 관계.** $R_{SS}$에서의 태양풍 속도는:

$$v_{sw} = v_{\text{fast}} - v_{\text{range}} \cdot \frac{f_s^{1/\alpha}}{1 + f_s^{1/\alpha}} \cdot \left(1 - 0.8 \exp\left[-(\theta_b/\theta_0)^\beta\right]\right)^3$$

여기서 $v_{\text{fast}} \approx 625$ km/s, $v_{\text{range}} \approx 240$ km/s, $\alpha, \beta, \theta_0$는 경험적으로 조정된 파라미터이다. 첫 번째 인자는 팽창과 속도 사이의 반비례 관계를 포착하고, 두 번째 인자는 코로나 구멍 경계와의 근접성에 대한 보정이다.

**WSA의 한계:** 포텐셜 자기장(전류 없음)을 사용하므로 스트리머 벨트나 CME 관련 자기장을 정확하게 모델링할 수 없다. 동기 자기도는 완전한 태양 자전(~27일)이 필요하므로 반대편 정보는 항상 ~2주가 지난 것이다.

### 2.2 ENLIL 모델

ENLIL(수메르의 바람의 신 이름)은 두산 오드스트르칠이 개발한 태양권의 3차원 시간 의존 MHD 모델이다.

**영역:** 내부 경계 $21.5 R_\odot$(WSA 입력이 제공되는 곳)에서 1-10 AU까지.

**방정식:** ENLIL은 회전 태양권 좌표계에서 이상적 MHD 방정식을 풀어낸다:

$$\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{v}) = 0$$

$$\frac{\partial (\rho \mathbf{v})}{\partial t} + \nabla \cdot \left[\rho \mathbf{v}\mathbf{v} + \left(p + \frac{B^2}{2\mu_0}\right)\mathbf{I} - \frac{\mathbf{B}\mathbf{B}}{\mu_0}\right] = -\rho \frac{GM_\odot}{r^2}\hat{r} + \rho \mathbf{a}_{\text{rot}}$$

$$\frac{\partial \mathbf{B}}{\partial t} - \nabla \times (\mathbf{v} \times \mathbf{B}) = 0$$

다중 열적(polytropic) 또는 더 정교한 클로저를 갖는 에너지 방정식을 포함한다.

**CME 삽입:** CME는 내부 경계에서 유체역학적 펄스로 도입된다 — CME의 방향, 각폭, 속도, 밀도 증가를 지정하는 "콘 모델(cone model)". 더 발전된 버전은 깁슨-로우(Gibson-Low) 자속 로프(flux rope) 모델을 사용한다.

**운영 활용:** ENLIL은 NOAA/SWPC에서 WSA 입력으로 실행되며, 지구(및 다른 행성)에서의 태양풍 조건을 최대 4-5일 전까지 예보한다. 전형적인 실행 시간: 현대 클러스터에서 ~1시간.

**성능:** 배경 태양풍에 대해 ENLIL은 고속 스트림 구조를 합리적으로 잘 포착한다. CME 도착 시간의 경우 전형적인 오차는 $\pm 10-12$시간이며, 간혹 $>24$시간의 오차가 발생하기도 한다. 밀도와 자기장 예측은 속도 예측보다 신뢰성이 낮다.

### 2.3 기타 태양권 모델

**EUHFORIA (European Heliospheric Forecasting Information Asset):** KU 뢰번에서 개발한 EUHFORIA는 선형 무전류 구형 모델(spheromak) 및 비선형 자속 로프(FRi3D) 삽입을 포함하는 더 현실적인 CME 모델을 제공하여 ENLIL을 개선했다. 향상된 CME 기하학으로 지구에서 자기장 예측이 개선된다.

**SWASTi (Space Weather Adaptive SimulaTion):** 인도 지자기 연구소에서 개발한 SWASTi는 코로나 모델과 MHD 태양권 솔버를 결합하고 태양 에너지 입자(SEP) 전송 모듈을 포함한다.

**항력 기반 모델(DBM, Drag-based model):** CME 전파를 주변 태양풍에서의 공기역학적 항력으로 취급하는 단순하지만 놀랍도록 효과적인 모델이다:

$$\frac{dv}{dt} = -\gamma (v - v_{sw})|v - v_{sw}|$$

여기서 $\gamma$는 항력 계수(경험적으로 $\sim 0.2 - 2.0 \times 10^{-7}$ km$^{-1}$)이고 $v_{sw}$는 주변 바람 속도이다. 단순함에도 불구하고 DBM은 완전한 MHD 모델과 비슷한 CME 도착 시간 오차($\pm 10-15$시간)를 달성하며 밀리초 단위로 실행된다.

---

## 3. 자기권 모델

### 3.1 경험적 자기장 모델

차가넨코(Tsyganenko) 모델군은 외부 파라미터의 함수로서 자기권의 임의 지점에서의 자기장 벡터를 제공한다.

**T89:** 가장 단순한 버전으로 Kp만으로 매개변수화된다. 각 전류계(고리 전류, 꼬리 전류, 자기권계면 전류, 자기력선 정렬 전류)는 Kp에 따라 진폭이 스케일되는 수학 함수로 표현된다.

**T96:** 태양풍 동압 $P_{\text{dyn}}$, IMF $B_y$ 및 $B_z$, Dst에 대한 명시적 의존성을 추가한다. 이를 통해 모델이 단순히 종합적인 Kp가 아닌 특정 태양풍 조건에 반응할 수 있다.

**TS04 (T04S):** "폭풍 시간" 공식화를 사용하여 모델 파라미터가 태양풍 입력의 시간 이력(직전 수 시간에 걸쳐 통합)에 의해 구동되어, 변화하는 조건에 대한 자기권의 지연 반응을 표현할 수 있다.

**TS07:** 가장 유연한 버전으로, 위성 자기장 측정의 대규모 데이터베이스에 적합된 기저 함수 확장을 사용한다. 미리 정해진 전류계 형태 없이 — 모델이 데이터로부터 자기장 구조를 학습한다.

**적용:** 차가넨코 모델은 다음 용도로 사용된다:
- 자기력선 추적(전리권 발자국을 적도면에 매핑)
- 복사대 연구를 위한 단열 불변량($\mu$, $J$, $L^*$) 계산
- 입자 추적 코드의 배경 자기장
- 신속한 자기권 시각화

**한계:** 이 모델들은 주어진 입력 파라미터에 대한 통계적 평균을 제공한다. 개별 서브스톰의 역학, 얇은 전류 시트의 세부 구조, 또는 재연결은 포착할 수 없다.

### 3.2 전구(全球) MHD 모델

전구 자기권 MHD 모델은 주간 태양풍(~30 $R_E$ 상류)에서 깊은 꼬리(~200 $R_E$)까지 이어지는 영역에서 이상적 또는 저항성 MHD 방정식을 풀며, 내부 경계(~2-3 $R_E$)에서 전리권 전기역학 솔버와 결합된다.

**주요 모델:**

| 모델 | 기관 | 격자 | 특징 |
|-------|------------|------|-----------------|
| SWMF/BATS-R-US | U. Michigan | 적응형 직교 | 다중 물리 프레임워크, SWPC에서 운영 |
| LFM/CMIT | NCAR/Dartmouth | 왜곡된 논리적 직사각형 | 고해상도 자기권계면, TING 결합 |
| OpenGGCM | UNH | 신축된 직교 | 오픈소스, 결합 열권-전리권 |
| GUMICS | FMI (Finland) | 적응형 직교 | 완전 보존 방식 |

**SWMF(Space Weather Modeling Framework)**는 특별히 언급할 만하다. BATS-R-US(전구 MHD)와 다음을 결합한다:
- RIM(Ridley 전리권 모델): 전리권 전기역학
- RCM(Rice 대류 모델): 고리 전류 물리
- CRCM 또는 RAM-SCB: 복사대 역학

이러한 결합 접근법은 이상적 MHD가 고리 전류 에너지화(MHD에 없는 경도/곡률 표류 물리를 수반)를 포착할 수 없기 때문에 필요하다.

**MHD 모델이 잘 포착하는 것:**
- 자기권계면 위치와 형태
- 대규모 대류 패턴
- 폭풍 및 서브스톰의 자기장 재구성
- 극관 횡단 전위

**MHD 모델이 어려움을 겪는 것:**
- 자기 재연결(격자 해상도에 의존, 종종 수치 저항성 사용)
- 복사대 역학(단일 입자 물리 없음)
- 고리 전류(표류-운동 모델과의 결합 필요)
- 전리권 유출(종종 거칠게 매개변수화)

### 3.3 지구 공간 모델 결합

현대 지구 공간 모델링은 서로 다른 모델 유형의 강점을 결합하는 결합 프레임워크를 지향하고 있다:

$$\text{태양풍 (ENLIL)} \rightarrow \text{자기권 (MHD)} \rightarrow \text{전리권 (전기역학)} \rightarrow \text{열권 (중성 역학)}$$

각 구성 요소는 다음 구성 요소에 경계 조건을 전달한다. 전리권-열권 결합은 양방향이다: 전리권은 MHD 모델에 전도도를 제공하고, MHD 모델은 전기장과 입자 강수를 전리권에 제공한다.

SWPC 운영 시스템은 현재 태양풍에 WSA-ENLIL을 사용하고 자기권에 SWMF/BATS-R-US를 사용하며, 결합된 열권-전리권 구성 요소 추가 계획도 있다.

---

## 4. 전리권 모델

### 4.1 IRI(International Reference Ionosphere)

IRI는 COSPAR와 URSI가 유지하는 전리권의 국제 표준 경험적 모델이다. 위치, 시간, 태양/지자기 활동의 함수로서 전리권 파라미터의 월별 중앙값을 제공한다.

**입력:** 지리적 위치, 날짜, 시간, F10.7(또는 흑점 수), 선택적으로 Kp 또는 ap.

**출력:**
- 50~2000 km의 전자 밀도 프로파일 $n_e(h)$
- 전자 및 이온 온도 $T_e(h)$, $T_i(h)$
- 이온 조성 ($\text{O}^+$, $\text{H}^+$, $\text{He}^+$, $\text{N}^+$, $\text{NO}^+$, $\text{O}_2^+$)
- 총 전자 함량(TEC)

**장점:** 수십 년간의 전리권 소나, 비간섭 산란 레이더, 위성 데이터를 기반으로 한다. 기후학적 연구 및 배경 모델로서 탁월하다. 계산적으로 매우 가볍다.

**한계:** 순간 값이 아닌 월별 중앙값을 제공한다. 폭풍 시간 성능이 좋지 않다 — 지자기 폭풍 중 전리권은 중앙값에서 크게 벗어날 수 있다(양성 및 음성 폭풍 단계). IRI-2020은 향상된 폭풍 시간 보정을 포함하지만, 폭풍 반응의 전체 복잡성을 포착하는 것은 경험적 모델의 한계를 벗어난다.

### 4.2 SAMI3(NRL)

SAMI3는 미해군 연구소에서 개발한 물리 기반 3차원 전리권/플라즈마권 모델이다. 이름은 "Sami3 is Also a Model of the Ionosphere"(재귀적 약어)를 뜻한다.

**물리:** SAMI3는 7개 이온 종($\text{H}^+$, $\text{He}^+$, $\text{N}^+$, $\text{O}^+$, $\text{N}_2^+$, $\text{NO}^+$, $\text{O}_2^+$)에 대한 이온 연속, 운동량, 에너지 방정식을 자기력선을 따라 풀어내며, 전하 중성도와 전류 클로저를 통해 결합된다:

$$\frac{\partial n_s}{\partial t} + \nabla \cdot (n_s \mathbf{v}_s) = P_s - L_s n_s$$

$$n_s m_s \frac{D\mathbf{v}_s}{Dt} = n_s q_s(\mathbf{E} + \mathbf{v}_s \times \mathbf{B}) - \nabla p_s + n_s m_s \mathbf{g} + \sum_t n_s m_s \nu_{st}(\mathbf{v}_t - \mathbf{v}_s)$$

중성 대기는 경험적 모델(NRLMSISE-00 또는 TIEGCM 출력)로 지정되고, 전기장은 경험적 대류 모델 또는 결합된 자기권 모델에서 얻는다.

**응용:** 적도 플라즈마 버블, 플라즈마권 배수 플룸, 폭풍 시간 전리권 재분포, GPS 신호 섬광 모델링.

### 4.3 TIEGCM과 WACCM-X

**TIEGCM (Thermosphere-Ionosphere Electrodynamics General Circulation Model):** NCAR에서 개발된 TIEGCM은 상층 대기 모델링의 커뮤니티 표준이다. ~97 km에서 ~600 km 고도를 커버하며 결합된 열권-전리권 시스템을 자기 일관적으로 푼다.

핵심 물리: 태양 EUV 가열, 자기권 대류에 의한 줄 가열, 이온-중성 결합, 중성풍, 조성 변화, 다이나모 전기장.

**WACCM-X (Whole Atmosphere Community Climate Model - eXtended):** 기후 모델 WACCM을 ~500-700 km까지 확장하여 대류권, 성층권, 중간권, 열권-전리권을 단일 프레임워크로 결합한다. 이를 통해 하층 대기 날씨(예: 갑작스러운 성층권 온난화)가 전리권에 미치는 영향을 조사할 수 있다 — 점점 더 주목받는 연구 주제다.

---

## 5. 복사대 모델

### 5.1 포커-플랑크 접근법

복사대 전자들은 방사상 확산, 파동-입자 상호작용에 의한 국소 가속, 대기 및 자기권계면으로의 손실의 영향 아래 진화한다. 지배 방정식은 세 단열 불변량($\mu$, $J$, $L^*$)과 시간의 함수인 위상 공간 밀도 $f$에 대한 포커-플랑크 방정식이다:

$$\frac{\partial f}{\partial t} = L^{*2} \frac{\partial}{\partial L^*}\left(\frac{D_{L^*L^*}}{L^{*2}} \frac{\partial f}{\partial L^*}\right) + \left(\frac{\partial f}{\partial t}\right)_{\text{local}} - \frac{f}{\tau_{\text{loss}}} + S$$

첫 번째 항은 방사상 확산(ULF파에 의해 구동되며, 확산 계수 $D_{L^*L^*}$). 두 번째 항은 코러스(chorus), 히스(hiss), EMIC파에 의한 국소 가속 및 피치각 산란. 세 번째 항은 대기 손실. $S$는 임의의 소스를 나타낸다.

### 5.2 주요 모델

**Salammbo (ONERA, France):** ($\mu$, $J$, $L^*$) 공간에서 완전한 3차원 포커-플랑크 방정식을 푸는 가장 초기의 복사대 모델 중 하나. 방사상 확산, 코러스파 가속, 플라즈마권 히스 손실, EMIC파 손실을 포함한다. 유럽 SPACECAST 시스템에 사용된다.

**VERB-4D (UCLA):** 다목적 전자 복사대(Versatile Electron Radiation Belt) 코드. 현실적인 파동 모델에 대한 준선형 이론으로 계산된 최첨단 확산 계수로 포커-플랑크 방정식을 푼다. "4D"는 세 불변량과 시간을 가리킨다.

**핵심 입력:**
- $D_{L^*L^*}(L^*, \text{Kp})$: 방사상 확산 계수, 종종 Brautigam & Albert(2000)를 따라 매개변수화:

$$D_{L^*L^*} = D_0 \times 10^{(0.506 \text{Kp} - 9.325)} \times L^{*10}$$

- 파동 진폭: AE 또는 Kp로 매개변수화된 코러스, 히스, EMIC파의 전력 스펙트럼 밀도
- 경계 조건: $L^*_{\min}$(안정한 내부 벨트)과 $L^*_{\max}$(GOES로부터)에서의 측정 플럭스

### 5.3 운영 활용

SPACECAST 시스템(EU)은 Salammbo를 기반으로 복사대 현재 상태 분석(nowcast) 및 3시간 예보를 제공한다. NASA의 커뮤니티 통합 모델링 센터(CCMC)는 여러 복사대 모델을 온디맨드로 실행한다.

**도전 과제:**
- 파동 모델은 여전히 고도로 가변적인 현상의 거친 매개변수화에 불과하다
- 플라즈마권 경계(플라즈마 경계층) 위치가 어느 파동이 지배적인지를 결정(내부에서는 히스, 외부에서는 코러스)하여 부정확하게 알려진 양에 민감성이 생긴다
- (자기장을 변형시키는) 고리 전류와 복사대 역학 사이의 결합은 대부분의 모델에서 완전히 포착되지 않는다

---

## 6. 앙상블 모델링과 확률 예보

### 6.1 왜 앙상블인가?

단일 결정론적 예보는 하나의 답을 주지만 신뢰도를 알려주지 않는다. 우주 기상에서 불확실성은 크다:

- **초기 조건 불확실성:** 코로나그래프 이미지에서 측정한 CME 속도는 $\pm 100-200$ km/s의 오차가 있다. CME 방향은 $\pm 10-20°$의 오차가 있다.
- **모델 불확실성:** DBM의 항력 계수는 한 자릿수만큼 변한다. MHD 모델들은 서로 다른 수치 방식과 해상도를 사용한다.
- **경계 조건 불확실성:** 주변 태양풍 상태, 특히 태양의 반대편에서는 불완전하게 파악된다.

### 6.2 앙상블 CME 도착 시간

항력 기반 모델은 밀리초 단위로 실행되기 때문에 앙상블 예보에 이상적이다. 절차:

1. 관측에서 CME 초기 속도 $v_0$와 불확실성 $\sigma_v$를 추정한다.
2. 항력 계수 $\gamma$와 그 불확실성 $\sigma_\gamma$를 추정한다.
3. $(v_0, \gamma, v_{sw})$의 결합 분포에서 $N$개의 표본(예: $N = 1000$)을 추출한다.
4. 각 표본에 대해 DBM을 실행한다.
5. 결과적인 도착 시간의 분포가 확률적 예보를 제공한다:

$$P(\text{arrival between } t_1 \text{ and } t_2) = \frac{\text{number of ensemble members arriving in } [t_1, t_2]}{N}$$

이 접근법은 빠른 CME일수록 도착 시간 분포가 좁고(항력에 덜 민감), 느린 CME일수록 분포가 넓다는 사실을 자연스럽게 포착한다.

### 6.3 확률 예보로의 전환

NOAA/SWPC는 결정론적 예보에서 확률 예보로 전환하고 있다. "화요일에 G2 폭풍이 예상됩니다" 대신 "화요일에 G2 이상 조건이 발생할 확률은 60%입니다"와 같은 예보가 제공된다.

이를 위해서는:
- 앙상블 모델링 인프라
- 보정된 확률 추정(60%로 예보된 사건이 실제로 약 60%의 빈도로 발생)
- 사용자 교육(확률 예보는 더 많은 정보를 제공하지만 해석이 어렵다)

---

## 7. 검증 지표

예보 검증은 모델 기술을 측정하고, 모델을 비교하며, 사용자에게 예보 품질을 전달하는 데 필수적이다. 예보 유형에 따라 적합한 지표가 다르다.

### 7.1 연속형(포인트) 예보

Dst나 태양풍 속도 같은 연속 변수의 예보에 대해:

**평균 제곱근 오차(Root Mean Square Error):**

$$\text{RMSE} = \sqrt{\frac{1}{N}\sum_{i=1}^{N}(F_i - O_i)^2}$$

여기서 $F_i$는 예보, $O_i$는 관측값. RMSE는 작은 오차보다 큰 오차에 더 큰 패널티를 부여한다.

**평균 절대 오차(Mean Absolute Error):**

$$\text{MAE} = \frac{1}{N}\sum_{i=1}^{N}|F_i - O_i|$$

RMSE보다 이상값에 더 강건하다. RMSE $\gg$ MAE이면 예보에 간헐적으로 큰 오차가 있다는 뜻이다.

**상관 계수 $r$:** 선형 연관성을 측정한다. 예보는 높은 $r$을 가질 수 있지만 편향이 클 수도 있다. 항상 RMSE나 MAE와 함께 $r$을 보고한다.

**지속성 기준선(Persistence baseline):** 가장 단순한 예보는 "내일은 오늘과 같다"($F_{t+1} = O_t$)이다. 유용한 모델은 반드시 이 기준을 넘어야 한다.

### 7.2 범주형(예/아니오) 예보

이진 사건 예보(예: "다음 24시간 내에 G3+ 폭풍이 발생하는가?")에 대해 분류표를 만든다:

|  | 사건 관측됨 | 사건 없음 |
|--|---------------|-------------------|
| **사건 예보** | 적중($a$) | 오경보($b$) |
| **사건 없음 예보** | 누락($c$) | 정확한 기각($d$) |

**탐지 확률(Probability of Detection, 적중률):**

$$\text{POD} = \frac{a}{a + c}$$

사건 중 몇 퍼센트가 올바르게 예보되었는가? 항상 "예"로 예보하면 POD = 1 달성 가능 — 따라서 POD만으로는 불충분하다.

**오경보 비율(False Alarm Ratio):**

$$\text{FAR} = \frac{b}{a + b}$$

"예" 예보 중 몇 퍼센트가 틀렸는가?

**진기술 통계(True Skill Statistic, Hanssen-Kuipers / Peirce 기술 점수):**

$$\text{TSS} = \frac{a}{a + c} - \frac{b}{b + d} = \text{POD} - \text{POFD}$$

여기서 POFD는 오탐지 확률($b/(b+d)$). TSS는 $-1$에서 $+1$까지의 범위를 가지며, 0은 기술 없음을 나타낸다. TSS는 등가(이벤트 대 비이벤트의 상대 빈도에 영향받지 않음)하여 희귀 사건에 탁월하다.

**하이드케 기술 점수(Heidke Skill Score):**

$$\text{HSS} = \frac{2(ad - bc)}{(a+c)(c+d) + (a+b)(b+d)}$$

무작위 예보에 대한 개선도를 측정한다. HSS = 0은 무작위, HSS = 1은 완벽.

### 7.3 확률 예보

**브라이어 점수(Brier Score):**

$$\text{BS} = \frac{1}{N}\sum_{i=1}^{N}(p_i - o_i)^2$$

여기서 $p_i$는 예보 확률, $o_i \in \{0, 1\}$은 관측 결과. BS = 0이 완벽, BS = 1이 최악. 확률에 대한 MSE로 생각하면 된다.

**브라이어 기술 점수(Brier Skill Score):**

$$\text{BSS} = 1 - \frac{\text{BS}}{\text{BS}_{\text{ref}}}$$

여기서 $\text{BS}_{\text{ref}}$는 기준 예보(보통 기후학)의 브라이어 점수. BSS > 0은 기준보다 높은 기술을 나타낸다.

**신뢰성 다이어그램(Reliability diagram):** 구간별로 예보 확률 대 관측 빈도를 플롯한다. 완벽하게 신뢰할 수 있는 예보는 대각선 위에 놓인다. 대각선 위는 과소 예보(예측보다 사건이 더 자주 발생), 아래는 과대 예보를 나타낸다.

**ROC(수신기 동작 특성) 곡선:** 다양한 확률 임계값에서 POD 대 POFD를 플롯한다. ROC 곡선 아래 면적(AUC)은 전체 판별 능력을 측정한다. AUC = 0.5는 기술 없음(무작위), AUC = 1.0은 완벽.

### 7.4 지표 선택

단일 지표로 전체 이야기를 할 수 없다. 모범 사례:
- 여러 지표를 보고한다
- 항상 기준(지속성, 기후학)과 비교한다
- 희귀 사건의 경우 정확도(정확한 기각에 의해 지배됨) 대신 TSS를 선호한다
- 확률 예보의 경우 신뢰성(보정)과 해상도(선명도)를 모두 보고한다

---

## 8. 운영 예보 워크플로

### 8.1 주의보-경보-긴급 경보 시스템

우주 기상 예보는 지상 기상과 유사한 단계적 긴급성 시스템을 따른다:

**주의보(Watch)** (수 일 전 발령): 우주 기상 위험이 높아졌음을 시사하는 조건에서 발령. 예시:
- 복잡한 활성 영역(베타-감마-델타 자기 분류)이 태양 원판으로 회전할 때
- 지구 방향의 CME가 관측될 때
- 27일 반복 패턴을 기반으로 반복적인 고속 스트림이 예상될 때

**경보(Warning)** (수 시간 전 발령): 사건이 진행 중이거나 임박했을 때 발령:
- CME가 지구 방향으로 확인됨; ENLIL 모델이 24-48시간 내 도착을 예측
- L1에서 태양풍 증가가 관측됨(DSCOVR), 지구 도착까지 15-60분
- 태양 양성자 사건 진행 중

**긴급 경보(Alert)** (즉각): 임계값 초과:
- Kp가 5+ 도달(G1+ 폭풍 진행 중)
- 양성자 플럭스가 10 pfu 초과(S1+ 복사 폭풍)
- X선 플럭스가 M1 초과(R1+ 전파 두절)

### 8.2 인간 예보관

수치 모델링의 발전에도 불구하고 인간 예보관은 우주 기상에서 여전히 필수적이다. 그들은:

1. **여러 데이터 스트림 종합:** 위성 이미지, 모델 출력, 지상 관측, 실시간 태양풍 데이터.
2. **전문가적 판단 적용:** 모델들은 종종 의견이 다르다. 예보관은 특정 상황에 맞는 각 모델의 알려진 강점과 약점을 고려한다.
3. **불확실성 평가:** "모델이 G3를 예측하지만 입력 데이터가 불확실하므로 G3 가능성에 대한 메모와 함께 G2를 예보한다."
4. **소통:** 기술적 출력을 운영자(전력망, 항공사, 위성 운영자)를 위한 실행 가능한 정보로 번역한다.

### 8.3 실제 예보 검증

SWPC는 예보 기술을 문서화하는 분기별 및 연간 검증 보고서를 발행한다. 주요 결과는 일관되게 보여준다:

- **플레어 예보:** 보통의 기술. M급 플레어의 범주형 예보는 TSS ~0.3-0.5 달성. 한계는 복잡한 활성 영역이 정확히 언제 폭발할지 예측하는 우리의 무능력이다.
- **CME 도착 시간:** ENLIL로 $\pm 10-15$시간, 때로는 더 나쁨. CME 내부의 자기장(특히 $B_z$)은 대체로 예측 불가능하다.
- **지자기 폭풍 강도:** L1에서 태양풍 데이터가 확보되면 1시간 Dst 예보가 좋음(상관 > 0.9). 더 긴 예보 리드 타임은 빠르게 성능이 저하된다.
- **복사 폭풍(SEP):** 발생은 종종 플레어 후 30-60분 내에 식별할 수 있지만, 최대 플럭스와 지속 시간은 어렵다.

---

## 연습 문제

**문제 1.** 동기 자기도에서 플럭스 팽창 인자 $f_s = 3.5$, 발자국에서 가장 가까운 코로나 구멍 경계까지의 거리 $\theta_b = 15°$인 대규모 코로나 구멍이 나타난다. WSA 경험적 관계식($v_{\text{fast}} = 625$ km/s, $v_{\text{range}} = 240$ km/s, $\alpha = 4.5$, $\theta_0 = 2.8°$, $\beta = 1.25$)을 사용하여 소스 표면에서의 태양풍 속도를 추정하라. 이것이 빠른 바람인지 느린 바람인지, 그리고 지구에서 어떤 구조와 관련될지 논의하라.

**문제 2.** CME의 초기 속도가 $v_0 = 1200$ km/s로 관측되었다. 주변 태양풍 속도는 $v_{sw} = 400$ km/s이다. $\gamma = 0.5 \times 10^{-7}$ km$^{-1}$인 항력 기반 모델을 사용하여 1 AU에서의 CME 속도와 통과 시간을 추정하라. 힌트: DBM의 해석적 해는 $v(t) = v_{sw} + (v_0 - v_{sw}) / [1 + \gamma |v_0 - v_{sw}| t]$와 $R(t) = v_{sw}t + \ln(1 + \gamma |v_0 - v_{sw}| t) / \gamma$이다.

**문제 3.** 우주 기상 모델이 1년 동안 G3+ 폭풍 예보에 대해 다음 분류표를 생성했다: 적중 = 12, 오경보 = 8, 누락 = 5, 정확한 기각 = 340. POD, FAR, TSS, HSS, 전체 정확도를 계산하라. 이 문제에서 정확도가 오해를 불러일으키는 지표인 이유와 TSS가 선호되는 이유를 설명하라.

**문제 4.** 확률적 CME 도착 예보가 12시간 창 안에 도착 확률 70%를 제공한다. 70% 수준의 50건의 예보 중 CME가 지정된 창 안에 실제로 42번 도착했다. 이 예보는 신뢰할 수 있는가? 이 단일 확률 구간에 대한 브라이어 점수를 계산하고 신뢰성 다이어그램에 해당 점을 플롯하라.

**문제 5.** 중간 폭풍(Dst = $-80$ nT, $P_{\text{dyn}} = 5$ nPa, $B_z = -8$ nT) 동안 정지 궤도(6.6 $R_E$)에서의 자기장을 알아야 하는 위성 운영자의 경우, 차가넨코 T96 모델과 SWMF/BATS-R-US를 비교하라. 각 모델의 예상 정확도, 계산 시간, 적절성을 논의하라. 어느 것을 추천하겠으며 그 이유는 무엇인가?

---

**이전**: [우주 기상 지수](./13_Space_Weather_Indices.md) | **다음**: [우주 기상을 위한 AI/ML](./15_AI_ML_for_Space_Weather.md)
