# 11. 태양 MHD

## 학습 목표

이 강의를 마치면 다음을 할 수 있어야 합니다:

- 태양 구조와 각 층에서 자기장의 역할 설명
- 자기 플럭스 튜브와 흑점의 물리학 이해
- 태양 다이나모 메커니즘과 11/22년 태양 주기 설명
- 코로나 가열 문제 및 제안된 해결책 분석
- Parker의 태양풍 모델 유도 및 적용
- 태양풍 난류 특성화 및 그 성질 파악
- 태양 현상의 수치 모델 구현 (Parker 태양풍, 플럭스 튜브, 나비 다이어그램)

## 1. 태양 구조 및 자기장

### 1.1 태양의 층

태양은 밀도, 온도, 자기장 강도에서 여러 차수의 크기를 걸쳐 층화된 복잡한 플라즈마 시스템입니다.

**내부:**

1. **핵(Core)** (r < 0.25 R☉):
   - 온도: `T ~ 1.5 × 10⁷ K`
   - 밀도: `ρ ~ 150 g/cm³`
   - 핵융합: `4 ¹H → ⁴He + 에너지`
   - 에너지 수송: 복사 (광자 확산)

2. **복사층(Radiative zone)** (0.25 R☉ < r < 0.7 R☉):
   - 온도: `T ~ 10⁷ - 10⁶ K`
   - 복사 확산이 지배적
   - 안정적 층화 (대류 없음)
   - 차등 회전 확립

3. **타코클라인(Tachocline)** (r ~ 0.7 R☉):
   - 얇은 전단층 (~0.05 R☉)
   - 복사층(강체 회전)에서 대류층(차등 회전)으로의 전이
   - 강한 **Ω-효과** 발생 위치 (toroidal 장 생성)
   - 태양 다이나모에 중요

4. **대류층(Convection zone)** (0.7 R☉ < r < 1.0 R☉):
   - 온도: `T ~ 10⁶ - 6000 K`
   - 밀도: `ρ ~ 1 - 10⁻⁷ g/cm³`
   - 대류 에너지 수송 (세포, 초세포)
   - **α-효과** 발생원 (나선형 난류)
   - 차등 회전: 적도가 극보다 빠름

**대기:**

5. **광구(Photosphere)** (표면, r ~ R☉):
   - 온도: `T ~ 5800 K` (가시 표면)
   - 밀도: `ρ ~ 10⁻⁷ g/cm³`
   - 광학 깊이 `τ ~ 1`
   - 흑점, 백반, 세포 가시

6. **채층(Chromosphere)** (R☉ < r < R☉ + 2000 km):
   - 온도: `T ~ 6000 - 20000 K` (고도 증가)
   - 밀도: `ρ ~ 10⁻⁹ - 10⁻¹¹ g/cm³`
   - 방출선 (Hα, Ca II K)
   - 스피큘, 플라주

7. **전이 영역(Transition region)** (r ~ R☉ + 2000 km):
   - 급격한 온도 증가: `T ~ 10⁴ → 10⁶ K` ~100 km 이상
   - 밀도 급격히 감소

8. **코로나(Corona)** (r > R☉ + 2000 km):
   - 온도: `T ~ 1-3 × 10⁶ K` (신비롭게 뜨거움!)
   - 밀도: `ρ ~ 10⁻¹² - 10⁻¹⁶ g/cm³`
   - 고도로 이온화 (Fe XIV 등)
   - 닫힌 자기 루프와 열린 장선
   - 태양풍 발생원

**자기장:**

- **내부 (대류층):** `B ~ 10-100 G` (난류 다이나모)
- **타코클라인:** `B ~ 10⁴ G` (강한 toroidal 장)
- **광구 (조용한 태양):** `B ~ 1-10 G`
- **광구 (흑점):** `B ~ 3000 G` (0.3 T!)
- **코로나:** `B ~ 1-10 G` (큰 규모로 확장)

### 1.2 관측 기법

**자기 사진술(Magnetography):**

- **제만 효과(Zeeman effect):** 자기장에서 스펙트럼선 분리
  - 선 분리: `Δλ ∝ B` (종방향 성분)
  - 원형 편광 (Stokes V): 종방향 장
  - 선형 편광 (Stokes Q, U): 횡방향 장

- **기기:**
  - **SOHO (Solar and Heliospheric Observatory):** MDI (Michelson Doppler Imager)
  - **SDO (Solar Dynamics Observatory):** HMI (Helioseismic and Magnetic Imager)
    - 45초마다 전체 원반 자기 사진
    - 벡터 자기장 지도
  - **Hinode:** SOT (Solar Optical Telescope) — 고해상도
  - **Daniel K. Inouye Solar Telescope (DKIST):** 4m 구경, 최고 해상도

**태양 지진학(Helioseismology):**

- 태양 진동 연구 (5분 진동, p-모드, g-모드)
- 내부 구조 추론: 회전 프로파일, 음속, 자기장 (간접적)
- **주요 결과:** 차등 회전 프로파일을 통한 타코클라인 발견

**코로나그래프 및 EUV 영상:**

- SOHO/LASCO: 백색광 코로나그래프 (코로나 물질 방출)
- SDO/AIA: 다중 파장에서 극자외선 영상 (다른 온도)
- Hinode/XRT: X선 영상 (뜨거운 코로나 루프)

## 2. 자기 플럭스 튜브 및 흑점

### 2.1 얇은 플럭스 튜브 근사

**자기 플럭스 튜브(Magnetic flux tube)**는 자기장선의 다발로, 종종 장이 없는 플라즈마에 묻혀 있는 가는 튜브로 근사됩니다.

**가정:**

1. 튜브 반경 `a ≪ L` (변화의 길이 척도)
2. 내부 장 `B_i`는 축 방향, 외부 장 `B_e = 0` (또는 약함)
3. 튜브 경계에서 압력 균형

**압력 균형:**

튜브 내부와 외부에서 총 압력이 균형을 이루어야 합니다:

```
p_i + B_i² / (2μ₀) = p_e
```

`B_e = 0`이면:

```
p_i = p_e - B_i² / (2μ₀)
```

`p_i < p_e`이므로, 내부 기체는 **더 차갑거나 밀도가 낮습니다** (이상 기체의 경우, `p = ρkT/m`).

**부력(Buoyancy):**

튜브가 층화된 대기에서 정수압 평형 상태인 경우:

```
dp/dz = -ρg
```

외부 매질의 경우:

```
dp_e/dz = -ρ_e g
```

튜브의 경우:

```
dp_i/dz = -ρ_i g
```

빼면:

```
d/dz(p_i - p_e) = -(ρ_i - ρ_e)g
```

`p_i - p_e = -B_i²/(2μ₀)`로:

```
-d/dz(B_i²/(2μ₀)) = -(ρ_i - ρ_e)g
```

`ρ_i < ρ_e`이면 (튜브가 덜 조밀함), 튜브는 **부력**을 경험합니다:

```
F_buoy = (ρ_e - ρ_i) g V
```

이것이 **자기 부력 불안정성(Magnetic buoyancy instability)**을 구동하여 플럭스 튜브가 대류층을 통해 상승합니다.

### 2.2 자기 부력 및 플럭스 출현

**자기 부력 불안정성:**

층화된 층의 수평 자기 플럭스 튜브는 다음과 같은 경우 기복에 불안정합니다:

```
B² / (2μ₀ρ) > c_s² H_p / γ
```

여기서:
- `c_s` = 음속
- `H_p = p/(ρg)` = 압력 스케일 높이
- `γ` = 단열 지수

대류층의 강한 장의 경우, 이 조건이 만족됩니다 → 플럭스 튜브 상승.

**상승 역학:**

플럭스 튜브의 상승 속도는 부력과 저항의 균형을 이룹니다:

```
ρ_e (dv_z/dt) = (ρ_e - ρ_i) g - C_D (1/2) ρ_e v_z²
```

여기서 `C_D`는 저항 계수입니다.

대류층에서:
- 시간 척도: `τ_rise ~ H_p / v_z ~ 몇 개월`
- 타코클라인에서 생성된 `B ~ 10⁴ G`를 가진 튜브가 표면으로 상승

**광구에서의 출현:**

광구에 도달하면, 플럭스 튜브는 **양극 활동 영역**으로 출현합니다:
- 선행 흑점 (한 극성)
- 후행 흑점 (반대 극성)
- 표면 위의 자기 루프로 연결됨

### 2.3 흑점

**구조:**

- **본영(Umbra):** 어두운 중앙 영역
  - 온도: `T ~ 4000 K` (조용한 태양의 5800 K에 비해)
  - 자기장: `B ~ 3000 G`, 거의 수직
  - 어두움은 억제된 대류 때문 (자기 압력이 운동을 억제)

- **반영(Penumbra):** 방사상 필라멘트가 있는 주변 영역
  - 온도: `T ~ 5000 K`
  - 자기장: `B ~ 1500 G`, 기울어짐
  - **에버셰드 흐름(Evershed flow):** `v ~ 1-2 km/s`의 방사상 유출 (기울어진 장을 따라)

**흑점 주기:**

- 흑점 수는 ~11년 주기로 변화
- 태양 활동과 상관 (플레어, CME)
- 각 주기마다 자기 극성이 반전 → 22년 자기 주기

**헤일의 극성 법칙(Hale's polarity law):**

주어진 주기에서:
- 북반구 선행 흑점: 한 극성
- 남반구 선행 흑점: 반대 극성
- 다음 주기에서 반전

**조이의 법칙(Joy's law):**

양극 활동 영역은 기울어져 있습니다:
- 선행 흑점이 적도에 더 가까움
- 후행 흑점이 극을 향함
- 기울기 각도는 위도에 따라 증가

이 기울기는 **Babcock-Leighton 메커니즘**에 중요합니다 (다이나모 섹션 참조).

## 3. 태양 다이나모

### 3.1 관측 제약 조건

태양 다이나모는 다음을 설명해야 합니다:

1. **11년 흑점 주기** (22년 자기 주기)
2. **나비 다이어그램(Butterfly diagram):** 흑점은 주기 시작 시 중위도(~30°)에 나타나 적도로 이동
3. **헤일의 법칙:** 11년마다 극성 반전
4. **극 장 반전:** 극 장은 ~11년에 반전, 적도와 동상
5. **차등 회전:** 태양 지진학으로부터의 Ω(위도, 반경)
6. **타코클라인:** 대류층 기저에서 강한 반경 전단 `∂Ω/∂r`

### 3.2 차등 회전 프로파일

태양 지진학(예: GONG, SOHO/MDI, SDO/HMI)으로부터:

**표면 (광구):**

```
Ω(θ) ≈ Ω_eq (1 - a₂ cos²θ - a₄ cos⁴θ)
```

여기서:
- `Ω_eq ≈ 2π / 25일` (적도 회전)
- `a₂ ≈ 0.14`, `a₄ ≈ 0.17`
- 극은 적도보다 ~30% 느리게 회전

**내부:**

- **복사층 (r < 0.7 R☉):** 거의 **강체 회전** Ω ~ 상수
- **대류층:** 위도 의존적 회전, 반경선에서 대략 일정 (원통형 회전)
- **타코클라인 (r ~ 0.7 R☉):** 급격한 전이
  - 강한 **반경 전단** `∂Ω/∂r`
  - toroidal 장이 증폭되는 곳 (Ω-효과)

### 3.3 α-Ω 다이나모 메커니즘

고전적인 **α-Ω 다이나모**는 두 단계로 작동합니다:

**1. Ω-효과 (Toroidal 장 생성):**

차등 회전이 poloidal 장 `B_p`를 toroidal 장 `B_φ`로 전단합니다:

```
∂B_φ/∂t ≈ r sin θ (B_r ∂Ω/∂r + B_θ / r ∂Ω/∂θ)
```

타코클라인에서 `∂Ω/∂r`이 큼 → 강한 증폭:

```
B_φ ~ B_p × (Ω_cycle × τ_cycle) ~ B_p × (10⁻⁶ rad/s × 10⁸ s) ~ 100 B_p
```

`B_p ~ 10 G`에서 시작하여 `B_φ ~ 10³-10⁴ G`를 생성합니다.

**2. α-효과 (Poloidal 장 재생성):**

대류층의 나선형 대류 난류가 toroidal → poloidal로 변환합니다:

```
∂B_p/∂t ≈ ∇ × (α B_φ e_φ)
```

α의 소스:
- **사이클론 대류:** 상승/하강 플룸에 작용하는 코리올리 힘 → 나선형 운동
- **운동 나선성(Kinetic helicity):** 회전하고 층화된 유체에서 `⟨u·(∇×u)⟩ ≠ 0`

**피드백 루프:**

```
B_p → (Ω-효과) → B_φ → (α-효과) → B_p'
```

주기당 증폭이 확산을 초과하면 장이 성장합니다.

### 3.4 Babcock-Leighton 메커니즘

난류 α-효과의 대안:

**메커니즘:**

1. 타코클라인의 강한 toroidal 장 `B_φ`가 부력 불안정해짐
2. 플럭스 튜브가 상승하여 **기울어진 양극 활동 영역**으로 출현 (조이의 법칙)
3. 표면에서 후행 흑점 (극방향)이 선행 흑점과 반대 극성을 가짐
4. 표면 흐름 (자오선 순환, 확산)이 플럭스 수송:
   - 후행 극성 플럭스의 극방향 이동 → 극 장 소멸 및 반전
   - 이것이 toroidal로부터 poloidal 장을 재생성하는 것과 동등

**Poloidal 장 소스:**

```
소스 ∝ B_φ × sin(기울기 각도) × (표면 플럭스 수송)
```

이것은 벌크가 아닌 표면에서 작동하는 **비국소적 α-효과**입니다.

**장점:**

- 직접 관측 가능 (기울기, 출현)
- 극 장 반전 설명
- 플럭스 수송 다이나모 모델이 나비 다이어그램을 잘 재현

### 3.5 플럭스 수송 다이나모

현대 태양 다이나모 모델은 다음을 결합합니다:

- **Ω-효과** 타코클라인에서
- **Babcock-Leighton α-효과** 표면에서
- **자오선 순환(Meridional circulation):** 표면에서 극방향, 기저에서 적도방향 (컨베이어 벨트)
  - 속도: `v_m ~ 10-20 m/s`
  - 주기: `τ_m ~ R☉ / v_m ~ 10년` (주기와 비슷!)
- **난류 확산:** 대류층에서, `η_t ~ 10^{10-11} cm²/s`

**주기:**

1. Toroidal 장 `B_φ`가 타코클라인에서 축적 (Ω-효과)
2. 플럭스 출현 → 중위도의 기울어진 활동 영역
3. 표면 확산 + 자오선 흐름 → 극방향 플럭스 이동, 극 장 반전
4. 자오선 흐름이 극에서 표면 poloidal 장을 아래로 이송
5. 타코클라인에서 poloidal 장이 Ω에 의해 전단됨 → 새로운 toroidal 장 (반대 부호)
6. 주기 반복

**주기:**

```
P ~ 2π √(D/α_eff Ω_eff)  또는  P ~ 순환 시간
```

매개변수 조정 (확산도, 순환 속도)으로 11년 주기를 재현합니다.

### 3.6 다이나모 포화 및 자기 활동

**포화:**

- 자기장이 무한정 성장할 수 없음
- **자기 부력:** `B_φ ~ 10⁴ G`일 때, 튜브가 부력을 가짐 → 상승 및 출현 → 타코클라인에서 플럭스 제거
- **로렌츠 힘:** 강한 장이 흐름을 변경 (전단, α-효과 감소)

**주기적 행동:**

포화는 정상 다이나모보다는 **진동 해**로 이어집니다:
- Poloidal 및 toroidal 장이 위상차로 진동
- 나비 다이어그램: 다이나모 파동 전파 또는 플럭스 수송으로 인한 적도방향 이동

**그랜드 미니마(Grand minima) (마운더 극소기):**

- 매우 낮은 흑점 활동의 역사적 기간 (예: 1645-1715)
- 가능한 원인:
  - α-효과의 확률적 변동
  - 자오선 순환의 변화
  - 다이나모 모드 간 전이

확률적 강제가 있는 모델은 불규칙한 주기와 그랜드 미니마를 재현할 수 있습니다.

## 4. 코로나 가열 문제

### 4.1 문제

**관측:**

- 광구: `T ~ 5800 K`
- 채층: `T ~ 10⁴ K`
- 코로나: `T ~ 10⁶ K`

이것은 **순진한 기대를 위배합니다** (온도는 열원으로부터의 거리에 따라 감소해야 함).

**에너지 수지:**

복사 및 전도 손실에 대해 코로나 온도를 유지하려면:

```
에너지 입력 ≈ 10² - 10³ W/m² (활동 영역에서)
             ≈ 10-100 W/m² (조용한 태양)
```

총 코로나 가열 전력: `L_corona ~ 10²⁷ erg/s ~ 10²⁰ W` (태양 광도 `L_☉ ~ 4×10²⁶ W`와 비교, 코로나는 `~0.01% L_☉`).

**가능한 에너지 소스:**

- 광구 운동 (대류, 세포): `~ kW/m²` (충분한 에너지!)
- 질문: 이 에너지가 **코로나로 수송**되고 열로 **소산**되는 방법은?

### 4.2 파동 가열 메커니즘

**음파:**

- 대류 운동이 음파를 생성
- 파동이 위로 전파, 충격파로 급해짐 (밀도 감소로 인해)
- 충격 소산 → 가열

**문제:** 음파는 대부분 급격한 온도 기울기(채층/전이 영역)에서 **반사**됨 → 코로나에 도달하는 플럭스 불충분.

**알벤 파동(Alfvén waves):**

자기장선은 **알벤 파동**을 지지할 수 있는 현과 같습니다:

```
v_A = B / √(μ₀ ρ)
```

코로나에서 `B ~ 10 G`, `ρ ~ 10^{-12} g/cm³` → `v_A ~ 1000 km/s`.

**파동 생성:**

- 광구 운동 (세포)이 자기장선을 흔듦
- 알벤 파동 여기 (횡방향 진동)
- 파동이 장선을 따라 코로나로 전파

**소산 메커니즘:**

1. **위상 혼합(Phase mixing):**
   - 다른 장선들이 다른 `v_A`를 가짐 → 인접한 선의 파동이 위상이 어긋남
   - 횡방향 기울기 생성 → 점성/저항 소산

2. **공명 흡수(Resonant absorption):**
   - 층화된 코로나에서 국소 알벤 주파수가 변화
   - 파동이 국소화된 진동에 공명적으로 결합 → 향상된 소산

3. **난류 캐스케이드(Turbulent cascade):**
   - 비선형 상호작용 → 에너지가 작은 척도로 캐스케이드
   - 작은 척도에서 저항 또는 점성을 통해 소산

**에너지 플럭스:**

알벤 파동 에너지 플럭스:

```
F_A = (1/2) ρ v_A δv²
```

여기서 `δv`는 파동 진폭입니다. `δv ~ 10 km/s`, `ρ ~ 10^{-7} g/cm³` (채층), `v_A ~ 100 km/s`의 경우:

```
F_A ~ 10³ W/m²  (코로나 가열에 충분!)
```

**관측 지원:**

- 코로나에서 알벤 변동 관측 (CoMP 기기, Parker Solar Probe)
- 코로나 루프를 따라 전파하는 파동 관찰
- 가열 요구사항과 일치하는 감쇠 시간 척도

### 4.3 자기 재결합 및 나노플레어

**Parker의 나노플레어 가설 (1988):**

- 광구 운동이 코로나 자기장을 지속적으로 얽음
- 소규모 **전류 시트** 형성
- 이러한 시트에서 자기 재결합이 버스트로 에너지 방출 (**나노플레어**)
- 많은 작은 사건 (각 `E ~ 10²⁴ erg`, 대형 플레어의 `10^{32}` erg에 비해) → 통계적 가열

**에너지 방출:**

재결합은 자기 에너지를 운동 및 열 에너지로 변환합니다:

```
에너지 ~ B² / (2μ₀) × 부피
```

크기 `L ~ 100 km`, `B ~ 10 G`의 전류 시트의 경우:

```
E ~ (10⁻³ T)² / (2×4π×10⁻⁷) × (10⁵ m)³ ~ 10²⁴ erg  (나노플레어)
```

**빈도:**

코로나에 `10²⁰ W`를 공급하려면:

```
N × E / τ ~ 10²⁰ W
N ~ 10²⁰ W × τ / 10²⁴ erg ~ 10⁶ 사건/s  (τ ~ 100 s인 경우)
```

**과제:**

- 개별 나노플레어는 검출 임계값 이하
- **통계적 신호**를 관측해야 함 (예: 비열 방출, 가열률 분포)

**관측 증거:**

- EUV 밝기가 나노플레어 통계와 일치
- 활동 영역의 고온 (> 3 MK) 플라즈마는 충동적 가열을 시사
- 그러나 개별 나노플레어의 직접 관측은 여전히 어려움

### 4.4 현재 이해

두 메커니즘 모두 **기여**할 가능성이 높습니다:

- **파동 가열:** 조용한 태양, 열린 장 영역 (코로나 홀)에서
  - 알벤 파동이 바깥쪽으로 전파, 소산
  - 느리고 빠른 태양풍 가속과 관련

- **재결합/나노플레어:** 활동 영역, 닫힌 루프에서
  - 복잡한 자기 구조에서 꼬임 및 재결합
  - 고온 방출 설명

**진행 중인 연구:**

- 고해상도 관측 (DKIST, Solar Orbiter, Parker Solar Probe)
- 현실적인 코로나 자기장의 MHD 시뮬레이션
- 파동 전파 및 소산 모델링
- 소규모 재결합 사건의 통계

## 5. 태양풍

### 5.1 Parker의 태양풍 모델 (1958)

Eugene Parker는 코로나가 **정수압 평형**에 있지 않고 대신 성간 공간으로 초음속 팽창한다고 제안했습니다.

**가정:**

1. **정상, 구대칭, 반경 흐름**
2. **등온 코로나:** `T = T_c = 상수` (단순화)
3. **이상 기체:** `p = ρkT/m`
4. **에너지 방정식:** 가열/냉각 무시 (또는 균형 가정)

**방정식:**

**질량 보존:**

```
d/dr (ρ v r²) = 0  →  ρ v r² = 상수 = Ṁ/(4π)
```

여기서 `Ṁ`는 질량 손실률입니다.

**운동량 방정식:**

```
ρ v dv/dr = -dp/dr - GMρ/r²
```

**이상 기체:**

```
p = ρ c_s²
```

여기서 `c_s² = kT/m`는 음속 제곱입니다.

**결합:**

`ρ = Ṁ/(4πr²v)` 및 `p = (Ṁ/(4πr²v)) c_s²`를 대입:

```
v dv/dr = -c_s² (1/v dv/dr + 2/r) - GM/r²
```

재정리:

```
(v² - c_s²) (1/v dv/dr) = -(2c_s²/r + GM/r²)
```

**임계점:**

`r = r_c`에서 `v = c_s` (음속점), 우변이 사라져야 합니다:

```
2c_s²/r_c + GM/r_c² = 0  →  r_c = GM/(2c_s²)
```

`T_c = 10⁶ K`인 태양의 경우, `c_s ~ 100 km/s`:

```
r_c ~ (6.67×10⁻¹¹ × 2×10³⁰) / (2 × (10⁵)²) ~ 7×10⁹ m ~ 10 R☉
```

**해:**

**천이음속 해**는 임계점을 통과합니다:
- `r < r_c`에서 **아음속** (태양 근처)
- `r = r_c`에서 **음속**
- `r > r_c`에서 **초음속** (성간 공간)

지구 궤도 (1 AU ~ 215 R☉)에서:
- 속도: `v ~ 400 km/s`
- 밀도: `n ~ 5 cm⁻³`
- 온도: `T ~ 10⁵ K`

이것들은 관측과 일치 → Parker의 모델 확인!

### 5.2 비등온 모델

**등온 모델의 문제:**

에너지 보존이 만족되지 않음 (`T = 상수`를 유지하려면 지속적인 가열 필요).

**다변 모델(Polytropic model):**

`p ∝ ρ^γ` 가정:

```
p = K ρ^γ
```

여기서 `γ`는 다변 지수입니다 (γ=1 등온, γ=5/3 단열).

`γ < 3/2`의 경우, 천이음속 해가 존재합니다.

**에너지 방정식:**

더 현실적인 모델은 다음을 포함합니다:
- **열 전도:** `q = -κ dT/dr`
- **복사 냉각**
- **코로나 가열** (임의 함수 또는 파동 소산)
- **중력 일**

전체 에너지 방정식:

```
d/dr (r² ρ v [v²/2 + γ/(γ-1) p/ρ - GM/r]) = r² (Q_heat - Q_cool + Q_cond)
```

수치 해는 다음을 찾습니다:
- `r ~ 1-2 R☉` 근처 온도 피크, 그 다음 감소
- 종단 속도는 코로나 온도 및 가열 프로파일에 의존

### 5.3 빠른 태양풍과 느린 태양풍

**관측 (Ulysses, Helios, Wind, ACE, Parker Solar Probe):**

두 가지 유형의 태양풍:

**느린 태양풍:**
- 속도: `v ~ 300-400 km/s`
- 밀도: 1 AU에서 `n ~ 10 cm⁻³`
- 온도: `T ~ 10⁵ K`
- 조성: 광구와 유사하지만 낮은 FIP 원소가 풍부
- 소스: 태양 적도 근처 **스트리머 벨트** (닫힌 장 영역)

**빠른 태양풍:**
- 속도: `v ~ 700-800 km/s`
- 밀도: 1 AU에서 `n ~ 3 cm⁻³`
- 온도: `T ~ 2×10⁵ K`
- 조성: 광구에 더 가까움
- 소스: **코로나 홀** (극의 열린 장 영역)

**가속 메커니즘:**

- **느린 바람:** 스트리머 상단의 재결합, 또는 복잡한 장의 파동에서 가능
- **빠른 바람:** 알벤 파동 압력 (파동 에너지 밀도가 유효 압력으로 작용)

**알벤 파동 구동 모델:**

파동 압력 기울기가 바람을 가속합니다:

```
F_wave ~ -d/dr (B δB / μ₀)
```

여기서 `δB`는 파동 진폭입니다. 이것은 관측된 속도로 빠른 바람을 구동할 수 있습니다.

### 5.4 태양풍 난류

**관측:**

- 자기장 및 속도 변동이 매우 난류적
- 전력 스펙트럼: MHD 척도에서 `E(f) ∝ f^{-5/3}` (콜모고로프 유사)
- 운동 척도 (이온 자이로 반경, 관성 길이)에서 급해짐

**특성:**

- **알벤 상관관계:** `δv ~ ±δB/√(μ₀ρ)` (바깥쪽/안쪽 전파 알벤 파동)
- **비등방성:** 변동이 평균 장에 수직으로 우선적
- **간헐성:** 비가우스 통계, 일관된 구조 (전류 시트, 플럭스 로프)

**에너지 캐스케이드:**

- 큰 척도에서 주입 (1 AU에서 > 10⁶ km)
- 관성 범위: `E(k) ∝ k^{-5/3}` (또는 `k^{-3/2}` Iroshnikov-Kraichnan)
- `k ρ_i ~ 1` (이온 자이로 척도) 또는 `k λ_i ~ 1` (이온 관성 길이)에서 소산

**가열:**

난류 소산이 태양풍을 가열합니다:
- 양성자 온도가 단열보다 느리게 감소 (`T ∝ r^{-α}`, `α ~ 0.5` 대 단열 `α ~ 4/3`)
- 수직 이온 가열 (온도 비등방성)
- 작은 척도에서 전자 가열

**시사점:**

- 태양풍은 무충돌 플라즈마 난류의 자연 실험실
- 천체물리 플라즈마와 관련 (ISM, 은하단, 강착 흐름)

## 6. Python 구현

### 6.1 Parker 태양풍 해

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint
from scipy.optimize import fsolve

def parker_solar_wind():
    """
    Parker의 등온 태양풍 모델을 풉니다.

    방정식:
      질량: ρ v r² = 상수
      운동량: v dv/dr = -c_s²/ρ dρ/dr - GM/r²

    결합:
      (v² - c_s²) (1/v dv/dr) = -(2c_s²/r + GM/r²)
    """
    # 상수
    G = 6.674e-11      # m^3 kg^-1 s^-2
    M_sun = 1.989e30   # kg
    R_sun = 6.96e8     # m
    k_B = 1.38e-23     # J/K
    m_p = 1.67e-27     # kg (양성자 질량)

    # 코로나 온도
    T_corona = 1.5e6   # K
    c_s = np.sqrt(k_B * T_corona / m_p)  # 음속

    # 임계 반경
    r_c = G * M_sun / (2 * c_s**2)

    print(f"음속: {c_s/1e3:.1f} km/s")
    print(f"임계 반경: {r_c/R_sun:.2f} R_sun")

    # 반경 격자
    r = np.logspace(np.log10(R_sun), np.log10(215*R_sun), 1000)  # 1 R_sun에서 1 AU

    # ODE 정의: dv/dr
    def dv_dr(v, r):
        numerator = -(2*c_s**2 / r + G*M_sun / r**2)
        denominator = (v**2 - c_s**2) / v
        if abs(denominator) < 1e-10:
            return 0  # 임계점 근처
        return numerator / denominator

    # 임계점 해 찾기
    # r_c를 약간 지나서 약간 초음속으로 시작
    r_start_idx = np.argmin(np.abs(r - r_c * 1.01))
    r_start = r[r_start_idx]
    v_start = c_s * 1.01

    # r_c에서 바깥쪽으로 적분
    r_out = r[r_start_idx:]
    v_out = odeint(dv_dr, v_start, r_out).flatten()

    # r_c에서 안쪽으로 적분
    r_in = r[:r_start_idx+1][::-1]
    v_in_rev = odeint(dv_dr, c_s * 0.99, r_in).flatten()
    v_in = v_in_rev[::-1]

    # 결합
    r_sol = np.concatenate([r_in[:-1], r_out])
    v_sol = np.concatenate([v_in[:-1], v_out])

    # 질량 보존으로부터 밀도
    # ρ v r² = ρ_c c_s r_c²
    rho_c = 1e-12  # kg/m^3 (임의 정규화)
    rho_sol = rho_c * c_s * r_c**2 / (v_sol * r_sol**2)

    # 수밀도
    n_sol = rho_sol / m_p  # m^-3

    # 플롯
    fig, (ax1, ax2, ax3) = plt.subplots(3, 1, figsize=(10, 12))

    # 속도
    ax1.plot(r_sol/R_sun, v_sol/1e3, 'b-', linewidth=2)
    ax1.axhline(c_s/1e3, color='r', linestyle='--', label='음속')
    ax1.axvline(r_c/R_sun, color='g', linestyle='--', label='임계 반경')
    ax1.axvline(215, color='orange', linestyle='--', label='1 AU')
    ax1.set_xlabel('반경 ($R_\\odot$)', fontsize=12)
    ax1.set_ylabel('속도 (km/s)', fontsize=12)
    ax1.set_title('Parker 태양풍: 속도 프로파일', fontsize=14)
    ax1.set_xscale('log')
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # 밀도
    ax2.semilogy(r_sol/R_sun, n_sol/1e6, 'b-', linewidth=2)  # cm^-3
    ax2.axvline(r_c/R_sun, color='g', linestyle='--')
    ax2.axvline(215, color='orange', linestyle='--')
    ax2.set_xlabel('반경 ($R_\\odot$)', fontsize=12)
    ax2.set_ylabel('수밀도 (cm$^{-3}$)', fontsize=12)
    ax2.set_title('Parker 태양풍: 밀도 프로파일', fontsize=14)
    ax2.set_xscale('log')
    ax2.grid(True, alpha=0.3)

    # 마하 수
    M = v_sol / c_s
    ax3.plot(r_sol/R_sun, M, 'b-', linewidth=2)
    ax3.axhline(1, color='r', linestyle='--', label='M = 1')
    ax3.axvline(r_c/R_sun, color='g', linestyle='--')
    ax3.axvline(215, color='orange', linestyle='--')
    ax3.set_xlabel('반경 ($R_\\odot$)', fontsize=12)
    ax3.set_ylabel('마하 수', fontsize=12)
    ax3.set_title('Parker 태양풍: 마하 수', fontsize=14)
    ax3.set_xscale('log')
    ax3.legend()
    ax3.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('parker_solar_wind.png', dpi=150)
    plt.show()

    # 1 AU에서의 값 출력
    idx_1AU = np.argmin(np.abs(r_sol - 215*R_sun))
    print(f"\n1 AU에서:")
    print(f"  속도: {v_sol[idx_1AU]/1e3:.1f} km/s")
    print(f"  밀도: {n_sol[idx_1AU]/1e6:.2f} cm^-3")
    print(f"  마하 수: {M[idx_1AU]:.2f}")

parker_solar_wind()
```

### 6.2 플럭스 튜브 상승 계산

```python
import numpy as np
import matplotlib.pyplot as plt

def flux_tube_rise():
    """
    태양 대류층을 통한 자기 플럭스 튜브의 상승을 계산합니다.

    부력 방정식:
      dv_z/dt = (Δρ/ρ_e) g - C_D v_z² / (2H_p)

    여기서 Δρ = ρ_e - ρ_i (밀도 결핍).
    """
    # 태양 매개변수
    g = 274  # m/s^2 (표면 중력)
    R_sun = 6.96e8  # m
    M_sun = 1.989e30  # kg

    # 대류층
    r_bottom = 0.7 * R_sun  # 기저 (타코클라인)
    r_top = R_sun           # 광구

    # 층화 (단순화된 지수)
    H_p = 5e7  # 압력 스케일 높이 ~ 50 Mm
    rho_0 = 1e-1  # kg/m^3 (r_bottom에서, 근사)

    def rho_ext(r):
        """외부 밀도 (층화된 대기)."""
        return rho_0 * np.exp(-(r - r_bottom) / H_p)

    # 자기장 강도
    B = 3e4 * 1e-4  # Tesla로 30 kG

    # 내부 밀도: 압력 균형
    # p_i + B²/(2μ₀) = p_e
    # 등온 가정: p = ρ c_s²
    c_s = 1e4  # m/s (음속)
    mu_0 = 4*np.pi*1e-7

    def rho_int(rho_e, B):
        """압력 균형으로부터 내부 밀도."""
        p_e = rho_e * c_s**2
        p_i = p_e - B**2 / (2*mu_0)
        return p_i / c_s**2

    # 저항 계수
    C_D = 0.5

    # 시간 진화
    dt = 100  # 초
    t_max = 1e7  # 초 (~100일)
    Nt = int(t_max / dt)

    # 배열
    t = np.zeros(Nt)
    z = np.zeros(Nt)  # r_bottom 위의 높이
    v_z = np.zeros(Nt)

    # 초기 조건
    z[0] = 1e6  # 타코클라인 위 1 Mm에서 시작
    v_z[0] = 0

    # 적분
    for n in range(Nt - 1):
        r = r_bottom + z[n]
        rho_e = rho_ext(r)
        rho_i = rho_int(rho_e, B)

        Delta_rho = rho_e - rho_i

        # 부력 가속도
        a_buoy = (Delta_rho / rho_e) * g

        # 저항
        a_drag = -C_D * v_z[n]**2 / (2 * H_p)

        # 속도 업데이트
        dv_dt = a_buoy + a_drag
        v_z[n+1] = v_z[n] + dt * dv_dt

        # 위치 업데이트
        z[n+1] = z[n] + dt * v_z[n+1]

        # 시간 저장
        t[n+1] = t[n] + dt

        # 표면 도달 시 중지
        if z[n+1] >= (r_top - r_bottom):
            z = z[:n+2]
            v_z = v_z[:n+2]
            t = t[:n+2]
            break

    # Mm 및 일로 변환
    z_Mm = z / 1e6
    t_days = t / 86400
    v_km_s = v_z / 1e3

    # 플롯
    fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(10, 10))

    ax1.plot(t_days, z_Mm, 'b-', linewidth=2)
    ax1.axhline((r_top - r_bottom)/1e6, color='r', linestyle='--', label='광구')
    ax1.set_xlabel('시간 (일)', fontsize=12)
    ax1.set_ylabel('타코클라인 위 높이 (Mm)', fontsize=12)
    ax1.set_title('플럭스 튜브 상승: 높이 대 시간', fontsize=14)
    ax1.legend()
    ax1.grid(True)

    ax2.plot(t_days, v_km_s, 'b-', linewidth=2)
    ax2.set_xlabel('시간 (일)', fontsize=12)
    ax2.set_ylabel('상승 속도 (km/s)', fontsize=12)
    ax2.set_title('플럭스 튜브 상승: 속도 대 시간', fontsize=14)
    ax2.grid(True)

    plt.tight_layout()
    plt.savefig('flux_tube_rise.png', dpi=150)
    plt.show()

    print(f"광구까지 상승 시간: {t_days[-1]:.1f} 일")
    print(f"최종 속도: {v_km_s[-1]:.2f} km/s")

flux_tube_rise()
```

### 6.3 합성 데이터로부터의 나비 다이어그램

```python
import numpy as np
import matplotlib.pyplot as plt

def butterfly_diagram_synthetic():
    """
    합성 태양 나비 다이어그램을 생성합니다.

    모델:
      - 흑점 위도: λ(t) = λ_max cos(2π t / P) exp(-t / τ_decay)
      - 주기에 따른 적도방향 이동
    """
    # 매개변수
    P = 11  # 년 (주기)
    N_cycles = 3

    # 시간 배열
    t = np.linspace(0, N_cycles * P, 1000)

    # 나비 패턴 생성
    # 흑점 출현 위도
    lambda_max = 35  # 도 (최대 위도)
    tau_decay = P / 2  # 감쇠 시간 척도

    # 각 주기에 대해
    latitudes_N = []
    latitudes_S = []
    times = []

    for cycle in range(N_cycles):
        t_cycle = t[(t >= cycle*P) & (t < (cycle+1)*P)] - cycle*P

        # 위도가 주기 동안 λ_max에서 ~5°로 감소
        lambda_t = lambda_max * (1 - t_cycle / P) + 5

        # 산란 추가
        N_spots = 200
        t_spots = np.random.uniform(0, P, N_spots)
        lambda_spots = lambda_max * (1 - t_spots / P) + 5 + np.random.normal(0, 3, N_spots)

        # 극성이 각 주기마다 반전
        if cycle % 2 == 0:
            latitudes_N.extend(lambda_spots)
            latitudes_S.extend(-lambda_spots)
        else:
            latitudes_N.extend(-lambda_spots)
            latitudes_S.extend(lambda_spots)

        times.extend(t_spots + cycle * P)

    # 결합
    latitudes = np.concatenate([latitudes_N, latitudes_S])
    times_all = np.concatenate([times, times])

    # 플롯
    plt.figure(figsize=(12, 6))
    plt.scatter(times_all, latitudes, s=1, c='k', alpha=0.5)
    plt.axhline(0, color='r', linestyle='--', linewidth=0.5)
    for cycle in range(N_cycles + 1):
        plt.axvline(cycle * P, color='gray', linestyle='--', linewidth=0.5)

    plt.xlabel('시간 (년)', fontsize=14)
    plt.ylabel('위도 (도)', fontsize=14)
    plt.title('합성 태양 나비 다이어그램', fontsize=16)
    plt.ylim(-40, 40)
    plt.grid(True, alpha=0.3)
    plt.savefig('butterfly_diagram_synthetic.png', dpi=150)
    plt.show()

butterfly_diagram_synthetic()
```

## 7. 요약

**태양 MHD**는 자기장에 의해 구동되는 다양한 현상을 포함합니다:

1. **태양 구조:**
   - 대류층 (다이나모), 타코클라인 (toroidal 장 생성), 코로나 (신비롭게 뜨거움)
   - 자기장은 ~1 G (조용한 태양)에서 ~3000 G (흑점)까지 범위

2. **자기 플럭스 튜브 및 흑점:**
   - **얇은 플럭스 튜브:** 압력 균형 `p_i + B²/(2μ₀) = p_e`
   - **자기 부력:** 밀도가 낮은 튜브가 대류층을 통해 상승
   - **흑점:** 강한 수직 장의 집중, 대류 억제 → 더 차갑고 어두움

3. **태양 다이나모:**
   - **α-Ω 메커니즘:** 차등 회전 (Ω) + 나선형 난류 (α) → 주기적 장 생성
   - **Babcock-Leighton:** 기울어진 양극 영역으로부터의 표면 poloidal 소스
   - **플럭스 수송 다이나모:** 자오선 순환이 핵심 역할
   - **11년 주기:** 나비 다이어그램 (적도방향 이동), 극 장 반전

4. **코로나 가열:**
   - **문제:** 코로나가 ~10⁶ K, 광구보다 훨씬 위
   - **파동 가열:** 알벤 파동 (위상 혼합, 공명 흡수, 난류)
   - **나노플레어:** 많은 작은 재결합 사건 (Parker의 가설)
   - 두 가지 모두의 조합 가능성

5. **태양풍:**
   - **Parker 모델:** 뜨거운 코로나로부터의 천이음속 팽창
   - **임계점:** `r_c ~ 10 R☉`, 흐름이 초음속이 됨
   - **빠른 바람:** 코로나 홀로부터 (~700 km/s)
   - **느린 바람:** 스트리머 벨트로부터 (~400 km/s)
   - **난류:** 알벤 변동, 캐스케이드, 가열

태양은 MHD 과정을 연구하는 자연 실험실로, 다른 별, 강착 원반, 행성 자기권에 응용됩니다.

## 연습 문제

1. **압력 균형:** 흑점이 `B = 3000 G`를 가집니다. 외부 기체 압력이 `p_e = 10⁴ Pa`인 경우, 내부 기체 압력 `p_i`는 얼마입니까?

2. **자기 부력:** `ρ_e = 0.1 g/cm³`, `c_s = 10 km/s`인 대류층에서 `B = 10 kG`를 가진 플럭스 튜브의 경우, 등온 압력 균형을 가정하여 밀도 결핍 `Δρ = ρ_e - ρ_i`를 계산하세요.

3. **상승 시간:** 문제 2의 밀도 결핍과 `g = 274 m/s²`를 사용하여 부력 가속도를 추정하세요. 종단 속도에 도달하면 200 Mm (대류층의 두께)를 상승하는 데 얼마나 걸립니까?

4. **태양 다이나모 수:** `α = 0.1 m/s`, `ΔΩ = 10⁻⁶ rad/s`, `R = 5×10⁸ m`, `η_eff = 10¹⁰ cm²/s`에 대해 `D_αΩ`를 계산하세요.

5. **코로나의 알벤 속도:** `B = 5 G`, `n = 10⁸ cm⁻³` (양성자)에 대해 알벤 속도를 km/s로 계산하세요.

6. **임계 반경:** 코로나 온도 `T = 2×10⁶ K`에 대해 임계 반경 `r_c`를 `R☉` 단위로 계산하세요.

7. **1 AU에서의 태양풍:** `T = 1.5×10⁶ K`인 Parker 모델을 사용하여 1 AU (215 R☉)에서의 속도를 추정하세요. 관측된 ~400 km/s와 비교하세요.

8. **나노플레어 에너지:** 크기 `L = 100 km`, `B = 10 G`인 전류 시트가 재결합합니다. erg 단위로 방출되는 에너지를 추정하세요.

9. **Python 연습:** Parker 태양풍 코드를 등온 대신 다변 관계 `p ∝ ρ^{1.2}`를 포함하도록 수정하세요. 종단 속도가 어떻게 변합니까?

10. **심화:** 타코클라인의 Ω-효과와 표면의 Babcock-Leighton α-효과를 가진 간단한 1D 플럭스 수송 다이나모 모델을 구현하세요. 자오선 순환과 확산을 포함하세요. 나비 다이어그램을 재현하세요.

---

**이전**: [난류 다이나모](./10_Turbulent_Dynamo.md) | **다음**: [강착 원반 MHD](./12_Accretion_Disk_MHD.md)
