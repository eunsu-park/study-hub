# 레슨 8: 문맥 자유 언어의 성질(Properties of Context-Free Languages)

**이전**: [푸시다운 오토마타](./07_Pushdown_Automata.md) | **다음**: [튜링 기계](./09_Turing_Machines.md)

## 학습 목표

이 레슨을 마치면 다음을 할 수 있습니다:

1. 문맥 자유 언어에 대한 펌핑 보조정리(pumping lemma)를 기술하고 적용한다
2. 특정 언어가 문맥 자유 언어가 아님을 증명한다
3. CFL의 폐쇄 성질(closure properties)과 비폐쇄 성질을 열거한다
4. CFL에 관한 결정 가능 문제(decidable problems)와 결정 불가능 문제를 구별한다

---

정규 언어에 대한 펌핑 보조정리가 그 경계를 드러냈듯, 문맥 자유 언어도 고유한 한계를 지닌다. $a^n b^n c^n$ 같이 세 방향 동조(three-way coordination)가 필요한 언어는 어떤 CFG나 PDA로도 인식할 수 없다. 이러한 한계를 이해하는 것은 — CFL에 대해 결정 가능한 것과 그렇지 않은 것과 함께 — 문맥 자유 문법보다 더 강력한 형식 체계가 언제 필요한지 파악하는 데 필수적이다.

## 1. CFL을 위한 펌핑 보조 정리(Pumping Lemma)

**정리 (문맥 자유 언어에 대한 펌핑 보조 정리).** $L$이 문맥 자유 언어(Context-Free Language)이면, $|w| \geq p$를 만족하는 모든 $w \in L$을 $w = uvxyz$로 쓸 수 있는 상수 $p \geq 1$이 존재하며, 다음 조건이 성립한다:

1. $|vy| \geq 1$ ($v, y$ 중 적어도 하나는 공문자열이 아님)
2. $|vxy| \leq p$ ($v, x, y$를 합친 길이가 유계)
3. 모든 $i \geq 0$에 대해 $uv^ixy^iz \in L$ ($v$와 $y$를 함께 펌핑해도 원소 관계 유지)

### 1.1 직관

촘스키 정규형(CNF) 문법에서 긴 문자열에 대한 파스 트리(parse tree)는 높이가 커야 한다. 높이가 충분히 크면 루트에서 잎까지의 경로 위에서 어떤 변수 $A$가 반복된다. 두 번 나타나는 $A$ 사이의 부분 트리가 "펌프" 부분인 $v$와 $y$를 생성한다.

### 1.2 증명 개요

$L$에 대한 CNF 문법 $G$의 변수 집합 크기를 $|V|$라 하자. $p = 2^{|V|+1}$로 설정한다.

$|w| \geq p$인 임의의 $w \in L$에 대해 파스 트리의 높이가 $|V|$를 초과한다. 비둘기집 원리(pigeonhole principle)에 의해 루트에서 잎까지의 경로 위에 반복되는 변수 $A$가 존재한다.

$A$가 두 번 나타나는 위치로부터 다음을 정의한다:
- $u$: 바깥 $A$의 부분 트리 왼쪽에서 생성되는 문자열
- $v$: 바깥 $A$와 안쪽 $A$의 왼쪽 부분 사이에서 생성되는 문자열
- $x$: 안쪽 $A$의 부분 트리에서 생성되는 문자열
- $y$: 안쪽 $A$와 바깥 $A$의 오른쪽 부분 사이에서 생성되는 문자열
- $z$: 바깥 $A$의 부분 트리 오른쪽에서 생성되는 문자열

$A \Rightarrow^* vAy$이고 $A \Rightarrow^* x$이므로, 펌핑이 가능하다: 임의의 $i \geq 0$에 대해 $A \Rightarrow^* v^i x y^i$. $\square$

## 2. 펌핑 보조 정리 응용

### 2.1 $L = \{a^n b^n c^n \mid n \geq 0\}$은 문맥 자유 언어가 아니다

*증명.* 펌핑 길이(pumping length) $p$를 갖는 CFL이라 가정한다. $w = a^p b^p c^p$로 놓는다.

$|vy| \geq 1$, $|vxy| \leq p$를 만족하도록 $w = uvxyz$로 쓴다.

$|vxy| \leq p$이므로 부분 문자열 $vxy$는 세 기호 유형 모두에 걸칠 수 없다. 따라서 $v$와 $y$는 합쳐서 $\{a, b, c\}$ 중 최대 두 종류만 포함한다.

펌핑 업($i = 2$): $uv^2xy^2z$는 최대 두 기호의 수는 늘어나지만 세 번째 기호의 수는 그대로다. 개수가 더 이상 같지 않으므로 $uv^2xy^2z \notin L$. 모순. $\square$

### 2.2 $L = \{ww \mid w \in \{a,b\}^*\}$은 문맥 자유 언어가 아니다

*증명.* 펌핑 길이 $p$를 갖는 CFL이라 가정한다. $w = a^p b^p a^p b^p$로 놓는다.

$|vxy| \leq p$를 만족하도록 $w = uvxyz$로 쓴다.

$|vxy| \leq p$이므로 펌프 영역은 다음 구역 중 하나에 속한다:
- 첫 번째 $a^p b^p$ 내부: 펌핑 시 전반부만 변하고 후반부는 불변
- 두 절반의 경계를 걸치는 경우: 펌핑 시 구조가 무너짐

어느 경우든 펌핑하면 $ww$ 형태가 아닌 문자열이 생성된다. (상세한 경우 분석을 통해 모든 위치가 모순을 유발함을 확인할 수 있다.) $\square$

### 2.3 $L = \{a^{n!} \mid n \geq 0\}$은 문맥 자유 언어가 아니다

*증명.* 펌핑 길이 $p$를 갖는 CFL이라 가정한다. $p! \geq p$인 $w = a^{p!}$로 놓는다.

$1 \leq k \leq p$인 $|vy| = k$가 되도록 $w = uvxyz$로 쓴다.

그러면 $|uv^ixy^iz| = p! + (i-1)k$.

$i = 2$일 때: $|uv^2xy^2z| = p! + k$. $p! + k$가 계승(factorial)이어야 한다.

그런데 $p! < p! + k \leq p! + p < p! + p \cdot p! = (p+1)!$.

따라서 $p! + k$는 $p!$와 $(p+1)!$ 사이에 엄격히 존재하므로 계승이 아니다. 모순. $\square$

## 3. 폐쇄 성질(Closure Properties)

### 3.1 폐쇄되는 연산

| 연산 | 폐쇄? | 증명 방법 |
|------|-------|-----------|
| 합집합 $L_1 \cup L_2$ | 예 | $S \to S_1 \mid S_2$ |
| 연결(Concatenation) $L_1 \cdot L_2$ | 예 | $S \to S_1 S_2$ |
| 클리니 스타(Kleene star) $L^*$ | 예 | $S \to S S_1 \mid \varepsilon$ |
| 역전(Reversal) $L^R$ | 예 | 모든 생성 규칙을 역전 |
| 동형사상(Homomorphism) $h(L)$ | 예 | 문법의 단말 기호 교체 |
| 역 동형사상(Inverse homomorphism) $h^{-1}(L)$ | 예 | PDA 구성 |
| 정규 언어와의 교집합 $L_1 \cap R$ | 예 | PDA × DFA 곱 |
| 대입(Substitution) | 예 | 단말 기호를 CFG로 교체 |

### 3.2 폐쇄되지 않는 연산

| 연산 | 폐쇄? | 반례 |
|------|-------|------|
| 교집합 $L_1 \cap L_2$ | **아니오** | $\{a^n b^n c^m\} \cap \{a^m b^n c^n\} = \{a^n b^n c^n\}$ |
| 여집합 $\overline{L}$ | **아니오** | 여집합과 합집합에 대해 닫혀 있으면 드 모르간(De Morgan) 법칙에 의해 교집합에도 닫혀 있게 됨 |

### 3.3 정규 언어와의 교집합

**정리.** $L$이 문맥 자유 언어이고 $R$이 정규 언어이면, $L \cap R$은 문맥 자유 언어이다.

*증명.* $L$의 PDA와 $R$의 DFA를 병렬로 실행하여 $L \cap R$의 PDA를 구성한다:
- 상태: $Q_{PDA} \times Q_{DFA}$
- 스택: PDA의 스택과 동일
- 전이: 두 기계를 동시에 진행
- 수락: 두 기계 모두 수락할 때

이 성질은 폐쇄성을 이용한 비문맥자유 증명에 매우 유용하다:

**예:** $L = \{w \in \{a,b,c\}^* \mid |w|_a = |w|_b = |w|_c\}$는 CFL이 아니다.

*증명.* $L$이 CFL이라 가정한다. 그러면 $L \cap a^*b^*c^* = \{a^n b^n c^n \mid n \geq 0\}$이 CFL이 될 것이다 (정규 언어 $a^*b^*c^*$와의 교집합). 모순. $\square$

## 4. 오그덴의 보조 정리(Ogden's Lemma)

**오그덴의 보조 정리(Ogden's Lemma)**는 CFL 펌핑 보조 정리를 강화한 버전으로, 적어도 $p$개의 위치를 "표시"하고 펌프가 반드시 표시된 위치를 포함해야 한다는 조건을 추가한다.

**정리.** $L$이 CFL이면, $\exists p$가 존재하여 적어도 $p$개의 표시된 위치를 갖는 임의의 $w \in L$에 대해 $w = uvxyz$가 다음을 만족한다:
1. $v$와 $y$가 합쳐서 적어도 하나의 표시된 위치를 포함
2. $vxy$가 최대 $p$개의 표시된 위치를 포함
3. $\forall i \geq 0$에 대해 $uv^ixy^iz \in L$

오그덴의 보조 정리는 표준 펌핑 보조 정리가 실패하는 경우에도 비문맥자유성을 증명할 수 있다.

## 5. CFL에 관한 결정 문제(Decision Problems)

### 5.1 결정 가능 문제

| 문제 | 결정 가능? | 방법 |
|------|-----------|------|
| 원소 관계: $w \in L(G)$? | 예 | CYK 알고리즘, $O(n^3)$ |
| 공집합 여부: $L(G) = \emptyset$? | 예 | 시작 변수가 생성 변수인지 확인 |
| 유한성: $L(G)$는 유한한가? | 예 | 유용한 변수들의 "단위 그래프(unit graph)"에서 사이클 확인 |

### 5.2 결정 불가능 문제

| 문제 | 결정 가능? |
|------|-----------|
| 전체성(Universality): $L(G) = \Sigma^*$? | **아니오** |
| 동치성(Equivalence): $L(G_1) = L(G_2)$? | **아니오** |
| 포함 관계(Inclusion): $L(G_1) \subseteq L(G_2)$? | **아니오** |
| 모호성(Ambiguity): $G$는 모호한가? | **아니오** |
| 본질적 모호성: $L$은 본질적으로 모호한가? | **아니오** |
| 정규성(Regularity): $L(G)$는 정규 언어인가? | **아니오** |
| 교집합 공집합: $L(G_1) \cap L(G_2) = \emptyset$? | **아니오** |

이러한 결정 불가능 문제들은 모두 결정 가능한 정규 언어와 극명한 대조를 이룬다.

## 6. 문맥 자유 언어와 정규 언어 비교

| 성질 | 정규 언어(Regular) | 문맥 자유 언어(Context-Free) |
|------|-------------------|------------------------------|
| 오토마톤 | DFA/NFA | PDA |
| 문법 | 우선형 문법(Right-linear) | 문맥 자유 문법(Context-free) |
| 대수적 표현 | 정규 표현식(Regular expression) | — |
| 펌핑 보조 정리 | 3분할 | 5분할 |
| ∩에 대한 폐쇄 | 예 | **아니오** |
| 여집합에 대한 폐쇄 | 예 | **아니오** |
| 동치성 결정 가능 | 예 | **아니오** |
| 결정적 = 비결정적 | DFA = NFA | DPDA ≠ NPDA |

## 연습 문제

### 연습 1: 펌핑 보조 정리

다음 언어들이 문맥 자유 언어가 아님을 증명하라:

1. $L = \{a^n b^n c^n d^n \mid n \geq 0\}$
2. $L = \{a^n b^n c^i \mid n \leq i \leq 2n\}$
3. $L = \{a^{2^n} \mid n \geq 0\}$

### 연습 2: 폐쇄 성질

1. 정규 언어와의 교집합 폐쇄성을 이용하여 $\{a^n b^m c^n d^m \mid n, m \geq 0\}$이 CFL이 아님을 증명하라.
2. 문법을 제시하여 $L_1 = \{a^n b^n c^m \mid n, m \geq 0\}$과 $L_2 = \{a^m b^n c^n \mid n, m \geq 0\}$이 모두 CFL임을 보여라.
3. $L_1 \cap L_2 = \{a^n b^n c^n \mid n \geq 0\}$임을 확인하고, CFL이 교집합에 대해 닫혀 있지 않음을 결론지어라.

### 연습 3: 결정 문제

각 문제에 대해 CFL에서의 결정 가능 여부를 서술하고 이유를 간략히 설명하라:

1. CFG $G$가 주어질 때, $|L(G)| \geq 100$인가?
2. CFG $G_1, G_2$가 주어질 때, $L(G_1) \cap L(G_2) = \emptyset$인가?
3. CFG $G$와 정규 표현식 $R$이 주어질 때, $L(G) \subseteq L(R)$인가?

---

*이전: [레슨 7 — 푸시다운 오토마톤](07_Pushdown_Automata.md) | 다음: [레슨 9 — 튜링 기계](09_Turing_Machines.md)*
