# 레슨 6: 근궤적법(Root Locus Method)

## 학습 목표

- 제어 설계를 위한 그래픽 도구로서 근궤적(Root Locus)의 개념 이해
- 손으로 근궤적을 스케치하기 위한 규칙 적용
- 원하는 폐루프 극점 위치를 얻기 위해 근궤적을 이용한 이득 선정
- 개루프 전달함수에 극점과 영점을 추가했을 때의 영향 분석
- 제어기 설계에 근궤적법 적용

## 1. 근궤적 소개

**근궤적(Root Locus)**은 파라미터(보통 이득 $K$)가 $0$에서 $\infty$로 변할 때 가능한 모든 폐루프 극점 위치의 집합이다.

개루프 전달함수가 $KG(s)H(s)$인 단위 피드백 시스템에서 특성방정식은 다음과 같다:

$$1 + KG(s)H(s) = 0$$

$$KG(s)H(s) = -1$$

이를 만족하려면 두 조건이 동시에 성립해야 한다:
- **크기 조건(Magnitude condition):** $|KG(s)H(s)| = 1$
- **위상 조건(Angle condition):** $\angle G(s)H(s) = (2k+1) \times 180°$, $k = 0, \pm1, \pm2, \ldots$

근궤적은 위상 조건을 만족하는 모든 점 $s$로 구성된다. 궤적 위 임의의 점에서 이득 $K$는 크기 조건으로부터 구한다.

## 2. 근궤적 스케치 규칙

$G(s)H(s) = \frac{N(s)}{D(s)}$에서 극점이 $n$개, 영점이 $m$개($n \geq m$)라 하자.

### 규칙 1: 시작점과 끝점

- 궤적은 ($K = 0$) **개루프 극점**에서 **시작**한다
- 궤적은 ($K \to \infty$) **개루프 영점**(무한대의 영점 $n - m$개 포함)에서 **끝난다**

### 규칙 2: 분지 수(Number of Branches)

- $n$개의 분지가 존재한다(개루프 극점 수와 동일)

### 규칙 3: 대칭성(Symmetry)

- 근궤적은 **실수축에 대해 대칭**이다(복소 극점은 켤레쌍으로 존재)

### 규칙 4: 실수축 구간(Real-Axis Segments)

- 실수축 위의 한 점이 근궤적 위에 있으려면, 그 점의 **오른쪽에 있는 실수 극점과 영점의 합계가 홀수**여야 한다

### 규칙 5: 점근선(Asymptotes)

무한대로 향하는 $n - m$개의 분지는 점근선에 접근한다:
- **각도(Angles):** $\theta_a = \frac{(2k+1) \times 180°}{n-m}$, $k = 0, 1, \ldots, n-m-1$
- **도심(Centroid)**(실수축 위 교점): $\sigma_a = \frac{\sum p_i - \sum z_j}{n - m}$

### 규칙 6: 분기점과 합류점(Breakaway and Break-in Points)

분지가 실수축을 이탈하거나 진입하는 점은 다음에서 구한다:

$$\frac{dK}{ds} = 0 \quad \text{여기서} \quad K = -\frac{1}{G(s)H(s)}$$

### 규칙 7: 출발각과 도달각(Departure and Arrival Angles)

- 복소 극점 $p_i$에서의 **출발각(Departure angle):** $\theta_d = 180° - \sum \angle(p_i - p_j) + \sum \angle(p_i - z_k)$ (다른 모든 극점과 영점에 대해 합산)
- 복소 영점 $z_i$에서의 **도달각(Arrival angle):** $\theta_a = 180° + \sum \angle(z_i - p_j) - \sum \angle(z_i - z_k)$

### 규칙 8: 허수축 교차(Imaginary Axis Crossings)

$s = j\omega$를 특성방정식에 대입하여 $\omega$와 $K$를 풀거나(또는 루스 기준(Routh criterion)을 이용하여 임계 $K$를 구하여) 산출한다.

## 3. 근궤적 예제

**예제:** $G(s)H(s) = \frac{1}{s(s+1)(s+3)}$

- **극점(Poles):** $s = 0, -1, -3$ ($n = 3$, $m = 0$)
- **영점(Zeros):** 유한 영점 없음 → 무한대에 영점 3개

**규칙 적용:**

1. **분지:** 3개, $s = 0, -1, -3$에서 시작
2. **점근선:** $n - m = 3$
   - 각도: $60°, 180°, 300°$
   - 도심: $\sigma_a = (0 + (-1) + (-3))/3 = -4/3$
3. **실수축 구간:** $(-\infty, -3)$ 및 $(-1, 0)$
4. **분기점:** $\frac{d}{ds}[s(s+1)(s+3)] = 0$ 풀기: $3s^2 + 8s + 3 = 0 \Rightarrow s = -0.451, -2.215$
   - $s = -0.451$은 궤적 위에 있음($-1$과 $0$ 사이) → 분기점
   - $s = -2.215$는 궤적 위에 없음
5. **허수축 교차:** $s^3 + 4s^2 + 3s + K = 0$에 루스 적용: 임계 $K = 12$, $\omega = \sqrt{3}$

근궤적은 실수축에서 갈라지는 세 분지를 보여주며, $K$가 0에서 증가하면 시스템은 $K = 12$에서 불안정해진다.

## 4. 극점과 영점 추가의 영향

### 4.1 극점 추가

개루프 극점 추가 시:
- 근궤적을 **우반평면(right half-plane) 방향으로 밀어냄** (불안정화)
- 안정 범위의 $K$ 감소
- 무한대로 향하는 분지 하나 추가

### 4.2 영점 추가

개루프 영점 추가 시:
- 근궤적을 **좌반평면(left half-plane) 방향으로 당김** (안정화)
- 안정 범위의 $K$ 증가
- 분지의 종착점 제공

### 4.3 진상·지상 보상기 미리보기

- **진상 보상기(Lead compensator)** (극점 왼쪽에 영점): 근궤적을 왼쪽으로 굽힘 → 과도 응답 개선
- **지상 보상기(Lag compensator)** (원점 근처 극점, 인접 영점): 근궤적 형태에 큰 영향 없이 저주파 이득 수정 → 정상상태 오차 감소

이 내용은 레슨 10에서 자세히 다룬다.

## 5. 설계를 위한 근궤적 활용

### 5.1 이득 선정(Gain Selection)

원하는 폐루프 극점 위치 $s_d$를 달성하려면:

1. $s_d$가 근궤적 위에 있는지 확인(위상 조건 검토)
2. 크기 조건으로 $K$ 계산: $K = \frac{1}{|G(s_d)H(s_d)|}$
3. 나머지 폐루프 극점이 허용 범위인지 확인

### 5.2 사양에 따른 설계(Design to Specifications)

시간 영역 사양($t_s$, $M_p$ 등)이 주어지면:

1. 원하는 $\zeta$와 $\omega_n$으로 변환(또는 등가적으로 원하는 $\sigma$와 $\omega_d$)
2. $s$-평면에서 목표 영역 파악
3. 목표 영역 내 점이 근궤적 위에 있으면 이득 선정
4. 그렇지 않으면 보상기(극점/영점) 추가로 궤적 재형성

### 5.3 예제: 이득 설계

$G(s) = \frac{K}{s(s+4)}$에서 $M_p \leq 20\%$, $t_s \leq 2$ s를 만족하도록 설계하라.

**사양 → $s$-평면:**
- $M_p \leq 20\%$: $\zeta \geq 0.456$
- $t_s \leq 2$ s: $\sigma = \zeta\omega_n \geq 2$

근궤적은 $s = -2$(실수축 중간점에서 분기)에서 수직선을 이룬다. $\text{Re}(s) \leq -2$이고 $\zeta \geq 0.456$인 극점이 필요하다.

$s = -2 + j3.88$($\zeta = 0.456$ 만족)에서: $K = |s(s+4)| = |(-2+j3.88)(-2+j3.88+4)| = 19.4$

## 6. 음의 $K$에 대한 근궤적(상보 근궤적, Complementary Root Locus)

$K$가 $-\infty$에서 $0$으로 변할 때 위상 조건은 다음과 같이 된다:

$$\angle G(s)H(s) = 2k \times 180°$$

상보 근궤적은 약간 다른 규칙을 사용한다:
- 실수축 구간: 오른쪽에 있는 극점과 영점의 합계가 **짝수**(0 포함)여야 함
- 점근선 각도: $\theta_a = \frac{2k \times 180°}{n-m}$

이는 양의 피드백 시스템에서 관련된다.

## 연습 문제

### 연습 1: 근궤적 스케치

$G(s) = \frac{K}{s(s+2)(s+4)}$의 근궤적을 스케치하라.

1. 모든 규칙을 적용하여 실수축 구간, 점근선, 분기점, 허수축 교차점을 구하라
2. 허수축 교차점에서의 $K$ 값을 구하라
3. 시스템이 안정한 $K$의 범위는?

### 연습 2: 근궤적을 이용한 설계

$G(s) = \frac{K(s+3)}{s(s+1)(s+5)}$에 대해:

1. 근궤적을 스케치하라
2. 폐루프 극점을 $s = -2$에 배치하는 $K$ 값을 구하라
3. 이 $K$ 값에서 모든 폐루프 극점을 구하라

### 연습 3: 보상기의 영향

시스템 $G(s) = \frac{K}{s(s+2)}$에 대해, 보상기 영점을 다음 위치에 추가했을 때의 근궤적을 비교하라:
1. $s = -1$ (두 극점 사이)
2. $s = -5$ (두 극점 모두의 왼쪽)

두 근궤적을 스케치하고, 영점 위치가 달성 가능한 폐루프 극점 위치에 어떤 영향을 미치는지 논의하라.

---

*이전: [레슨 5 — 안정도 해석](05_Stability_Analysis.md) | 다음: [레슨 7 — 주파수 응답: 보드 선도](07_Bode_Plots.md)*
