# 레슨 9: PID 제어(PID Control)

## 학습 목표

- PID 제어기(PID controller)의 구조와 동작 이해
- 각 항(P, I, D)이 시스템 성능에 미치는 영향 설명
- 고전적 방법(지글러-니콜스(Ziegler-Nichols), 코헨-쿤(Cohen-Coon))을 사용한 PID 동조(tuning)
- 실용적 문제 인식: 적분기 와인드업(integrator windup), 미분 킥(derivative kick), 잡음 증폭(noise amplification)
- 일반적인 플랜트 유형에 PID 제어 적용

## 1. PID 제어기

**PID 제어기(PID controller)**(비례-적분-미분, Proportional-Integral-Derivative)는 산업에서 가장 널리 사용되는 제어기이다. 오차 $e(t) = r(t) - y(t)$로부터 제어 신호를 계산한다:

$$u(t) = K_p e(t) + K_i \int_0^t e(\tau) \, d\tau + K_d \frac{de(t)}{dt}$$

**전달 함수 (이상형(ideal form)):**

$$G_c(s) = K_p + \frac{K_i}{s} + K_d s = K_p\left(1 + \frac{1}{T_i s} + T_d s\right)$$

여기서 $T_i = K_p/K_i$는 **적분 시간(integral time)**, $T_d = K_d/K_p$는 **미분 시간(derivative time)**이다.

### 1.1 PID를 사용하는 이유

- 세 가지 중요한 제어 과제를 처리: 추적(tracking), 외란 제거(disturbance rejection), 잡음 필터링(noise filtering)
- 동조할 파라미터가 3개뿐
- 다양한 플랜트에 잘 동작
- 산업용 제어기의 90% 이상이 PID (또는 PI)

## 2. 각 항의 영향

### 2.1 비례(P) 동작

$$u_P(t) = K_p e(t)$$

- 출력이 현재 오차에 비례
- 이득 **증가** → 정상 상태 오차(steady-state error) 감소, 응답 속도 향상
- **단점:** 계단 외란에 대한 정상 상태 오차를 제거할 수 없음 (0형 시스템의 경우)
- $K_p$가 너무 크면 → 불안정 (위상 여유 감소)

### 2.2 적분(I) 동작

$$u_I(t) = K_i \int_0^t e(\tau) \, d\tau$$

- 과거 오차를 누적
- 계단 입력에 대한 **정상 상태 오차 제거** ($s = 0$에 극점 추가, 시스템 형(type) 증가)
- **단점:** 위상 지연(phase lag) 추가 → 시스템 불안정화 가능
- 빠른 변화에 느리게 반응

### 2.3 미분(D) 동작

$$u_D(t) = K_d \frac{de(t)}{dt}$$

- 오차의 변화율에 반응
- 미래 오차를 **예측** → 과도 응답(transient response) 개선, 감쇠(damping) 추가
- **단점:** 고주파 잡음 증폭
- 정상 상태 오차에는 영향 없음

### 2.4 요약 표

| 동작 | 상승 시간(Rise Time)에 대한 영향 | 오버슈트(Overshoot)에 대한 영향 | 정착 시간(Settling Time)에 대한 영향 | 정상 상태 오차 |
|------|-------------------------------|-------------------------------|-------------------------------------|---------------|
| $K_p$ 증가 | 감소 | 증가 | 소폭 변화 | 감소 |
| $K_i$ 증가 | 감소 | 증가 | 증가 | 제거 |
| $K_d$ 증가 | 소폭 변화 | 감소 | 감소 | 영향 없음 |

**주의:** 이 표는 일반적인 경향을 나타낸다. 실제 영향은 특정 플랜트와 동작점(operating point)에 따라 다르다.

## 3. 일반적인 PID 구성

### 3.1 P 제어기

$$G_c(s) = K_p$$

가장 단순한 제어기. 플랜트에 이미 적분기가 있거나 약간의 정상 상태 오차가 허용될 때 유용하다.

### 3.2 PI 제어기

$$G_c(s) = K_p\left(1 + \frac{1}{T_i s}\right) = K_p \frac{T_i s + 1}{T_i s}$$

산업계의 주력 제어기. 관리 가능한 복잡도로 계단 입력에 대한 정상 상태 오차 제로를 달성한다.

PI 제어기는 $s = -1/T_i$에 **영점(zero)**을, $s = 0$에 **극점(pole)**을 추가한다. 영점은 적분기가 도입하는 위상 지연을 부분적으로 보상한다.

### 3.3 PD 제어기

$$G_c(s) = K_p(1 + T_d s)$$

적분기를 추가하지 않고 과도 응답을 개선한다. 플랜트 자체가 정상 상태 오차를 처리하는 경우(1형 이상)에 유용하다.

### 3.4 PID 제어기

$$G_c(s) = K_p\left(1 + \frac{1}{T_i s} + T_d s\right) = K_p \frac{T_d T_i s^2 + T_i s + 1}{T_i s}$$

세 동작을 모두 결합한다. 분자에 두 개의 영점이 있어 과도 및 정상 상태 성능을 모두 개선하도록 배치할 수 있다.

## 4. PID 동조 방법

### 4.1 지글러-니콜스(Ziegler-Nichols): 개루프 방법 (공정 반응 곡선)

개루프 플랜트에 계단 입력을 인가하고 응답을 측정한다:

```
y(t)
 ^            _______________
 |           /
 |          / ← tangent at steepest point
 |     ____/
 |    /
 |───┘
 └──────┬──┬─────────────→ t
        L   T
```

- $L$: **지연 시간(delay time)** (계단에서 접선이 시간축과 교차할 때까지)
- $T$: **시정수(time constant)** (접선이 최종값에 도달할 때까지)
- $K_0$: 플랜트 DC 이득

**지글러-니콜스 개루프 동조 규칙:**

| 제어기 | $K_p$ | $T_i$ | $T_d$ |
|--------|-------|-------|-------|
| P | $T/(K_0 L)$ | — | — |
| PI | $0.9T/(K_0 L)$ | $L/0.3$ | — |
| PID | $1.2T/(K_0 L)$ | $2L$ | $0.5L$ |

### 4.2 지글러-니콜스(Ziegler-Nichols): 폐루프 방법 (궁극 이득)

1. $K_i = 0$, $K_d = 0$으로 설정 (P-only 제어)
2. 시스템이 지속 진동(sustained oscillation)을 보일 때까지 $K_p$ 증가
3. **궁극 이득(ultimate gain)** $K_u$와 **궁극 주기(ultimate period)** $T_u$ 기록

**지글러-니콜스 폐루프 동조 규칙:**

| 제어기 | $K_p$ | $T_i$ | $T_d$ |
|--------|-------|-------|-------|
| P | $0.5K_u$ | — | — |
| PI | $0.45K_u$ | $T_u/1.2$ | — |
| PID | $0.6K_u$ | $T_u/2$ | $T_u/8$ |

**참고:** 지글러-니콜스 동조는 일반적으로 약 25%의 오버슈트를 수반하는 공격적인 설정을 제공한다. 추가 미세 조정이 보통 필요하다.

### 4.3 코헨-쿤(Cohen-Coon) 방법

동일한 개루프 측정값($K_0$, $L$, $T$)을 사용하지만 덜 공격적인 동조를 제공한다. 큰 데드 타임(dead time)을 가진 플랜트에 더 적합하다.

### 4.4 내부 모델 제어(IMC, Internal Model Control) 동조

플랜트 모델 $G_p(s)$를 기반으로 플랜트를 근사적으로 역변환하는 제어기를 설계한다:

1차 플러스 데드 타임(FOPDT, First-Order Plus Dead Time) 모델 $G_p = \frac{K_0 e^{-Ls}}{\tau s + 1}$에 대해:

$$K_p = \frac{\tau}{K_0(\lambda + L)}, \quad T_i = \tau, \quad T_d = 0$$

여기서 $\lambda$는 원하는 폐루프 시정수(closed-loop time constant)로, 단일 동조 파라미터이다.

- $\lambda$ 증가 → 느리지만 더 강인(robust)
- $\lambda$ 감소 → 빠르지만 덜 강인

## 5. PID 실용적 문제

### 5.1 미분 킥(Derivative Kick)

목표값이 갑자기 변할 때, $de/dt$가 큰 스파이크(미분 킥)를 생성한다. 해결책: 미분 동작을 출력에만 적용 (**출력 미분(derivative on measurement)**):

$$u_D = -K_d \frac{dy}{dt} \quad \text{대신에} \quad u_D = K_d \frac{de}{dt}$$

### 5.2 적분기 와인드업(Integrator Windup)

액추에이터(actuator)가 물리적 한계에 도달하여 포화(saturate)되면, 적분항이 오차를 계속 누적하여 시스템이 선형 영역으로 복귀할 때 큰 오버슈트를 유발한다.

**안티-와인드업(anti-windup) 해결책:**
- **클램핑(Clamping)**: 출력이 포화 상태일 때 적분 중지
- **역계산(Back-calculation)**: 원하는 액추에이터 출력과 실제 출력 간의 차이를 기반으로 적분항 감소
- **조건부 적분(Conditional integration)**: 오차가 작을 때만 적분

### 5.3 미분 잡음 증폭(Derivative Noise Amplification)

순수 미분은 고주파 잡음을 증폭한다. **필터링된 미분(filtered derivative)** 사용:

$$D(s) = \frac{K_d s}{1 + s/(N\omega_c)}$$

여기서 $N$은 일반적으로 5-20이다. 이는 고주파에서 미분 이득을 제한한다.

### 5.4 실용적 PID 형태

모든 실용적 수정을 결합하면:

$$G_c(s) = K_p\left(1 + \frac{1}{T_i s}\right) - K_d \frac{s}{1 + s/N_f} \cdot Y(s)/E(s)$$

적분기에 안티-와인드업을 적용한다.

## 6. PID 설계 예제

**플랜트:** DC 모터, $G_p(s) = \frac{10}{s(s+5)}$ (1형, 계단에 대한 정상 상태 오차 없음)

**요구 사항:** 오버슈트 없음, 정착 시간 $< 2$ s, 램프(ramp) 오차 없음.

**설계:**
1. PI 제어기 필요 (램프 오차 제로를 위한 2형): $G_c(s) = K_p(1 + 1/(T_i s))$
2. 감쇠를 위한 미분 추가: PID, $G_c(s) = K_p(1 + 1/(T_i s) + T_d s)$

**지글러-니콜스 (폐루프):** P-only에서 루스 판별법으로 $K_u$ 계산: $s^2 + 5s + 10K_p = 0$ → $K_u = \infty$ (1형은 P-only 제어로 항상 안정). 이 방법은 여기에 직접 적용되지 않는다.

**대안 (극점 배치, pole placement):** 원하는 폐루프 극점을 선택한 후 PID 파라미터를 계산 — 상태 공간 레슨에서 다루는 더 체계적인 접근법이다.

## 연습 문제

### 연습 1: PID 영향 분석

플랜트 $G_p(s) = \frac{1}{s+1}$인 단위 피드백(unity-feedback) 시스템에 대해:

1. P 제어 ($K_p = 10$)로 폐루프 전달 함수, 계단 정상 상태 오차, $M_p$를 구하라
2. 적분 동작 ($T_i = 2$)을 추가하고 반복하라
3. 미분 동작 ($T_d = 0.1$)을 추가하고 오버슈트에 대한 영향을 분석하라

### 연습 2: 지글러-니콜스 동조

플랜트의 계단 응답 특성: 지연 $L = 0.5$ s, 시정수 $T = 3$ s, DC 이득 $K_0 = 2$.

1. 지글러-니콜스 개루프 방법을 사용하여 PID 파라미터를 계산하라
2. 동일한 방법을 사용하여 PI 파라미터를 계산하라
3. $\lambda = 1$ s인 IMC 방법을 사용하여 PI 파라미터를 계산하고 비교하라

### 연습 3: 안티-와인드업

$K_p = 5$, $K_i = 10$인 PI 제어기가 액추에이터 포화 한계 $\pm 1$인 플랜트를 제어하면서 크기 2의 계단을 추적할 때 와인드업이 발생하는 이유를 설명하라. 역계산(back-calculation) 안티-와인드업이 어떻게 도움이 되는지 설명하라.

---

*이전: [레슨 8 — 나이퀴스트 안정도 판별법](08_Nyquist_Stability.md) | 다음: [레슨 10 — 진상-지상 보상(Lead-Lag Compensation)](10_Lead_Lag_Compensation.md)*
