# 레슨 10: 앞섬-뒤짐 보상 (Lead-Lag Compensation)

## 학습 목표

- 앞섬 보상기(Lead Compensator)를 설계하여 과도 응답과 안정 여유를 개선한다
- 뒤짐 보상기(Lag Compensator)를 설계하여 안정성을 저해하지 않으면서 정상상태 오차를 줄인다
- 앞섬-뒤짐 보상을 결합하여 종합적인 성능 개선을 달성한다
- 주파수 영역(보드) 설계 기법을 적용하여 보상기를 합성한다
- 다양한 보상 전략 간의 트레이드오프를 이해한다

## 1. 보상 개요 (Compensation Overview)

단순 이득 $K$를 가진 플랜트 $G_p(s)$가 모든 설계 사양을 충족하지 못할 때, **보상기(Compensator)** $G_c(s)$를 추가하여 시스템의 주파수 응답 또는 근궤적을 재형성한다.

```
R →(+)→ [G_c(s)] → [G_p(s)] → Y
    ↑                          |
    └──────────────────────────┘
```

**보상 유형:**

| 유형 | 구조 | 주요 효과 |
|------|-----------|----------------|
| 앞섬(Lead) | 영점이 극점 왼쪽에 위치 | 위상 앞섬 추가 → PM 개선, 응답 가속 |
| 뒤짐(Lag) | 극점이 원점 근처, 영점이 인접 | 저주파 이득 증가 → $e_{ss}$ 감소 |
| 앞섬-뒤짐(Lead-Lag) | 결합형 | 과도 및 정상상태 모두 개선 |

## 2. 앞섬 보상기 (Lead Compensator)

### 2.1 전달 함수 (Transfer Function)

$$G_{\text{lead}}(s) = K_c \frac{s + z}{s + p} = K_c \frac{\tau s + 1}{\alpha\tau s + 1} \quad (p > z, \; 0 < \alpha < 1)$$

여기서:
- $z = 1/\tau$: 영점(zero) 위치
- $p = 1/(\alpha\tau)$: 극점(pole) 위치 ($p > z$이므로 극점이 더 왼쪽에 위치)
- $\alpha = z/p < 1$: 최대 위상 앞섬량을 결정

### 2.2 주파수 응답 (Frequency Response)

앞섬 보상기는 영점 주파수와 극점 주파수 사이에서 양의 위상을 제공한다:

$$\phi_{\max} = \sin^{-1}\frac{1-\alpha}{1+\alpha}$$

최대 위상이 발생하는 기하 평균 주파수:

$$\omega_{\max} = \frac{1}{\tau\sqrt{\alpha}} = \sqrt{zp}$$

**설계 인사이트:** $\alpha$가 작을수록 위상 앞섬이 커지지만, 고주파에서의 이득 증가(잡음 증폭)도 커진다. 실용적 하한: $\alpha \geq 0.05$ ($\phi_{\max} \leq 65°$). 더 큰 앞섬이 필요한 경우 앞섬 보상기 두 개를 직렬로 연결한다.

### 2.3 보드 설계 절차 (Bode Design Procedure)

**주어진 조건:** 플랜트 $G_p(s)$, 목표 위상 여유 $PM_d$, 정상상태 오차 요건

**설계 단계:**

1. **이득 설정:** 정상상태 오차 요건을 만족하는 이득 $K$를 설정한다 (오차 상수 $K_p$, $K_v$, $K_a$ 활용)
2. **미보상 시스템 평가:** 이득 $K$에서의 현재 $PM$을 구한다
3. **필요 위상 앞섬 결정:** $\phi_{\max} = PM_d - PM_{\text{현재}} + \text{여유}$ (보상기가 $\omega_{gc}$를 이동시키므로 5°~12°의 여유를 추가)
4. **$\alpha$ 계산:** $\alpha = \frac{1 - \sin\phi_{\max}}{1 + \sin\phi_{\max}}$
5. **새 $\omega_{gc}$ 탐색:** $|KG_p(j\omega)| = -10\log_{10}(1/\alpha)$ dB가 되는 주파수를 찾는다 (보상 후 $\omega_{\max}$에서 이득이 0 dB가 되도록)
6. **$\omega_{\max}$ 설정:** $\omega_{\max} = \omega_{gc,\text{new}}$로 설정하고 $\tau = 1/(\omega_{\max}\sqrt{\alpha})$를 계산한다
7. **$K_c$ 계산:** $K_c = K/\alpha$ (또는 전체 DC 이득이 올바르도록 조정)
8. **설계 검증:** 보상된 시스템의 보드 선도를 그려 확인한다

### 2.4 예제 (Example)

**플랜트:** $G_p(s) = \frac{1}{s(s+1)}$

**사양:** $K_v = 10$, $PM \geq 45°$

1. $K_v = 10$의 경우: $K_v = \lim_{s\to 0} sKG_p(s) = K \Rightarrow K = 10$
2. 미보상: $KG_p(s) = \frac{10}{s(s+1)}$. $\omega_{gc} \approx 2.9$ rad/s에서 $PM \approx 18°$
3. 필요 앞섬: $\phi_{\max} = 45° - 18° + 10° = 37°$
4. $\alpha = \frac{1 - \sin 37°}{1 + \sin 37°} = \frac{1 - 0.602}{1 + 0.602} = 0.249$
5. 새 $\omega_{gc}$: $|10/(j\omega)(j\omega + 1)| = 10\log_{10}(1/0.249) = 6$ dB가 되는 곳 → $\omega_{gc} \approx 3.8$ rad/s
6. $\tau = 1/(3.8\sqrt{0.249}) = 0.527$ → 영점 $1/\tau = 1.9$, 극점 $1/(\alpha\tau) = 7.6$

앞섬 보상기: $G_c(s) = \frac{10}{0.249} \cdot \frac{0.527s + 1}{0.131s + 1} = 40.2\frac{s + 1.9}{s + 7.6}$

## 3. 뒤짐 보상기 (Lag Compensator)

### 3.1 전달 함수 (Transfer Function)

$$G_{\text{lag}}(s) = K_c \frac{s + z}{s + p} = K_c \frac{\tau s + 1}{\beta\tau s + 1} \quad (z > p, \; \beta > 1)$$

여기서 $z > p$ (영점이 극점보다 원점에서 더 멀리 위치), 따라서 $\beta = z/p > 1$.

### 3.2 동작 원리 (Principle of Operation)

뒤짐 보상기의 동작 방식:
- **저주파 이득 증가:** 영점 주파수 이하에서 이득을 $\beta$배만큼 증가
- **이득 교차 주파수 근방의 위상에는 큰 영향 없음:** 극점-영점 쌍을 $\omega_{gc}$보다 훨씬 낮은 곳에 배치
- $\omega_{gc}$에서의 소량의 위상 지연이 그 대가

### 3.3 보드 설계 절차 (Bode Design Procedure)

1. **이득 설정:** 현재 $\omega_{gc}$에서 목표 $PM$이 확보되도록 이득 $K$를 설정한다 ($e_{ss}$는 무시)
2. **추가 이득 결정:** $\beta = \frac{K_{\text{필요}}}{K_{\text{현재}}}$ ($e_{ss}$에 필요한 이득과 PM에 사용한 이득의 비율)
3. **영점 배치:** $\omega_z = \omega_{gc}/10$ (교차 주파수보다 1 디케이드 낮게, 위상 영향 최소화)
4. **극점 배치:** $\omega_p = \omega_z/\beta$
5. **검증:** 보상된 시스템의 PM과 $e_{ss}$ 확인

### 3.4 예제 (Example)

**플랜트:** $G_p(s) = \frac{1}{s(s+1)(s+2)}$

**사양:** $K_v = 5$, $PM \geq 40°$

1. 뒤짐 없이 $PM = 40°$를 위해: $\omega_{gc} = 0.5$에서 $PM \approx 63°$. $\omega = 0.5$에서의 이득은 $|G_p(j0.5)| = 0.89 \Rightarrow K = 1/0.89 = 1.12$ → $K_v = K/2 = 0.56$ (너무 작음)
2. $\beta = 5/0.56 = 8.93$
3. 영점: $\omega_z = 0.5/10 = 0.05$ → $z = 0.05$
4. 극점: $\omega_p = 0.05/8.93 = 0.0056$ → $p = 0.0056$

뒤짐 보상기: $G_c(s) = 1.12 \frac{s + 0.05}{s + 0.0056} = 1.12 \frac{20s + 1}{178.6s + 1}$

## 4. 앞섬-뒤짐 보상기 (Lead-Lag Compensator)

### 4.1 구조 (Structure)

$$G_{c}(s) = K_c \frac{(s + z_1)(s + z_2)}{(s + p_1)(s + p_2)}$$

여기서 $(s + z_1)/(s + p_1)$은 앞섬 부분, $(s + z_2)/(s + p_2)$은 뒤짐 부분이다.

### 4.2 설계 전략 (Design Strategy)

1. **뒤짐** 부분을 먼저 설계하여 정상상태 오차 요건을 충족한다
2. **앞섬** 부분을 설계하여 위상 여유 요건을 충족한다
3. 결합 후 검증한다

또는:
1. 목표 PM을 위해 **앞섬**을 먼저 설계한다
2. $e_{ss}$를 위해 저주파 이득을 높이도록 **뒤짐**을 설계한다
3. 뒤짐 부분의 위상 기여가 이득 교차에 영향을 주면 반복한다

### 4.3 적용 기준 (When to Use Each)

| 사양 | 보상기 |
|--------------|-------------|
| PM 부족, $e_{ss}$ 충족 | 앞섬(Lead) |
| PM 충족, $e_{ss}$ 부족 | 뒤짐(Lag) |
| PM과 $e_{ss}$ 모두 개선 필요 | 앞섬-뒤짐(Lead-Lag) |
| 매우 큰 PM 개선 필요 ($> 65°$) | 이중 앞섬 또는 앞섬-뒤짐 |

## 5. PID와의 비교 (Comparison with PID)

고전적 보상기는 PID 제어와 밀접하게 연관된다:

| PID 항 | 보상기 대응 |
|----------|----------------------|
| P | 이득 조정 |
| PI | 뒤짐 보상기 (원점에 극점, 근처에 영점) |
| PD | 앞섬 보상기 (영점, 멀리 떨어진 극점) |
| PID | 적분기를 포함한 앞섬-뒤짐 |

**앞섬-뒤짐이 PID보다 유리한 점:**
- 극점/영점 배치의 유연성이 높음
- 잡음 처리 우수 (앞섬의 고주파 이득이 유한)
- 체계적인 주파수 영역 설계 가능

**PID의 장점:**
- 현장에서 구현 및 튜닝이 단순
- 잘 정립된 산업용 튜닝 규칙 존재
- 비전문가도 이해하기 쉬움

## 6. 설계 검증 (Design Verification)

보상기 설계 후 다음 항목을 계산하여 검증한다:

1. **계단 응답(Step Response):** $M_p$, $t_s$, $t_r$, $e_{ss}$ 확인
2. **보드 선도(Bode Plot):** $GM$, $PM$, 대역폭 검증
3. **근궤적(Root Locus):** 폐루프 극점 위치 확인
4. **감도(Sensitivity):** 모든 주파수에서 $|S(j\omega)| < M_s^{\max}$ 만족 확인
5. **제어 입력(Control Effort):** $|u(t)| < u_{\max}$ 확인 (액추에이터 포화 검사)

## 연습 문제

### 연습 1: 앞섬 보상기 설계

$G_p(s) = \frac{5}{s(s+2)}$에 대해 $K_v = 10$을 유지하면서 $PM \geq 50°$를 달성하는 앞섬 보상기를 설계하라.

1. 필요 이득을 결정한다
2. 미보상 시스템의 위상 여유를 구한다
3. 보드 방법을 사용하여 앞섬 보상기를 설계한다
4. 보상된 시스템의 위상 여유를 검증한다

### 연습 2: 뒤짐 보상기 설계

$G_p(s) = \frac{1}{s(s+1)(s+5)}$에 대해 $K_v = 10$이고 $PM \geq 40°$가 되도록 뒤짐 보상기를 설계하라.

### 연습 3: 앞섬-뒤짐 설계

플랜트 $G_p(s) = \frac{10}{(s+1)(s+5)}$가 다음 조건을 요구한다:
- 계단 입력에 대한 정상상태 오차 제로 ($K_p = \infty$, 적분기 필요)
- $PM \geq 50°$

뒤짐 부분에 적분기를 포함한 앞섬-뒤짐 보상기를 설계하여 두 조건을 모두 충족하라.

---

*이전: [레슨 9 — PID 제어](09_PID_Control.md) | 다음: [레슨 11 — 상태 공간 표현](11_State_Space_Representation.md)*
