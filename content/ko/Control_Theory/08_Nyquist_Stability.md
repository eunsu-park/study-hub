# 레슨 8: 나이퀴스트 안정도 판별법(Nyquist Stability Criterion)

## 학습 목표

- 나이퀴스트 경로(Nyquist contour)와 안정도 해석에서의 역할 이해
- 나이퀴스트 안정도 판별법(Nyquist stability criterion)의 진술 및 적용
- 주요 전달 함수에 대한 나이퀴스트 선도(Nyquist plot) 작성
- 나이퀴스트 선도로부터 폐루프 안정도 판별
- 나이퀴스트 선도에서 이득 여유(gain margin)와 위상 여유(phase margin) 읽기

## 1. 동기

루스-후르비츠 판별법(Routh-Hurwitz criterion)은 특성 다항식을 다루며, 근궤적(root locus)은 이득 변화에 따른 극점을 추적한다. **나이퀴스트 판별법(Nyquist criterion)**은 **개루프 주파수 응답(open-loop frequency response)**만으로 폐루프 안정도를 결정하며, 이는 해석적 모델이 없을 때도 실험적으로 측정할 수 있다.

주요 장점:
- 측정된 주파수 응답 데이터로 동작
- 시간 지연(time delay) 처리 가능 (근궤적 및 루스 판별법으로는 어려움)
- 안정도 여유(stability margin)의 명확한 그래픽 해석 제공
- 불안정이 발생하는 메커니즘 규명

## 2. 수학적 기초

### 2.1 편각의 원리(Principle of the Argument)

**코시의 정리(Cauchy's theorem), 즉 편각의 원리(principle of the argument):** $s$-평면에서 등각 사상(conformal mapping) 함수 $F(s)$의 영점(zeros) $Z$개와 극점(poles) $P$개를 시계 방향으로 감싸는 경로 $\Gamma_s$가 있을 때, 상(image) $\Gamma_F = F(\Gamma_s)$는 원점을 $N$번 시계 방향으로 감싸며, 다음이 성립한다:

$$N = Z - P$$

### 2.2 제어 이론에의 적용

폐루프 시스템에서 특성 방정식(characteristic equation)은 다음과 같다:

$$1 + G(s)H(s) = 0$$

$F(s) = 1 + G(s)H(s)$로 정의한다. $F(s)$가 우반평면(RHP, Right Half-Plane)에 영점을 갖는지 확인해야 한다.

$\Gamma_s$ = **나이퀴스트 경로(Nyquist contour)** (전체 우반평면 경계)를 선택한다:
- 허수축의 $-j\infty$에서 $+j\infty$까지
- 오른쪽으로 닫히는 무한 반원(semicircle)

그러면: $Z$ = 폐루프 우반평면 극점의 수 (구하려는 값), $P$ = 개루프 우반평면 극점의 수 (알려진 값).

$F(s) = 1 + G(s)H(s)$를 통한 사상은 선도를 1만큼 이동시키므로, $F(s)$의 원점 감쌈 수는 $G(s)H(s)$의 **점 $-1 + j0$ 감쌈 수**와 같다.

## 3. 나이퀴스트 안정도 판별법

### 3.1 판별법의 진술

$P$ = $G(s)H(s)$의 개루프 우반평면 극점의 수. $N$ = 나이퀴스트 선도가 점 $(-1, 0)$을 시계 방향으로 감싸는 횟수.

폐루프 우반평면 극점의 수는:

$$Z = N + P$$

**폐루프 시스템이 안정하기 위한 필요충분조건은 $Z = 0$, 즉 $N = -P$이다** (나이퀴스트 선도는 $(-1, 0)$을 정확히 $P$번 반시계 방향으로 감싸야 한다).

### 3.2 특수 경우: 안정한 개루프 시스템

개루프 시스템이 안정한 경우($P = 0$), 폐루프 안정을 위해:

$$Z = N = 0$$

나이퀴스트 선도는 점 $(-1, 0)$을 **감싸지 않아야 한다**.

### 3.3 감쌈 횟수 계산

- $(-1, 0)$에서 임의 방향으로 무한대까지 선을 긋는다
- 교차 횟수 계산: 시계 방향 교차 = $+1$, 반시계 방향 = $-1$
- 알짜(net) 횟수 = $N$

## 4. 나이퀴스트 선도 작성

### 4.1 나이퀴스트 경로의 구간

나이퀴스트 선도는 경로의 세 구간을 사상한다:

1. **양의 허수축** ($s = j\omega$, $\omega: 0 \to \infty$): $G(j\omega)H(j\omega)$의 극좌표 선도(polar plot)와 같음
2. **무한 반원** ($s = Re^{j\theta}$, $R \to \infty$): 대개 하나의 점으로 사상 (진성 프로퍼 시스템(strictly proper system)의 경우 원점)
3. **음의 허수축** ($s = -j\omega$, $\omega: \infty \to 0$): 구간 1의 거울상(켤레)

### 4.2 허수축의 극점 처리

$G(s)H(s)$가 허수축에 극점을 가지면, 나이퀴스트 경로는 오른쪽으로 작은 반원 우회로(semicircular indentation)를 통해 극점을 우회해야 한다.

**원점의 극점(적분기)의 경우:** 작은 반원 $s = \epsilon e^{j\theta}$ ($\theta: -90° \to +90°$)은 무한대로 뻗어 나가며, 적분기 1개당 $180°$씩 호를 그린다.

### 4.3 예: 0형(Type 0) 시스템

$G(s) = \frac{K}{(s+1)(s+2)}$ (적분기 없음, $P = 0$)

- $\omega = 0$에서: $G(0) = K/2$ (실수, 양수)
- $\omega \to \infty$에서: $|G| \to 0$, $\angle G \to -180°$
- 선도는 $(K/2, 0)$에서 시작하여 원점 방향으로 나선형으로 수렴

안정을 위해: 선도는 $(-1, 0)$을 감싸지 않아야 한다. 음의 실축 교차점이 유한하므로, 안정을 위한 최대 $K$가 존재한다.

### 4.4 예: 1형(Type 1) 시스템

$G(s) = \frac{K}{s(s+1)}$ ($P = 0$, 원점에 극점)

- 원점 우회: 무한 반지름 호가 $+90°$에서 $-90°$로 이동
- $\omega = 0^+$에서: $|G| \to \infty$, $\angle G = -90°$
- $\omega \to \infty$에서: $|G| \to 0$, $\angle G \to -180°$
- 선도는 $-j\infty$에서 시작하여 음의 실축을 교차하고 원점에 접근

**실축 교차점:** $\text{Im}[G(j\omega)] = 0$을 설정하고 $\omega$에 대해 풀면 선도가 실축을 교차하는 주파수를 구할 수 있다. 이 주파수에서 이득이 $(-1, 0)$까지의 거리를 결정한다.

## 5. 나이퀴스트 선도에서의 안정도 여유

### 5.1 이득 여유(Gain Margin)

이득 여유는 위상 교차 주파수(phase crossover frequency) $\omega_{pc}$ ($\angle G = -180°$)에서 $|G(j\omega_{pc})|$의 역수이다:

$$GM = \frac{1}{|G(j\omega_{pc})|}$$

그래픽적으로: 이득 여유는 나이퀴스트 선도를 $(-1, 0)$을 통과할 때까지 **확대할 수 있는** 배율이다.

나이퀴스트 선도에서, 이득 여유는 원점에서 음의 실축 교차점까지의 거리를 원점에서 $(-1, 0)$까지의 거리로 나눈 값이다:

$$GM_{\text{dB}} = 20\log_{10}\frac{1}{|G(j\omega_{pc})|}$$

### 5.2 위상 여유(Phase Margin)

위상 여유는 나이퀴스트 선도가 단위원($|G| = 1$)과 교차하는 지점에서 측정한다:

$$PM = 180° + \angle G(j\omega_{gc})$$

그래픽적으로: $(-1, 0)$ 방향에서 선도가 단위원과 교차하는 지점까지의 각도 거리.

### 5.3 기하학적 해석

나이퀴스트 선도와 임계점 $(-1, 0)$ 사이의 거리는 시스템의 **강인성(robustness)**을 나타낸다. 이로부터 감도 최댓값(sensitivity peak)이 도출된다:

$$M_s = \max_\omega |S(j\omega)| = \max_\omega \frac{1}{|1 + G(j\omega)H(j\omega)|}$$

$M_s$는 나이퀴스트 선도와 $(-1, 0)$ 사이의 최소 거리의 역수이다.

**전형적 설계 기준:** $M_s \leq 2$ (6 dB)이면 $GM \geq 2$ (6 dB), $PM \geq 29°$가 보장된다.

## 6. 시간 지연이 있는 시스템

순수 시간 지연 $e^{-sT}$의 특성:
- $|e^{-j\omega T}| = 1$ (모든 $\omega$에 대해 단위 크기)
- $\angle e^{-j\omega T} = -\omega T$ (위상이 $\omega$에 비례하여 선형 감소)

시간 지연은 크기에 영향을 주지 않으면서 무한한 위상 지연(phase lag)을 추가한다. 나이퀴스트 선도에서, 시간 지연은 곡선을 안쪽으로 나선형으로 말게 하여 감쌈이 발생하기 쉽게 만든다.

**예:** $G(s) = \frac{Ke^{-sT}}{s+1}$

$K/(s+1)$의 나이퀴스트 선도는 반원이다. 지연이 있으면 선도가 나선형이 되며, $KT$가 충분히 크면 $(-1, 0)$을 감싸게 된다.

나이퀴스트 판별법은 이를 자연스럽게 처리하지만, 루스-후르비츠 판별법과 근궤적은 유리 전달 함수(rational transfer function)를 필요로 하므로 처리할 수 없다.

## 7. 비최소위상(Non-Minimum Phase) 시스템에 대한 나이퀴스트 판별법

**비최소위상(non-minimum phase)** 시스템은 개루프 우반평면 극점 또는 영점을 가진다. $P > 0$ (개루프 우반평면 극점)이면, 안정성을 위해 나이퀴스트 선도가 $(-1, 0)$을 $P$번 반시계 방향으로 감싸야 한다.

이는 다음과 같은 시스템에서 중요하다:
- 역진자(inverted pendulum)
- 특정 항공기 동역학 (비최소위상 영점)
- 내부 양의 피드백(internal positive feedback)이 있는 시스템

## 연습 문제

### 연습 1: 나이퀴스트 선도와 안정도

$G(s) = \frac{K}{s(s+1)(s+2)}$에 대해:

1. 나이퀴스트 선도를 개략적으로 그려라 (주요 특징 포함)
2. 실축 교차점 (주파수와 크기)을 구하라
3. 나이퀴스트 판별법을 사용하여 폐루프 안정을 위한 최대 $K$를 구하라
4. 루스-후르비츠 판별법을 사용하여 답을 검증하라

### 연습 2: 비최소위상 시스템

$G(s) = \frac{K(s-1)}{s(s+2)}$ (우반평면 영점 존재)에 대해:

1. 개루프 우반평면 극점의 수는 몇 개인가? ($P = ?$)
2. $K = 5$일 때 나이퀴스트 선도를 개략적으로 그려라
3. 나이퀴스트 선도는 $(-1, 0)$을 감싸는가? 몇 번인가?
4. 폐루프 시스템은 안정한가?

### 연습 3: 시간 지연

시스템 $G(s) = \frac{2e^{-0.5s}}{s+1}$이 있다.

1. 위상 교차 주파수 ($\angle G(j\omega) = -180°$인 주파수)를 구하라
2. 이득 여유를 구하라
3. 시스템이 불안정해지기 전까지 허용할 수 있는 최대 추가 시간 지연은 얼마인가?

---

*이전: [레슨 7 — 주파수 응답: 보드 선도](07_Bode_Plots.md) | 다음: [레슨 9 — PID 제어](09_PID_Control.md)*
