% Exercises for Lesson 07: Advanced Tables
% Topic: LaTeX
% Solutions to practice problems from the lesson.
% Compile: pdflatex exercises/LaTeX/07_tables_advanced.tex

\documentclass[12pt, a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath, amssymb}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{siunitx}
\usepackage[table]{xcolor}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{threeparttable}

\title{Exercises for Lesson 07: Advanced Tables}
\author{Study Project}
\date{}

\begin{document}
\maketitle

% === Exercise 1: Basic Professional Table ===
% Problem: Compare three algorithms with booktabs.

\section*{Exercise 1: Basic Professional Table}

\begin{table}[htbp]
  \centering
  \caption{Algorithm performance comparison}
  \label{tab:algo}
  \begin{tabular}{lcccc}
    \toprule
    Algorithm & Accuracy & Precision & Recall & F1 Score \\
    \midrule
    Random Forest   & 0.943 & 0.938 & 0.941 & 0.939 \\
    Gradient Boost  & 0.961 & 0.957 & 0.959 & 0.958 \\
    Neural Network  & 0.972 & 0.968 & 0.970 & 0.969 \\
    \bottomrule
  \end{tabular}
\end{table}

% === Exercise 2: Grouped Data ===
% Problem: multirow for category, cmidrule for sections.

\section*{Exercise 2: Grouped Data}

\begin{table}[htbp]
  \centering
  \caption{Sales data grouped by region}
  \label{tab:grouped}
  \begin{tabular}{llcc}
    \toprule
    Region & Product & Q1 Sales & Q2 Sales \\
    \midrule
    \multirow{3}{*}{North}
      & Widget A & 120 & 150 \\
      & Widget B & 98  & 110 \\
      & Widget C & 145 & 132 \\
    \cmidrule{1-4}
    \multirow{3}{*}{South}
      & Widget A & 200 & 180 \\
      & Widget B & 75  & 90  \\
      & Widget C & 160 & 175 \\
    \cmidrule{1-4}
    \multirow{2}{*}{West}
      & Widget A & 90  & 105 \\
      & Widget B & 130 & 145 \\
    \bottomrule
  \end{tabular}
\end{table}

% === Exercise 3: Complex Header ===
% Problem: Two-level header with Group A and Group B.

\section*{Exercise 3: Complex Header}

\begin{table}[htbp]
  \centering
  \caption{Two-level header with grouped columns}
  \label{tab:complex-header}
  \begin{tabular}{lcccccc}
    \toprule
    & \multicolumn{3}{c}{Group A} & \multicolumn{3}{c}{Group B} \\
    \cmidrule(lr){2-4} \cmidrule(lr){5-7}
    Item & X & Y & Z & X & Y & Z \\
    \midrule
    Item 1 & 1.2 & 3.4 & 5.6 & 7.8 & 9.0 & 1.1 \\
    Item 2 & 2.3 & 4.5 & 6.7 & 8.9 & 0.1 & 2.2 \\
    Item 3 & 3.4 & 5.6 & 7.8 & 9.0 & 1.2 & 3.3 \\
    Item 4 & 4.5 & 6.7 & 8.9 & 0.1 & 2.3 & 4.4 \\
    \bottomrule
  \end{tabular}
\end{table}

% === Exercise 4: Colored Table ===
% Problem: Alternating row colors and highlighted cells.

\section*{Exercise 4: Colored Table}

\begin{table}[htbp]
  \centering
  \caption{Performance with alternating colors and highlights}
  \label{tab:colored}
  \rowcolors{2}{gray!15}{white}
  \begin{tabular}{lccc}
    \toprule
    Model & Accuracy & Precision & Recall \\
    \midrule
    Model A & 0.85 & 0.82 & 0.88 \\
    Model B & \cellcolor{green!25}\textbf{0.94} & 0.91 & \cellcolor{green!25}\textbf{0.96} \\
    Model C & 0.89 & \cellcolor{green!25}\textbf{0.93} & 0.87 \\
    Model D & 0.91 & 0.88 & 0.93 \\
    \bottomrule
  \end{tabular}
\end{table}

% === Exercise 5: Decimal Alignment ===
% Problem: Financial table with siunitx.

\section*{Exercise 5: Decimal Alignment}

\begin{table}[htbp]
  \centering
  \caption{Quarterly financial report}
  \label{tab:financial}
  \begin{tabular}{
    l
    S[table-format=6.2]
    S[table-format=6.2]
    S[table-format=6.2]
    S[table-format=7.2]
  }
    \toprule
    {Department} & {Q1 (\$)} & {Q2 (\$)} & {Q3 (\$)} & {Total (\$)} \\
    \midrule
    Engineering  & 125000.50 & 132400.75 & 141200.00 & 398601.25 \\
    Marketing    & 85000.00  & 92300.25  & 88750.50  & 266050.75 \\
    Sales        & 210500.75 & 198200.00 & 225800.50 & 634501.25 \\
    Operations   & 45200.25  & 47800.50  & 46500.00  & 139500.75 \\
    \midrule
    \textbf{Total} & 465701.50 & 470701.50 & 502251.00 & 1438654.00 \\
    \bottomrule
  \end{tabular}
\end{table}

% === Exercise 6: Wide Table ===
% Problem: Table with 10+ columns using tabularx.

\section*{Exercise 6: Wide Table with tabularx}

\begin{table}[htbp]
  \centering
  \caption{Wide table spanning full text width}
  \label{tab:wide}
  \begin{tabularx}{\textwidth}{lXXXXXXXXXX}
    \toprule
    ID & C1 & C2 & C3 & C4 & C5 & C6 & C7 & C8 & C9 & C10 \\
    \midrule
    A & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\
    B & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 \\
    C & 21 & 22 & 23 & 24 & 25 & 26 & 27 & 28 & 29 & 30 \\
    \bottomrule
  \end{tabularx}
\end{table}

% === Exercise 7: Long Table ===
% Problem: longtable with 50+ rows.

\section*{Exercise 7: Long Table}

\begin{longtable}{lcc}
  \caption{Dataset of 50 measurements} \label{tab:long} \\
  \toprule
  Observation & Value 1 & Value 2 \\
  \midrule
  \endfirsthead

  \multicolumn{3}{c}{{\tablename\ \thetable{} -- continued from previous page}} \\
  \toprule
  Observation & Value 1 & Value 2 \\
  \midrule
  \endhead

  \midrule
  \multicolumn{3}{r}{{Continued on next page}} \\
  \endfoot

  \bottomrule
  \endlastfoot

  Obs 1  & 12.3 & 45.6 \\  Obs 2  & 23.4 & 56.7 \\
  Obs 3  & 34.5 & 67.8 \\  Obs 4  & 45.6 & 78.9 \\
  Obs 5  & 56.7 & 89.0 \\  Obs 6  & 67.8 & 90.1 \\
  Obs 7  & 78.9 & 12.3 \\  Obs 8  & 89.0 & 23.4 \\
  Obs 9  & 90.1 & 34.5 \\  Obs 10 & 12.3 & 45.6 \\
  Obs 11 & 23.4 & 56.7 \\  Obs 12 & 34.5 & 67.8 \\
  Obs 13 & 45.6 & 78.9 \\  Obs 14 & 56.7 & 89.0 \\
  Obs 15 & 67.8 & 90.1 \\  Obs 16 & 78.9 & 12.3 \\
  Obs 17 & 89.0 & 23.4 \\  Obs 18 & 90.1 & 34.5 \\
  Obs 19 & 12.3 & 45.6 \\  Obs 20 & 23.4 & 56.7 \\
  Obs 21 & 34.5 & 67.8 \\  Obs 22 & 45.6 & 78.9 \\
  Obs 23 & 56.7 & 89.0 \\  Obs 24 & 67.8 & 90.1 \\
  Obs 25 & 78.9 & 12.3 \\  Obs 26 & 89.0 & 23.4 \\
  Obs 27 & 90.1 & 34.5 \\  Obs 28 & 12.3 & 45.6 \\
  Obs 29 & 23.4 & 56.7 \\  Obs 30 & 34.5 & 67.8 \\
  Obs 31 & 45.6 & 78.9 \\  Obs 32 & 56.7 & 89.0 \\
  Obs 33 & 67.8 & 90.1 \\  Obs 34 & 78.9 & 12.3 \\
  Obs 35 & 89.0 & 23.4 \\  Obs 36 & 90.1 & 34.5 \\
  Obs 37 & 12.3 & 45.6 \\  Obs 38 & 23.4 & 56.7 \\
  Obs 39 & 34.5 & 67.8 \\  Obs 40 & 45.6 & 78.9 \\
  Obs 41 & 56.7 & 89.0 \\  Obs 42 & 67.8 & 90.1 \\
  Obs 43 & 78.9 & 12.3 \\  Obs 44 & 89.0 & 23.4 \\
  Obs 45 & 90.1 & 34.5 \\  Obs 46 & 12.3 & 45.6 \\
  Obs 47 & 23.4 & 56.7 \\  Obs 48 & 34.5 & 67.8 \\
  Obs 49 & 45.6 & 78.9 \\  Obs 50 & 56.7 & 89.0 \\
\end{longtable}

% === Exercise 8: Complete Research Table ===
% Problem: Publication-quality table with booktabs, merging, notes,
% decimal alignment.

\section*{Exercise 8: Complete Research Table}

\begin{table}[htbp]
  \centering
  \begin{threeparttable}
    \caption{Performance comparison across datasets and models}
    \label{tab:research}
    \begin{tabular}{
      l
      l
      S[table-format=2.2]
      S[table-format=2.2]
      S[table-format=2.2]
      S[table-format=1.3]
    }
      \toprule
      \multirow{2}{*}{Dataset} & \multirow{2}{*}{Model} &
        \multicolumn{3}{c}{Accuracy (\%)} & {Time} \\
      \cmidrule(lr){3-5} \cmidrule(l){6-6}
      & & {Train} & {Val} & {Test\tnote{a}} & {(s)} \\
      \midrule
      \multirow{3}{*}{MNIST}
        & CNN       & 99.21 & 98.87 & 98.45 & 0.124 \\
        & ResNet    & 99.45 & 99.12 & 98.89 & 0.187 \\
        & ViT\tnote{b}
                    & \cellcolor{green!15}\textbf{99.67}
                    & \cellcolor{green!15}\textbf{99.34}
                    & \cellcolor{green!15}\textbf{99.12} & 0.251 \\
      \midrule
      \multirow{3}{*}{CIFAR-10}
        & CNN       & 85.34 & 82.45 & 81.23 & 0.457 \\
        & ResNet    & 92.11 & 89.76 & 88.54 & 0.679 \\
        & ViT\tnote{b}
                    & \cellcolor{green!15}\textbf{94.23}
                    & \cellcolor{green!15}\textbf{91.45}
                    & \cellcolor{green!15}\textbf{90.12} & 0.892 \\
      \bottomrule
    \end{tabular}
    \begin{tablenotes}
      \small
      \item[a] Test accuracy averaged over 5 runs.
      \item[b] Vision Transformer with patch size $16 \times 16$.
    \end{tablenotes}
  \end{threeparttable}
\end{table}

\end{document}
